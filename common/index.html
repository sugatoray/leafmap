
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python package for interactive mapping and geospatial analysis with minimal coding in a Jupyter environment">
      
      
        <meta name="author" content="Qiusheng Wu">
      
      
        <link rel="canonical" href="https://leafmap.org/common/">
      
      
        <link rel="prev" href="../colormaps/">
      
      
        <link rel="next" href="../deck/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>common module - leafmap</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-B1C88N45QG"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-B1C88N45QG",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-B1C88N45QG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#common-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="leafmap" class="md-header__button md-logo" aria-label="leafmap" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            leafmap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              common module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/opengeos/leafmap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="leafmap" class="md-nav__button md-logo" aria-label="leafmap" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    leafmap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/opengeos/leafmap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://book.leafmap.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Book
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../get-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_key_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://huggingface.co/spaces/giswqs/solara-geospatial" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web App
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://youtube.com/@giswqs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YouTube Channel
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/opengeos/leafmap/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report Issues
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" checked>
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basemaps module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bokehmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bokehmap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../colormaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    colormaps module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    common module
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    common module
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#leafmap.common" class="md-nav__link">
    <span class="md-ellipsis">
      leafmap.common
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS" class="md-nav__link">
    <span class="md-ellipsis">
      The_national_map_USGS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The_national_map_USGS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.datasets_full" class="md-nav__link">
    <span class="md-ellipsis">
      datasets_full
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.prodFormats" class="md-nav__link">
    <span class="md-ellipsis">
      prodFormats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.download_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      download_tiles()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.find_details" class="md-nav__link">
    <span class="md-ellipsis">
      find_details()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.find_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      find_tiles()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.parse_region" class="md-nav__link">
    <span class="md-ellipsis">
      parse_region()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.WhiteboxTools" class="md-nav__link">
    <span class="md-ellipsis">
      WhiteboxTools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.__install_from_github" class="md-nav__link">
    <span class="md-ellipsis">
      __install_from_github()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_crs" class="md-nav__link">
    <span class="md-ellipsis">
      add_crs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_image_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_image_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_mask_to_image" class="md-nav__link">
    <span class="md-ellipsis">
      add_mask_to_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_progress_bar_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_progress_bar_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_text_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_text_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.adjust_longitude" class="md-nav__link">
    <span class="md-ellipsis">
      adjust_longitude()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_active_map" class="md-nav__link">
    <span class="md-ellipsis">
      arc_active_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_active_view" class="md-nav__link">
    <span class="md-ellipsis">
      arc_active_view()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_add_layer" class="md-nav__link">
    <span class="md-ellipsis">
      arc_add_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_zoom_to_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      arc_zoom_to_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_zoom_to_extent" class="md-nav__link">
    <span class="md-ellipsis">
      arc_zoom_to_extent()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.array_to_image" class="md-nav__link">
    <span class="md-ellipsis">
      array_to_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.array_to_memory_file" class="md-nav__link">
    <span class="md-ellipsis">
      array_to_memory_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.assign_continuous_colors" class="md-nav__link">
    <span class="md-ellipsis">
      assign_continuous_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.assign_discrete_colors" class="md-nav__link">
    <span class="md-ellipsis">
      assign_discrete_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.basemap_xyz_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      basemap_xyz_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bbox_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bbox_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bbox_to_polygon" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_to_polygon()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.blend_images" class="md-nav__link">
    <span class="md-ellipsis">
      blend_images()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bounds_to_xy_range" class="md-nav__link">
    <span class="md-ellipsis">
      bounds_to_xy_range()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.center_zoom_to_xy_range" class="md-nav__link">
    <span class="md-ellipsis">
      center_zoom_to_xy_range()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.cesium_to_streamlit" class="md-nav__link">
    <span class="md-ellipsis">
      cesium_to_streamlit()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      check_cmap()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_color" class="md-nav__link">
    <span class="md-ellipsis">
      check_color()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_dir" class="md-nav__link">
    <span class="md-ellipsis">
      check_dir()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      check_file_path()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_html_string" class="md-nav__link">
    <span class="md-ellipsis">
      check_html_string()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_url" class="md-nav__link">
    <span class="md-ellipsis">
      check_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.classify" class="md-nav__link">
    <span class="md-ellipsis">
      classify()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.clip_image" class="md-nav__link">
    <span class="md-ellipsis">
      clip_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.cog_validate" class="md-nav__link">
    <span class="md-ellipsis">
      cog_validate()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.connect_postgis" class="md-nav__link">
    <span class="md-ellipsis">
      connect_postgis()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.convert_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      convert_coordinates()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.convert_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      convert_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.coords_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      coords_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.coords_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      coords_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.coords_to_xy" class="md-nav__link">
    <span class="md-ellipsis">
      coords_to_xy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_code_cell" class="md-nav__link">
    <span class="md-ellipsis">
      create_code_cell()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_download_link" class="md-nav__link">
    <span class="md-ellipsis">
      create_download_link()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_legend" class="md-nav__link">
    <span class="md-ellipsis">
      create_legend()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      create_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_points_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      csv_points_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.delete_shp" class="md-nav__link">
    <span class="md-ellipsis">
      delete_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.df_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.df_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.dict_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      dict_to_json()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.disjoint" class="md-nav__link">
    <span class="md-ellipsis">
      disjoint()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.display_html" class="md-nav__link">
    <span class="md-ellipsis">
      display_html()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_file_lite" class="md-nav__link">
    <span class="md-ellipsis">
      download_file_lite()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_files" class="md-nav__link">
    <span class="md-ellipsis">
      download_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_folder" class="md-nav__link">
    <span class="md-ellipsis">
      download_folder()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_from_gdrive" class="md-nav__link">
    <span class="md-ellipsis">
      download_from_gdrive()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      download_from_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_google_buildings" class="md-nav__link">
    <span class="md-ellipsis">
      download_google_buildings()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_ms_buildings" class="md-nav__link">
    <span class="md-ellipsis">
      download_ms_buildings()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_ned" class="md-nav__link">
    <span class="md-ellipsis">
      download_ned()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_tnm" class="md-nav__link">
    <span class="md-ellipsis">
      download_tnm()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.edit_download_html" class="md-nav__link">
    <span class="md-ellipsis">
      edit_download_html()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.explode" class="md-nav__link">
    <span class="md-ellipsis">
      explode()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.extract_archive" class="md-nav__link">
    <span class="md-ellipsis">
      extract_archive()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.filter_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      filter_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.filter_date" class="md-nav__link">
    <span class="md-ellipsis">
      filter_date()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.find_files" class="md-nav__link">
    <span class="md-ellipsis">
      find_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdb_layer_names" class="md-nav__link">
    <span class="md-ellipsis">
      gdb_layer_names()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdb_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      gdb_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_centroid" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_centroid()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_geom_type" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_geom_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_to_bokeh" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_to_bokeh()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_download_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_download_files" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_download_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_search" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_search()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_subset" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_subset()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_gpkg" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_gpkg()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_mbtiles" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_mbtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_pmtiles" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_pmtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geom_type" class="md-nav__link">
    <span class="md-ellipsis">
      geom_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geometry_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      geometry_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_3dep_dem" class="md-nav__link">
    <span class="md-ellipsis">
      get_3dep_dem()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_api_key" class="md-nav__link">
    <span class="md-ellipsis">
      get_api_key()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      get_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_census_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_census_dict()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_center" class="md-nav__link">
    <span class="md-ellipsis">
      get_center()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_direct_url" class="md-nav__link">
    <span class="md-ellipsis">
      get_direct_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_gdal_drivers" class="md-nav__link">
    <span class="md-ellipsis">
      get_gdal_drivers()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_gdal_file_extension" class="md-nav__link">
    <span class="md-ellipsis">
      get_gdal_file_extension()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_geometry_coords" class="md-nav__link">
    <span class="md-ellipsis">
      get_geometry_coords()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_geometry_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_geometry_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_google_map" class="md-nav__link">
    <span class="md-ellipsis">
      get_google_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_local_tile_layer" class="md-nav__link">
    <span class="md-ellipsis">
      get_local_tile_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_nhd_basins" class="md-nav__link">
    <span class="md-ellipsis">
      get_nhd_basins()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      get_overlap()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_palettable" class="md-nav__link">
    <span class="md-ellipsis">
      get_palettable()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_palette_colors" class="md-nav__link">
    <span class="md-ellipsis">
      get_palette_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_solar_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_solar_data()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_stac_collections" class="md-nav__link">
    <span class="md-ellipsis">
      get_stac_collections()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_stac_items" class="md-nav__link">
    <span class="md-ellipsis">
      get_stac_items()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_wms_layers" class="md-nav__link">
    <span class="md-ellipsis">
      get_wms_layers()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gif_fading" class="md-nav__link">
    <span class="md-ellipsis">
      gif_fading()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gif_to_mp4" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_mp4()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gif_to_png" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_png()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.github_raw_url" class="md-nav__link">
    <span class="md-ellipsis">
      github_raw_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.google_buildings_csv_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      google_buildings_csv_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.h5_keys" class="md-nav__link">
    <span class="md-ellipsis">
      h5_keys()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.h5_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      h5_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.h5_variables" class="md-nav__link">
    <span class="md-ellipsis">
      h5_variables()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.has_transparency" class="md-nav__link">
    <span class="md-ellipsis">
      has_transparency()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.hex_to_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      hex_to_rgb()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.html_to_gradio" class="md-nav__link">
    <span class="md-ellipsis">
      html_to_gradio()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.html_to_streamlit" class="md-nav__link">
    <span class="md-ellipsis">
      html_to_streamlit()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_bandcount" class="md-nav__link">
    <span class="md-ellipsis">
      image_bandcount()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      image_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_center" class="md-nav__link">
    <span class="md-ellipsis">
      image_center()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_client" class="md-nav__link">
    <span class="md-ellipsis">
      image_client()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_comparison" class="md-nav__link">
    <span class="md-ellipsis">
      image_comparison()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_filesize" class="md-nav__link">
    <span class="md-ellipsis">
      image_filesize()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_geotransform" class="md-nav__link">
    <span class="md-ellipsis">
      image_geotransform()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      image_metadata()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_min_max" class="md-nav__link">
    <span class="md-ellipsis">
      image_min_max()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_projection" class="md-nav__link">
    <span class="md-ellipsis">
      image_projection()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      image_resolution()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_set_crs" class="md-nav__link">
    <span class="md-ellipsis">
      image_set_crs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_size" class="md-nav__link">
    <span class="md-ellipsis">
      image_size()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_to_cog" class="md-nav__link">
    <span class="md-ellipsis">
      image_to_cog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_to_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      image_to_numpy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.images_to_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      images_to_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.install_package" class="md-nav__link">
    <span class="md-ellipsis">
      install_package()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_arcpy" class="md-nav__link">
    <span class="md-ellipsis">
      is_arcpy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_array" class="md-nav__link">
    <span class="md-ellipsis">
      is_array()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_jupyterlite" class="md-nav__link">
    <span class="md-ellipsis">
      is_jupyterlite()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_on_aws" class="md-nav__link">
    <span class="md-ellipsis">
      is_on_aws()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_studio_lab" class="md-nav__link">
    <span class="md-ellipsis">
      is_studio_lab()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_tool" class="md-nav__link">
    <span class="md-ellipsis">
      is_tool()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.kml_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      kml_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.kml_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      kml_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.list_palettes" class="md-nav__link">
    <span class="md-ellipsis">
      list_palettes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.lnglat_to_meters" class="md-nav__link">
    <span class="md-ellipsis">
      lnglat_to_meters()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.local_tile_bands" class="md-nav__link">
    <span class="md-ellipsis">
      local_tile_bands()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.local_tile_pixel_value" class="md-nav__link">
    <span class="md-ellipsis">
      local_tile_pixel_value()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.local_tile_vmin_vmax" class="md-nav__link">
    <span class="md-ellipsis">
      local_tile_vmin_vmax()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.make_gif" class="md-nav__link">
    <span class="md-ellipsis">
      make_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.map_tiles_to_geotiff" class="md-nav__link">
    <span class="md-ellipsis">
      map_tiles_to_geotiff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mbtiles_to_pmtiles" class="md-nav__link">
    <span class="md-ellipsis">
      mbtiles_to_pmtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.merge_gifs" class="md-nav__link">
    <span class="md-ellipsis">
      merge_gifs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.merge_rasters" class="md-nav__link">
    <span class="md-ellipsis">
      merge_rasters()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.merge_vector" class="md-nav__link">
    <span class="md-ellipsis">
      merge_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.meters_to_lnglat" class="md-nav__link">
    <span class="md-ellipsis">
      meters_to_lnglat()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_info" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_info()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_info_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_info_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_tile" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_tile()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_download" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_download()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_granules_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_granules_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_login" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_login()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_search" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_search()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_datasets()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.netcdf_tile_layer" class="md-nav__link">
    <span class="md-ellipsis">
      netcdf_tile_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.netcdf_to_tif" class="md-nav__link">
    <span class="md-ellipsis">
      netcdf_to_tif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.numpy_to_cog" class="md-nav__link">
    <span class="md-ellipsis">
      numpy_to_cog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.numpy_to_image" class="md-nav__link">
    <span class="md-ellipsis">
      numpy_to_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.open_image_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      open_image_from_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.overlay_images" class="md-nav__link">
    <span class="md-ellipsis">
      overlay_images()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pandas_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      pandas_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_biannual_tiles_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_biannual_tiles_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_biannual_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_biannual_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_by_month" class="md-nav__link">
    <span class="md-ellipsis">
      planet_by_month()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_by_quarter" class="md-nav__link">
    <span class="md-ellipsis">
      planet_by_quarter()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      planet_catalog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_catalog_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_catalog_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly_tiles_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly_tiles_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_quarterly" class="md-nav__link">
    <span class="md-ellipsis">
      planet_quarterly()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_quarterly_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      planet_quarterly_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tile_by_month" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tile_by_month()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tile_by_quarter" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tile_by_quarter()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tiles_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tiles_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.plot_raster" class="md-nav__link">
    <span class="md-ellipsis">
      plot_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.plot_raster_3d" class="md-nav__link">
    <span class="md-ellipsis">
      plot_raster_3d()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pmtiles_header" class="md-nav__link">
    <span class="md-ellipsis">
      pmtiles_header()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pmtiles_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      pmtiles_metadata()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pmtiles_style" class="md-nav__link">
    <span class="md-ellipsis">
      pmtiles_style()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.png_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      png_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.points_from_xy" class="md-nav__link">
    <span class="md-ellipsis">
      points_from_xy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.random_string" class="md-nav__link">
    <span class="md-ellipsis">
      random_string()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.raster_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      raster_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_file_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      read_file_from_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      read_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_netcdf" class="md-nav__link">
    <span class="md-ellipsis">
      read_netcdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      read_parquet()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_postgis" class="md-nav__link">
    <span class="md-ellipsis">
      read_postgis()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_raster" class="md-nav__link">
    <span class="md-ellipsis">
      read_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_rasters" class="md-nav__link">
    <span class="md-ellipsis">
      read_rasters()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.reduce_gif_size" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_gif_size()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.regularize" class="md-nav__link">
    <span class="md-ellipsis">
      regularize()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.replace_hyphens_in_keys" class="md-nav__link">
    <span class="md-ellipsis">
      replace_hyphens_in_keys()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.replace_top_level_hyphens" class="md-nav__link">
    <span class="md-ellipsis">
      replace_top_level_hyphens()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.reproject" class="md-nav__link">
    <span class="md-ellipsis">
      reproject()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.rgb_to_hex" class="md-nav__link">
    <span class="md-ellipsis">
      rgb_to_hex()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      s3_download_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_download_files" class="md-nav__link">
    <span class="md-ellipsis">
      s3_download_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_get_object" class="md-nav__link">
    <span class="md-ellipsis">
      s3_get_object()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_get_objects" class="md-nav__link">
    <span class="md-ellipsis">
      s3_get_objects()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_list_objects" class="md-nav__link">
    <span class="md-ellipsis">
      s3_list_objects()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.save_colorbar" class="md-nav__link">
    <span class="md-ellipsis">
      save_colorbar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.save_data" class="md-nav__link">
    <span class="md-ellipsis">
      save_data()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.screen_capture" class="md-nav__link">
    <span class="md-ellipsis">
      screen_capture()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.search_qms" class="md-nav__link">
    <span class="md-ellipsis">
      search_qms()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.search_xyz_services" class="md-nav__link">
    <span class="md-ellipsis">
      search_xyz_services()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.select_largest" class="md-nav__link">
    <span class="md-ellipsis">
      select_largest()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.set_api_key" class="md-nav__link">
    <span class="md-ellipsis">
      set_api_key()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.set_proxy" class="md-nav__link">
    <span class="md-ellipsis">
      set_proxy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.show_html" class="md-nav__link">
    <span class="md-ellipsis">
      show_html()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.show_image" class="md-nav__link">
    <span class="md-ellipsis">
      show_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.show_youtube_video" class="md-nav__link">
    <span class="md-ellipsis">
      show_youtube_video()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.shp_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      shp_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.shp_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      shp_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.skip_mkdocs_build" class="md-nav__link">
    <span class="md-ellipsis">
      skip_mkdocs_build()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.split_raster" class="md-nav__link">
    <span class="md-ellipsis">
      split_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.st_download_button" class="md-nav__link">
    <span class="md-ellipsis">
      st_download_button()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.start_server" class="md-nav__link">
    <span class="md-ellipsis">
      start_server()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.streamlit_legend" class="md-nav__link">
    <span class="md-ellipsis">
      streamlit_legend()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.system_fonts" class="md-nav__link">
    <span class="md-ellipsis">
      system_fonts()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.temp_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      temp_file_path()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.tif_to_jp2" class="md-nav__link">
    <span class="md-ellipsis">
      tif_to_jp2()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.tms_to_geotiff" class="md-nav__link">
    <span class="md-ellipsis">
      tms_to_geotiff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.to_hex_colors" class="md-nav__link">
    <span class="md-ellipsis">
      to_hex_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.transform_bbox_coords" class="md-nav__link">
    <span class="md-ellipsis">
      transform_bbox_coords()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.transform_coords" class="md-nav__link">
    <span class="md-ellipsis">
      transform_coords()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.update_package" class="md-nav__link">
    <span class="md-ellipsis">
      update_package()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.upload_to_imgur" class="md-nav__link">
    <span class="md-ellipsis">
      upload_to_imgur()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_area" class="md-nav__link">
    <span class="md-ellipsis">
      vector_area()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_col_names" class="md-nav__link">
    <span class="md-ellipsis">
      vector_col_names()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_geom_type" class="md-nav__link">
    <span class="md-ellipsis">
      vector_geom_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_set_crs" class="md-nav__link">
    <span class="md-ellipsis">
      vector_set_crs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_mbtiles" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_mbtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_parquet()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_pmtiles" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_pmtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_raster" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.view_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      view_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.whiteboxgui" class="md-nav__link">
    <span class="md-ellipsis">
      whiteboxgui()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.widget_template" class="md-nav__link">
    <span class="md-ellipsis">
      widget_template()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.write_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      write_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.xy_to_window" class="md-nav__link">
    <span class="md-ellipsis">
      xy_to_window()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.zonal_stats" class="md-nav__link">
    <span class="md-ellipsis">
      zonal_stats()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.zoom_level_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      zoom_level_resolution()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deck module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deckgl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deckgl module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    examples module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../foliumap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foliumap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kepler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kepler module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibregl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maplibregl module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../leafmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    leafmap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../legends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    legends module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../map_widgets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    map_widgets module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../osm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    osm module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pc module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotlymap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plotlymap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deck module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stac module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../toolbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolbar module
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workshops
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/FOSS4G_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FOSS4G 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SIGSPATIAL_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SIGSPATIAL 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/YouthMappers_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YouthMappers 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/ICRW_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ICRW 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/EarthCube_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EarthCube 2023
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MapLibre
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            MapLibre
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/3d_buildings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3d buildings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/3d_indoor_mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3d indoor mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/3d_terrain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3d terrain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/add_a_marker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add a marker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/add_deckgl_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add deckgl layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/add_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/add_image_generated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add image generated
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/animate_a_line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Animate a line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/animate_camera_around_point/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Animate camera around point
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/animate_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Animate images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/animate_point_along_line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Animate point along line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/animate_point_along_route/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Animate point along route
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/attribution_position/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attribution position
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/center_on_symbol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Center on symbol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/change_building_color/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change building color
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/change_case_of_labels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change case of labels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/cloud_optimized_geotiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud optimized geotiff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/color_switcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Color switcher
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/data_driven_lines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data driven lines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/disable_scroll_zoom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disable scroll zoom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/display_rich_text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Display rich text
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/drag_a_marker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drag a marker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/fallback_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fallback image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/fit_bounds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fit bounds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/fill_pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fill pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/fly_to/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fly to
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/fly_to_options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fly to options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/fullscreen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fullscreen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/geojson_layer_in_stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geojson layer in stack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/geojson_line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geojson line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/geojson_points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geojson points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/geojson_polygon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geojson polygon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/heatmap_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heatmap layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/interactive_false/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interactive false
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/jump_to/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jump to
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/language_switch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language switch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/line_gradient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Line gradient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/live_geojson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Live geojson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/live_update_feature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Live update feature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/local_geojson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local geojson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/local_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/locate_user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Locate user
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/map_tiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Map tiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/mouse_position/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mouse position
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/multiple_geometries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple geometries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/navigation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Navigation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/pmtiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pmtiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/restrict_bounds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restrict bounds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/satellite_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Satellite map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/set_pitch_bearing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Set pitch bearing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/stac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/variable_label_placement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variable label placement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/variable_offset_label_placement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variable offset label placement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/vector_tile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vector tile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/video_on_a_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Video on a map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/visualize_population_density/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualize population density
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/wms_source/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wms source
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibre/zoom_to_linestring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zoom to linestring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notebooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_key_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/01_leafmap_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 leafmap intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/02_using_basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 using basemaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/03_cog_stac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03 cog stac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/04_cog_mosaic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 cog mosaic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/05_load_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 load raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/06_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06 legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/07_colorbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07 colorbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/08_whitebox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08 whitebox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/09_csv_to_points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09 csv to points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/10_add_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10 add vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/11_linked_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11 linked maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/12_split_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12 split map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/13_geopandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13 geopandas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/14_postgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14 postgis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/15_openstreetmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15 openstreetmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/16_heremap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16 heremap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/17_vector_tile_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17 vector tile layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/18_point_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18 point layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/19_map_to_html/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    19 map to html
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/20_planet_imagery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20 planet imagery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/21_ts_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21 ts inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/22_time_slider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22 time slider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/23_colormaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23 colormaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/24_heatmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    24 heatmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/25_map_title/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25 map title
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/26_kepler_gl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26 kepler gl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/27_basemap_gallery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27 basemap gallery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/28_publish_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    28 publish map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/29_pydeck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    29 pydeck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/30_census_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    30 census data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/31_search_basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    31 search basemaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/32_local_tile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    32 local tile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/33_image_overlay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    33 image overlay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/34_add_points_from_xy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    34 add points from xy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/35_circle_markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    35 circle markers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/36_add_labels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    36 add labels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/37_planetary_computer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    37 planetary computer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/38_plotly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    38 plotly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/39_inspector_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    39 inspector tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/40_plotly_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    40 plotly gui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/41_raster_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    41 raster gui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/42_create_cog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    42 create cog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/43_search_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    43 search control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/44_attribute_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    44 attribute table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/45_create_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    45 create vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/46_edit_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    46 edit vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/47_numpy_to_cog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    47 numpy to cog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/48_lidar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    48 lidar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/49_split_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    49 split control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/50_marker_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    50 marker cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/51_clip_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    51 clip image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/52_netcdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    52 netcdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/53_choropleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    53 choropleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/54_plot_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    54 plot raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/55_lidar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    55 lidar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/56_download_ned/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    56 download ned
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/57_national_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    57 national map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/58_bokeh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    58 bokeh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/59_create_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    59 create legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/60_add_widget/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    60 add widget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/61_vector_to_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    61 vector to gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/62_folium_colorbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    62 folium colorbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/63_arcgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    63 arcgis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/64_stac_search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    64 stac search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/65_sagemaker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    65 sagemaker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/66_gradio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    66 gradio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/67_maxar_open_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    67 maxar open data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/68_openaerialmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    68 openaerialmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/69_turkey_earthquake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    69 turkey earthquake
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/70_zonal_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    70 zonal stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/71_aws_s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    71 aws s3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/72_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    72 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/73_custom_stac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    73 custom stac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/74_map_tiles_to_geotiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    74 map tiles to geotiff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/75_segment_anything/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    75 segment anything
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/76_image_comparison/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    76 image comparison
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/77_split_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    77 split raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/78_read_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    78 read raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/79_timeseries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    79 timeseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/80_solar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    80 solar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/81_buildings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    81 buildings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/82_pmtiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    82 pmtiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/83_vector_viz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    83 vector viz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/84_read_parquet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    84 read parquet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/85_gedi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    85 gedi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/86_add_markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    86 add markers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/87_actinia/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    87 actinia
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/88_nasa_earth_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    88 nasa earth data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/89_image_array_viz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    89 image array viz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/90_pixel_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    90 pixel inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/91_raster_viz_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    91 raster viz gui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/92_maplibre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    92 maplibre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/93_maplibre_pmtiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    93 maplibre pmtiles
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#leafmap.common" class="md-nav__link">
    <span class="md-ellipsis">
      leafmap.common
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS" class="md-nav__link">
    <span class="md-ellipsis">
      The_national_map_USGS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The_national_map_USGS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.datasets_full" class="md-nav__link">
    <span class="md-ellipsis">
      datasets_full
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.prodFormats" class="md-nav__link">
    <span class="md-ellipsis">
      prodFormats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.download_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      download_tiles()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.find_details" class="md-nav__link">
    <span class="md-ellipsis">
      find_details()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.find_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      find_tiles()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leafmap.common.The_national_map_USGS.parse_region" class="md-nav__link">
    <span class="md-ellipsis">
      parse_region()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.WhiteboxTools" class="md-nav__link">
    <span class="md-ellipsis">
      WhiteboxTools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.__install_from_github" class="md-nav__link">
    <span class="md-ellipsis">
      __install_from_github()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_crs" class="md-nav__link">
    <span class="md-ellipsis">
      add_crs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_image_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_image_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_mask_to_image" class="md-nav__link">
    <span class="md-ellipsis">
      add_mask_to_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_progress_bar_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_progress_bar_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.add_text_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      add_text_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.adjust_longitude" class="md-nav__link">
    <span class="md-ellipsis">
      adjust_longitude()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_active_map" class="md-nav__link">
    <span class="md-ellipsis">
      arc_active_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_active_view" class="md-nav__link">
    <span class="md-ellipsis">
      arc_active_view()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_add_layer" class="md-nav__link">
    <span class="md-ellipsis">
      arc_add_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_zoom_to_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      arc_zoom_to_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.arc_zoom_to_extent" class="md-nav__link">
    <span class="md-ellipsis">
      arc_zoom_to_extent()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.array_to_image" class="md-nav__link">
    <span class="md-ellipsis">
      array_to_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.array_to_memory_file" class="md-nav__link">
    <span class="md-ellipsis">
      array_to_memory_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.assign_continuous_colors" class="md-nav__link">
    <span class="md-ellipsis">
      assign_continuous_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.assign_discrete_colors" class="md-nav__link">
    <span class="md-ellipsis">
      assign_discrete_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.basemap_xyz_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      basemap_xyz_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bbox_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bbox_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bbox_to_polygon" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_to_polygon()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.blend_images" class="md-nav__link">
    <span class="md-ellipsis">
      blend_images()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.bounds_to_xy_range" class="md-nav__link">
    <span class="md-ellipsis">
      bounds_to_xy_range()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.center_zoom_to_xy_range" class="md-nav__link">
    <span class="md-ellipsis">
      center_zoom_to_xy_range()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.cesium_to_streamlit" class="md-nav__link">
    <span class="md-ellipsis">
      cesium_to_streamlit()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      check_cmap()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_color" class="md-nav__link">
    <span class="md-ellipsis">
      check_color()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_dir" class="md-nav__link">
    <span class="md-ellipsis">
      check_dir()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      check_file_path()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_html_string" class="md-nav__link">
    <span class="md-ellipsis">
      check_html_string()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.check_url" class="md-nav__link">
    <span class="md-ellipsis">
      check_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.classify" class="md-nav__link">
    <span class="md-ellipsis">
      classify()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.clip_image" class="md-nav__link">
    <span class="md-ellipsis">
      clip_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.cog_validate" class="md-nav__link">
    <span class="md-ellipsis">
      cog_validate()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.connect_postgis" class="md-nav__link">
    <span class="md-ellipsis">
      connect_postgis()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.convert_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      convert_coordinates()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.convert_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      convert_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.coords_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      coords_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.coords_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      coords_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.coords_to_xy" class="md-nav__link">
    <span class="md-ellipsis">
      coords_to_xy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_code_cell" class="md-nav__link">
    <span class="md-ellipsis">
      create_code_cell()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_download_link" class="md-nav__link">
    <span class="md-ellipsis">
      create_download_link()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_legend" class="md-nav__link">
    <span class="md-ellipsis">
      create_legend()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.create_timelapse" class="md-nav__link">
    <span class="md-ellipsis">
      create_timelapse()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_points_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      csv_points_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.csv_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      csv_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.delete_shp" class="md-nav__link">
    <span class="md-ellipsis">
      delete_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.df_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.df_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.dict_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      dict_to_json()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.disjoint" class="md-nav__link">
    <span class="md-ellipsis">
      disjoint()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.display_html" class="md-nav__link">
    <span class="md-ellipsis">
      display_html()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_file_lite" class="md-nav__link">
    <span class="md-ellipsis">
      download_file_lite()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_files" class="md-nav__link">
    <span class="md-ellipsis">
      download_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_folder" class="md-nav__link">
    <span class="md-ellipsis">
      download_folder()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_from_gdrive" class="md-nav__link">
    <span class="md-ellipsis">
      download_from_gdrive()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      download_from_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_google_buildings" class="md-nav__link">
    <span class="md-ellipsis">
      download_google_buildings()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_ms_buildings" class="md-nav__link">
    <span class="md-ellipsis">
      download_ms_buildings()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_ned" class="md-nav__link">
    <span class="md-ellipsis">
      download_ned()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.download_tnm" class="md-nav__link">
    <span class="md-ellipsis">
      download_tnm()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.edit_download_html" class="md-nav__link">
    <span class="md-ellipsis">
      edit_download_html()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.explode" class="md-nav__link">
    <span class="md-ellipsis">
      explode()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.extract_archive" class="md-nav__link">
    <span class="md-ellipsis">
      extract_archive()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.filter_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      filter_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.filter_date" class="md-nav__link">
    <span class="md-ellipsis">
      filter_date()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.find_files" class="md-nav__link">
    <span class="md-ellipsis">
      find_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdb_layer_names" class="md-nav__link">
    <span class="md-ellipsis">
      gdb_layer_names()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdb_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      gdb_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_centroid" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_centroid()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_geom_type" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_geom_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_to_bokeh" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_to_bokeh()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gdf_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      gdf_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_download_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_download_files" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_download_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_search" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_search()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gedi_subset" class="md-nav__link">
    <span class="md-ellipsis">
      gedi_subset()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_df()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_gpkg" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_gpkg()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_mbtiles" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_mbtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_pmtiles" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_pmtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geojson_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      geojson_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geom_type" class="md-nav__link">
    <span class="md-ellipsis">
      geom_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.geometry_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      geometry_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_3dep_dem" class="md-nav__link">
    <span class="md-ellipsis">
      get_3dep_dem()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_api_key" class="md-nav__link">
    <span class="md-ellipsis">
      get_api_key()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      get_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_census_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_census_dict()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_center" class="md-nav__link">
    <span class="md-ellipsis">
      get_center()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_direct_url" class="md-nav__link">
    <span class="md-ellipsis">
      get_direct_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_gdal_drivers" class="md-nav__link">
    <span class="md-ellipsis">
      get_gdal_drivers()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_gdal_file_extension" class="md-nav__link">
    <span class="md-ellipsis">
      get_gdal_file_extension()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_geometry_coords" class="md-nav__link">
    <span class="md-ellipsis">
      get_geometry_coords()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_geometry_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_geometry_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_google_map" class="md-nav__link">
    <span class="md-ellipsis">
      get_google_map()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_local_tile_layer" class="md-nav__link">
    <span class="md-ellipsis">
      get_local_tile_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_nhd_basins" class="md-nav__link">
    <span class="md-ellipsis">
      get_nhd_basins()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      get_overlap()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_palettable" class="md-nav__link">
    <span class="md-ellipsis">
      get_palettable()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_palette_colors" class="md-nav__link">
    <span class="md-ellipsis">
      get_palette_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_solar_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_solar_data()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_stac_collections" class="md-nav__link">
    <span class="md-ellipsis">
      get_stac_collections()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_stac_items" class="md-nav__link">
    <span class="md-ellipsis">
      get_stac_items()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.get_wms_layers" class="md-nav__link">
    <span class="md-ellipsis">
      get_wms_layers()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gif_fading" class="md-nav__link">
    <span class="md-ellipsis">
      gif_fading()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gif_to_mp4" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_mp4()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.gif_to_png" class="md-nav__link">
    <span class="md-ellipsis">
      gif_to_png()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.github_raw_url" class="md-nav__link">
    <span class="md-ellipsis">
      github_raw_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.google_buildings_csv_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      google_buildings_csv_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.h5_keys" class="md-nav__link">
    <span class="md-ellipsis">
      h5_keys()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.h5_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      h5_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.h5_variables" class="md-nav__link">
    <span class="md-ellipsis">
      h5_variables()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.has_transparency" class="md-nav__link">
    <span class="md-ellipsis">
      has_transparency()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.hex_to_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      hex_to_rgb()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.html_to_gradio" class="md-nav__link">
    <span class="md-ellipsis">
      html_to_gradio()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.html_to_streamlit" class="md-nav__link">
    <span class="md-ellipsis">
      html_to_streamlit()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_bandcount" class="md-nav__link">
    <span class="md-ellipsis">
      image_bandcount()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      image_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_center" class="md-nav__link">
    <span class="md-ellipsis">
      image_center()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_client" class="md-nav__link">
    <span class="md-ellipsis">
      image_client()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_comparison" class="md-nav__link">
    <span class="md-ellipsis">
      image_comparison()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_filesize" class="md-nav__link">
    <span class="md-ellipsis">
      image_filesize()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_geotransform" class="md-nav__link">
    <span class="md-ellipsis">
      image_geotransform()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      image_metadata()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_min_max" class="md-nav__link">
    <span class="md-ellipsis">
      image_min_max()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_projection" class="md-nav__link">
    <span class="md-ellipsis">
      image_projection()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      image_resolution()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_set_crs" class="md-nav__link">
    <span class="md-ellipsis">
      image_set_crs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_size" class="md-nav__link">
    <span class="md-ellipsis">
      image_size()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_to_cog" class="md-nav__link">
    <span class="md-ellipsis">
      image_to_cog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.image_to_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      image_to_numpy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.images_to_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      images_to_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.install_package" class="md-nav__link">
    <span class="md-ellipsis">
      install_package()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_arcpy" class="md-nav__link">
    <span class="md-ellipsis">
      is_arcpy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_array" class="md-nav__link">
    <span class="md-ellipsis">
      is_array()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_jupyterlite" class="md-nav__link">
    <span class="md-ellipsis">
      is_jupyterlite()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_on_aws" class="md-nav__link">
    <span class="md-ellipsis">
      is_on_aws()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_studio_lab" class="md-nav__link">
    <span class="md-ellipsis">
      is_studio_lab()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.is_tool" class="md-nav__link">
    <span class="md-ellipsis">
      is_tool()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.kml_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      kml_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.kml_to_shp" class="md-nav__link">
    <span class="md-ellipsis">
      kml_to_shp()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.list_palettes" class="md-nav__link">
    <span class="md-ellipsis">
      list_palettes()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.lnglat_to_meters" class="md-nav__link">
    <span class="md-ellipsis">
      lnglat_to_meters()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.local_tile_bands" class="md-nav__link">
    <span class="md-ellipsis">
      local_tile_bands()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.local_tile_pixel_value" class="md-nav__link">
    <span class="md-ellipsis">
      local_tile_pixel_value()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.local_tile_vmin_vmax" class="md-nav__link">
    <span class="md-ellipsis">
      local_tile_vmin_vmax()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.make_gif" class="md-nav__link">
    <span class="md-ellipsis">
      make_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.map_tiles_to_geotiff" class="md-nav__link">
    <span class="md-ellipsis">
      map_tiles_to_geotiff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mbtiles_to_pmtiles" class="md-nav__link">
    <span class="md-ellipsis">
      mbtiles_to_pmtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.merge_gifs" class="md-nav__link">
    <span class="md-ellipsis">
      merge_gifs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.merge_rasters" class="md-nav__link">
    <span class="md-ellipsis">
      merge_rasters()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.merge_vector" class="md-nav__link">
    <span class="md-ellipsis">
      merge_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.meters_to_lnglat" class="md-nav__link">
    <span class="md-ellipsis">
      meters_to_lnglat()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_bounds()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_info" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_info()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_info_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_info_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.mosaic_tile" class="md-nav__link">
    <span class="md-ellipsis">
      mosaic_tile()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_download" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_download()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_granules_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_granules_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_login" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_login()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_data_search" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_data_search()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.nasa_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      nasa_datasets()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.netcdf_tile_layer" class="md-nav__link">
    <span class="md-ellipsis">
      netcdf_tile_layer()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.netcdf_to_tif" class="md-nav__link">
    <span class="md-ellipsis">
      netcdf_to_tif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.numpy_to_cog" class="md-nav__link">
    <span class="md-ellipsis">
      numpy_to_cog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.numpy_to_image" class="md-nav__link">
    <span class="md-ellipsis">
      numpy_to_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.open_image_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      open_image_from_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.overlay_images" class="md-nav__link">
    <span class="md-ellipsis">
      overlay_images()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pandas_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      pandas_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_biannual_tiles_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_biannual_tiles_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_biannual_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_biannual_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_by_month" class="md-nav__link">
    <span class="md-ellipsis">
      planet_by_month()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_by_quarter" class="md-nav__link">
    <span class="md-ellipsis">
      planet_by_quarter()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      planet_catalog()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_catalog_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_catalog_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly_tiles_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly_tiles_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_monthly_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_monthly_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_quarterly" class="md-nav__link">
    <span class="md-ellipsis">
      planet_quarterly()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_quarterly_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      planet_quarterly_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tile_by_month" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tile_by_month()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tile_by_quarter" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tile_by_quarter()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tiles" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.planet_tiles_tropical" class="md-nav__link">
    <span class="md-ellipsis">
      planet_tiles_tropical()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.plot_raster" class="md-nav__link">
    <span class="md-ellipsis">
      plot_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.plot_raster_3d" class="md-nav__link">
    <span class="md-ellipsis">
      plot_raster_3d()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pmtiles_header" class="md-nav__link">
    <span class="md-ellipsis">
      pmtiles_header()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pmtiles_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      pmtiles_metadata()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.pmtiles_style" class="md-nav__link">
    <span class="md-ellipsis">
      pmtiles_style()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.png_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      png_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.points_from_xy" class="md-nav__link">
    <span class="md-ellipsis">
      points_from_xy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.random_string" class="md-nav__link">
    <span class="md-ellipsis">
      random_string()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.raster_to_vector" class="md-nav__link">
    <span class="md-ellipsis">
      raster_to_vector()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_file_from_url" class="md-nav__link">
    <span class="md-ellipsis">
      read_file_from_url()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      read_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_netcdf" class="md-nav__link">
    <span class="md-ellipsis">
      read_netcdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      read_parquet()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_postgis" class="md-nav__link">
    <span class="md-ellipsis">
      read_postgis()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_raster" class="md-nav__link">
    <span class="md-ellipsis">
      read_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.read_rasters" class="md-nav__link">
    <span class="md-ellipsis">
      read_rasters()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.reduce_gif_size" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_gif_size()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.regularize" class="md-nav__link">
    <span class="md-ellipsis">
      regularize()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.replace_hyphens_in_keys" class="md-nav__link">
    <span class="md-ellipsis">
      replace_hyphens_in_keys()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.replace_top_level_hyphens" class="md-nav__link">
    <span class="md-ellipsis">
      replace_top_level_hyphens()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.reproject" class="md-nav__link">
    <span class="md-ellipsis">
      reproject()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.rgb_to_hex" class="md-nav__link">
    <span class="md-ellipsis">
      rgb_to_hex()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      s3_download_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_download_files" class="md-nav__link">
    <span class="md-ellipsis">
      s3_download_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_get_object" class="md-nav__link">
    <span class="md-ellipsis">
      s3_get_object()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_get_objects" class="md-nav__link">
    <span class="md-ellipsis">
      s3_get_objects()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.s3_list_objects" class="md-nav__link">
    <span class="md-ellipsis">
      s3_list_objects()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.save_colorbar" class="md-nav__link">
    <span class="md-ellipsis">
      save_colorbar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.save_data" class="md-nav__link">
    <span class="md-ellipsis">
      save_data()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.screen_capture" class="md-nav__link">
    <span class="md-ellipsis">
      screen_capture()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.search_qms" class="md-nav__link">
    <span class="md-ellipsis">
      search_qms()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.search_xyz_services" class="md-nav__link">
    <span class="md-ellipsis">
      search_xyz_services()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.select_largest" class="md-nav__link">
    <span class="md-ellipsis">
      select_largest()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.set_api_key" class="md-nav__link">
    <span class="md-ellipsis">
      set_api_key()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.set_proxy" class="md-nav__link">
    <span class="md-ellipsis">
      set_proxy()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.show_html" class="md-nav__link">
    <span class="md-ellipsis">
      show_html()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.show_image" class="md-nav__link">
    <span class="md-ellipsis">
      show_image()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.show_youtube_video" class="md-nav__link">
    <span class="md-ellipsis">
      show_youtube_video()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.shp_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      shp_to_gdf()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.shp_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      shp_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.skip_mkdocs_build" class="md-nav__link">
    <span class="md-ellipsis">
      skip_mkdocs_build()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.split_raster" class="md-nav__link">
    <span class="md-ellipsis">
      split_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.st_download_button" class="md-nav__link">
    <span class="md-ellipsis">
      st_download_button()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.start_server" class="md-nav__link">
    <span class="md-ellipsis">
      start_server()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.streamlit_legend" class="md-nav__link">
    <span class="md-ellipsis">
      streamlit_legend()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.system_fonts" class="md-nav__link">
    <span class="md-ellipsis">
      system_fonts()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.temp_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      temp_file_path()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.tif_to_jp2" class="md-nav__link">
    <span class="md-ellipsis">
      tif_to_jp2()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.tms_to_geotiff" class="md-nav__link">
    <span class="md-ellipsis">
      tms_to_geotiff()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.to_hex_colors" class="md-nav__link">
    <span class="md-ellipsis">
      to_hex_colors()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.transform_bbox_coords" class="md-nav__link">
    <span class="md-ellipsis">
      transform_bbox_coords()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.transform_coords" class="md-nav__link">
    <span class="md-ellipsis">
      transform_coords()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.update_package" class="md-nav__link">
    <span class="md-ellipsis">
      update_package()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.upload_to_imgur" class="md-nav__link">
    <span class="md-ellipsis">
      upload_to_imgur()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_area" class="md-nav__link">
    <span class="md-ellipsis">
      vector_area()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_col_names" class="md-nav__link">
    <span class="md-ellipsis">
      vector_col_names()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_geom_type" class="md-nav__link">
    <span class="md-ellipsis">
      vector_geom_type()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_set_crs" class="md-nav__link">
    <span class="md-ellipsis">
      vector_set_crs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_geojson()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_gif" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_gif()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_mbtiles" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_mbtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_parquet()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_pmtiles" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_pmtiles()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.vector_to_raster" class="md-nav__link">
    <span class="md-ellipsis">
      vector_to_raster()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.view_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      view_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.whiteboxgui" class="md-nav__link">
    <span class="md-ellipsis">
      whiteboxgui()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.widget_template" class="md-nav__link">
    <span class="md-ellipsis">
      widget_template()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.write_lidar" class="md-nav__link">
    <span class="md-ellipsis">
      write_lidar()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.xy_to_window" class="md-nav__link">
    <span class="md-ellipsis">
      xy_to_window()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.zonal_stats" class="md-nav__link">
    <span class="md-ellipsis">
      zonal_stats()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leafmap.common.zoom_level_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      zoom_level_resolution()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  

  
  


<h1 id="common-module">common module<a class="headerlink" href="#common-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="leafmap.common"></a>
    <div class="doc doc-contents first">

      <p>This module contains some common functions for both folium and ipyleaflet.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="leafmap.common.The_national_map_USGS" class="doc doc-heading">
        <code>
The_national_map_USGS        </code>



<a href="#leafmap.common.The_national_map_USGS" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>The national map is a collection of topological datasets, maintained by the USGS.</p>
<p>It provides an API endpoint which can be used to find downloadable links for the products offered.
    - Full description of datasets available can retrieved.
      This consists of metadata such as detail description and publication dates.
    - A wide range of dataformats are available</p>
<p>This class is a tiny wrapper to find and download files using the API.</p>
<p>More complete documentation for the API can be found at
    https://apps.nationalmap.gov/tnmaccess/#/</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">The_national_map_USGS</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The national map is a collection of topological datasets, maintained by the USGS.</span>

<span class="sd">    It provides an API endpoint which can be used to find downloadable links for the products offered.</span>
<span class="sd">        - Full description of datasets available can retrieved.</span>
<span class="sd">          This consists of metadata such as detail description and publication dates.</span>
<span class="sd">        - A wide range of dataformats are available</span>

<span class="sd">    This class is a tiny wrapper to find and download files using the API.</span>

<span class="sd">    More complete documentation for the API can be found at</span>
<span class="sd">        https://apps.nationalmap.gov/tnmaccess/#/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_endpoint</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;https://tnmaccess.nationalmap.gov/api/v1/&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets_full</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">datasets_full</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Full description of datasets provided.</span>
<span class="sd">        Returns a JSON or empty list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">link</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_endpoint</span><span class="si">}</span><span class="s2">datasets?&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load metadata from The National Map API endpoint</span><span class="se">\n</span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prodFormats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return all datatypes available in any of the collections.</span>
<span class="sd">        Note that &quot;All&quot; is only peculiar to one dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;displayName&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DS</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;formats&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of dataset tags (most common human readable self description for specific datasets).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s2">&quot;sbDatasetTag&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DS</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">parse_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Translate a Vector dataset to its bounding box.</span>

<span class="sd">        Args:</span>
<span class="sd">            region (str | list): an URL|filepath to a vector dataset to a polygon</span>
<span class="sd">            geopandas_reader_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">                Used for reading a region URL|filepath.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">region</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">region</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
                <span class="n">region</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;region must be a path or a URL to a vector dataset.&quot;</span><span class="p">)</span>

            <span class="n">roi</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">geopandas_args</span><span class="p">)</span>
            <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">roi</span><span class="o">.</span><span class="n">total_bounds</span>
        <span class="k">return</span> <span class="n">region</span>

    <span class="k">def</span> <span class="nf">download_tiles</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{}</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Download the US National Elevation Datasets (NED) for a region.</span>

<span class="sd">        Args:</span>
<span class="sd">            region (str | list, optional): An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">                Alternatively you could use API parameters such as polygon or bbox.</span>
<span class="sd">            out_dir (str, optional): The directory to download the files to. Defaults to None, which uses the current working directory.</span>
<span class="sd">            download_args (dict, optional): A dictionary of arguments to pass to the download_file function. Defaults to {}.</span>
<span class="sd">            geopandas_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">                Used for reading a region URL|filepath.</span>
<span class="sd">            API (dict, optional): A dictionary of arguments to pass to the self.find_details() function.</span>
<span class="sd">                Exposes most of the documented API. Defaults to {}.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

        <span class="n">tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tiles</span><span class="p">(</span>
            <span class="n">region</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="n">geopandas_args</span><span class="p">,</span> <span class="n">API</span><span class="o">=</span><span class="n">API</span>
        <span class="p">)</span>
        <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tiles</span><span class="p">):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
            <span class="n">out_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">20</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">download_file</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">out_name</span><span class="p">,</span> <span class="o">**</span><span class="n">download_args</span><span class="p">)</span>
                <span class="n">done</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cancelled download&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to download </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">done</span><span class="si">}</span><span class="s2"> Downloads completed, </span><span class="si">{</span><span class="n">errors</span><span class="si">}</span><span class="s2"> downloads failed, </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> files available&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">find_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find a list of downloadable files.</span>

<span class="sd">        Args:</span>
<span class="sd">            region (str | list, optional): An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">                Alternatively you could use API parameters such as polygon or bbox.</span>
<span class="sd">            out_dir (str, optional): The directory to download the files to. Defaults to None, which uses the current working directory.</span>
<span class="sd">            return_type (str): list | dict. Defaults to list. Changes the return output type and content.</span>
<span class="sd">            geopandas_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">                Used for reading a region URL|filepath.</span>
<span class="sd">            API (dict, optional): A dictionary of arguments to pass to the self.find_details() function.</span>
<span class="sd">                Exposes most of the documented API parameters. Defaults to {}.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of download_urls.</span>
<span class="sd">            dict: A dictionary with urls and related metadata</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">region</span> <span class="ow">or</span> <span class="n">API</span><span class="p">,</span> <span class="s2">&quot;Provide a region or use the API&quot;</span>

        <span class="k">if</span> <span class="n">region</span><span class="p">:</span>
            <span class="n">API</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_region</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_details</span><span class="p">(</span><span class="o">**</span><span class="n">API</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;downloadURL&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;items&quot;</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="nf">find_details</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bbox</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">polygon</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">datasets</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prodFormats</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prodExtents</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">q</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dateType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nb">max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outputFormat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;JSON&quot;</span><span class="p">,</span>
        <span class="n">polyType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">polyCode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">extentQuery</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Possible search parameters (kwargs) support by API</span>

<span class="sd">        Parameter               Values</span>
<span class="sd">            Description</span>
<span class="sd">        ---------------------------------------------------------------------------------------------------</span>
<span class="sd">        bbox                    &#39;minx, miny, maxx, maxy&#39;</span>
<span class="sd">            Geographic longitude/latitude values expressed in  decimal degrees in a comma-delimited list.</span>
<span class="sd">        polygon                 &#39;[x,y x,y x,y x,y x,y]&#39;</span>
<span class="sd">            Polygon, longitude/latitude values expressed in decimal degrees in a space-delimited list.</span>
<span class="sd">        datasets                See: Datasets (Optional)</span>
<span class="sd">            Dataset tag name (sbDatasetTag)</span>
<span class="sd">            From https://apps.nationalmap.gov/tnmaccess/#/product</span>
<span class="sd">        prodFormats             See: Product Formats (Optional)</span>
<span class="sd">            Dataset-specific format</span>

<span class="sd">        prodExtents             See: Product Extents (Optional)</span>
<span class="sd">            Dataset-specific extent</span>
<span class="sd">        q                       free text</span>
<span class="sd">            Text input which can be used to filter by product titles and text descriptions.</span>
<span class="sd">        dateType                dateCreated | lastUpdated | Publication</span>
<span class="sd">            Type of date to search by.</span>
<span class="sd">        start                   &#39;YYYY-MM-DD&#39;</span>
<span class="sd">            Start date</span>
<span class="sd">        end                     &#39;YYYY-MM-DD&#39;</span>
<span class="sd">            End date (required if start date is provided)</span>
<span class="sd">        offset                  integer</span>
<span class="sd">            Offset into paginated results - default=0</span>
<span class="sd">        max                     integer</span>
<span class="sd">            Number of results returned</span>
<span class="sd">        outputFormat            JSON | CSV | pjson</span>
<span class="sd">            Default=JSON</span>
<span class="sd">        polyType                state | huc2 | huc4 | huc8</span>
<span class="sd">            Well Known Polygon Type. Use this parameter to deliver data by state or HUC</span>
<span class="sd">            (hydrologic unit codes defined by the Watershed Boundary Dataset/WBD)</span>
<span class="sd">        polyCode                state FIPS code or huc number</span>
<span class="sd">            Well Known Polygon Code. This value needs to coordinate with the polyType parameter.</span>
<span class="sd">        extentQuery             integer</span>
<span class="sd">            A Polygon code in the science base system, typically from an uploaded shapefile</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># call locals before creating new locals</span>
            <span class="n">used_locals</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;self&quot;</span><span class="p">}</span>

            <span class="c1"># Parsing</span>
            <span class="k">if</span> <span class="n">polygon</span><span class="p">:</span>
                <span class="n">used_locals</span><span class="p">[</span><span class="s2">&quot;polygon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">point</span><span class="p">))</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">polygon</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">bbox</span><span class="p">:</span>
                <span class="n">used_locals</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bbox</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">max</span><span class="p">:</span>
                <span class="nb">max</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="c1"># Fetch response</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_endpoint</span><span class="si">}</span><span class="s2">products?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">used_locals</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">//</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Parameter validation handled by API endpoint error responses</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{}</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="leafmap.common.The_national_map_USGS.datasets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#leafmap.common.The_national_map_USGS.datasets" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a list of dataset tags (most common human readable self description for specific datasets).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="leafmap.common.The_national_map_USGS.datasets_full" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datasets_full</span><span class="p">:</span> <span class="nb">list</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#leafmap.common.The_national_map_USGS.datasets_full" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Full description of datasets provided.
Returns a JSON or empty list.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="leafmap.common.The_national_map_USGS.prodFormats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prodFormats</span><span class="p">:</span> <span class="nb">list</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#leafmap.common.The_national_map_USGS.prodFormats" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return all datatypes available in any of the collections.
Note that "All" is only peculiar to one dataset.</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 id="leafmap.common.The_national_map_USGS.download_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.The_national_map_USGS.download_tiles" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Download the US National Elevation Datasets (NED) for a region.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>str | list</code></td>
        <td><p>An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].
Alternatively you could use API parameters such as polygon or bbox.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The directory to download the files to. Defaults to None, which uses the current working directory.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>download_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the download_file function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>geopandas_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the geopandas.read_file() function.
Used for reading a region URL|filepath.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>API</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the self.find_details() function.
Exposes most of the documented API. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_tiles</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Download the US National Elevation Datasets (NED) for a region.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (str | list, optional): An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">            Alternatively you could use API parameters such as polygon or bbox.</span>
<span class="sd">        out_dir (str, optional): The directory to download the files to. Defaults to None, which uses the current working directory.</span>
<span class="sd">        download_args (dict, optional): A dictionary of arguments to pass to the download_file function. Defaults to {}.</span>
<span class="sd">        geopandas_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">            Used for reading a region URL|filepath.</span>
<span class="sd">        API (dict, optional): A dictionary of arguments to pass to the self.find_details() function.</span>
<span class="sd">            Exposes most of the documented API. Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tiles</span><span class="p">(</span>
        <span class="n">region</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="n">geopandas_args</span><span class="p">,</span> <span class="n">API</span><span class="o">=</span><span class="n">API</span>
    <span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tiles</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">out_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">20</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">download_file</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">out_name</span><span class="p">,</span> <span class="o">**</span><span class="n">download_args</span><span class="p">)</span>
            <span class="n">done</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cancelled download&quot;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to download </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">done</span><span class="si">}</span><span class="s2"> Downloads completed, </span><span class="si">{</span><span class="n">errors</span><span class="si">}</span><span class="s2"> downloads failed, </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> files available&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.common.The_national_map_USGS.find_details" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">polygon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">datasets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prodFormats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prodExtents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dateType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputFormat</span><span class="o">=</span><span class="s1">&#39;JSON&#39;</span><span class="p">,</span> <span class="n">polyType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">polyCode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extentQuery</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.The_national_map_USGS.find_details" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Possible search parameters (kwargs) support by API</p>
<p>Parameter               Values
    Description</p>
<hr />
<p>bbox                    'minx, miny, maxx, maxy'
    Geographic longitude/latitude values expressed in  decimal degrees in a comma-delimited list.
polygon                 '[x,y x,y x,y x,y x,y]'
    Polygon, longitude/latitude values expressed in decimal degrees in a space-delimited list.
datasets                See: Datasets (Optional)
    Dataset tag name (sbDatasetTag)
    From https://apps.nationalmap.gov/tnmaccess/#/product
prodFormats             See: Product Formats (Optional)
    Dataset-specific format</p>
<p>prodExtents             See: Product Extents (Optional)
    Dataset-specific extent
q                       free text
    Text input which can be used to filter by product titles and text descriptions.
dateType                dateCreated | lastUpdated | Publication
    Type of date to search by.
start                   'YYYY-MM-DD'
    Start date
end                     'YYYY-MM-DD'
    End date (required if start date is provided)
offset                  integer
    Offset into paginated results - default=0
max                     integer
    Number of results returned
outputFormat            JSON | CSV | pjson
    Default=JSON
polyType                state | huc2 | huc4 | huc8
    Well Known Polygon Type. Use this parameter to deliver data by state or HUC
    (hydrologic unit codes defined by the Watershed Boundary Dataset/WBD)
polyCode                state FIPS code or huc number
    Well Known Polygon Code. This value needs to coordinate with the polyType parameter.
extentQuery             integer
    A Polygon code in the science base system, typically from an uploaded shapefile</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_details</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">bbox</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">polygon</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">datasets</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prodFormats</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prodExtents</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">q</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dateType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nb">max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">outputFormat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;JSON&quot;</span><span class="p">,</span>
    <span class="n">polyType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">polyCode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extentQuery</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Possible search parameters (kwargs) support by API</span>

<span class="sd">    Parameter               Values</span>
<span class="sd">        Description</span>
<span class="sd">    ---------------------------------------------------------------------------------------------------</span>
<span class="sd">    bbox                    &#39;minx, miny, maxx, maxy&#39;</span>
<span class="sd">        Geographic longitude/latitude values expressed in  decimal degrees in a comma-delimited list.</span>
<span class="sd">    polygon                 &#39;[x,y x,y x,y x,y x,y]&#39;</span>
<span class="sd">        Polygon, longitude/latitude values expressed in decimal degrees in a space-delimited list.</span>
<span class="sd">    datasets                See: Datasets (Optional)</span>
<span class="sd">        Dataset tag name (sbDatasetTag)</span>
<span class="sd">        From https://apps.nationalmap.gov/tnmaccess/#/product</span>
<span class="sd">    prodFormats             See: Product Formats (Optional)</span>
<span class="sd">        Dataset-specific format</span>

<span class="sd">    prodExtents             See: Product Extents (Optional)</span>
<span class="sd">        Dataset-specific extent</span>
<span class="sd">    q                       free text</span>
<span class="sd">        Text input which can be used to filter by product titles and text descriptions.</span>
<span class="sd">    dateType                dateCreated | lastUpdated | Publication</span>
<span class="sd">        Type of date to search by.</span>
<span class="sd">    start                   &#39;YYYY-MM-DD&#39;</span>
<span class="sd">        Start date</span>
<span class="sd">    end                     &#39;YYYY-MM-DD&#39;</span>
<span class="sd">        End date (required if start date is provided)</span>
<span class="sd">    offset                  integer</span>
<span class="sd">        Offset into paginated results - default=0</span>
<span class="sd">    max                     integer</span>
<span class="sd">        Number of results returned</span>
<span class="sd">    outputFormat            JSON | CSV | pjson</span>
<span class="sd">        Default=JSON</span>
<span class="sd">    polyType                state | huc2 | huc4 | huc8</span>
<span class="sd">        Well Known Polygon Type. Use this parameter to deliver data by state or HUC</span>
<span class="sd">        (hydrologic unit codes defined by the Watershed Boundary Dataset/WBD)</span>
<span class="sd">    polyCode                state FIPS code or huc number</span>
<span class="sd">        Well Known Polygon Code. This value needs to coordinate with the polyType parameter.</span>
<span class="sd">    extentQuery             integer</span>
<span class="sd">        A Polygon code in the science base system, typically from an uploaded shapefile</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># call locals before creating new locals</span>
        <span class="n">used_locals</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;self&quot;</span><span class="p">}</span>

        <span class="c1"># Parsing</span>
        <span class="k">if</span> <span class="n">polygon</span><span class="p">:</span>
            <span class="n">used_locals</span><span class="p">[</span><span class="s2">&quot;polygon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">point</span><span class="p">))</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">polygon</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">bbox</span><span class="p">:</span>
            <span class="n">used_locals</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bbox</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">max</span><span class="p">:</span>
            <span class="nb">max</span> <span class="o">+=</span> <span class="mi">2</span>

        <span class="c1"># Fetch response</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">api_endpoint</span><span class="si">}</span><span class="s2">products?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">used_locals</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">//</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Parameter validation handled by API endpoint error responses</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.common.The_national_map_USGS.find_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.The_national_map_USGS.find_tiles" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Find a list of downloadable files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>str | list</code></td>
        <td><p>An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].
Alternatively you could use API parameters such as polygon or bbox.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The directory to download the files to. Defaults to None, which uses the current working directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>list | dict. Defaults to list. Changes the return output type and content.</p></td>
        <td><code>&#39;list&#39;</code></td>
      </tr>
      <tr>
        <td><code>geopandas_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the geopandas.read_file() function.
Used for reading a region URL|filepath.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>API</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the self.find_details() function.
Exposes most of the documented API parameters. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of download_urls.
dict: A dictionary with urls and related metadata</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find a list of downloadable files.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (str | list, optional): An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">            Alternatively you could use API parameters such as polygon or bbox.</span>
<span class="sd">        out_dir (str, optional): The directory to download the files to. Defaults to None, which uses the current working directory.</span>
<span class="sd">        return_type (str): list | dict. Defaults to list. Changes the return output type and content.</span>
<span class="sd">        geopandas_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">            Used for reading a region URL|filepath.</span>
<span class="sd">        API (dict, optional): A dictionary of arguments to pass to the self.find_details() function.</span>
<span class="sd">            Exposes most of the documented API parameters. Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of download_urls.</span>
<span class="sd">        dict: A dictionary with urls and related metadata</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">region</span> <span class="ow">or</span> <span class="n">API</span><span class="p">,</span> <span class="s2">&quot;Provide a region or use the API&quot;</span>

    <span class="k">if</span> <span class="n">region</span><span class="p">:</span>
        <span class="n">API</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_region</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_details</span><span class="p">(</span><span class="o">**</span><span class="n">API</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;downloadURL&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;items&quot;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="leafmap.common.The_national_map_USGS.parse_region" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.The_national_map_USGS.parse_region" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Translate a Vector dataset to its bounding box.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>str | list</code></td>
        <td><p>an URL|filepath to a vector dataset to a polygon</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>geopandas_reader_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the geopandas.read_file() function.
Used for reading a region URL|filepath.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Translate a Vector dataset to its bounding box.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (str | list): an URL|filepath to a vector dataset to a polygon</span>
<span class="sd">        geopandas_reader_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">            Used for reading a region URL|filepath.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">region</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
            <span class="n">region</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;region must be a path or a URL to a vector dataset.&quot;</span><span class="p">)</span>

        <span class="n">roi</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">geopandas_args</span><span class="p">)</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">roi</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="k">return</span> <span class="n">region</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="leafmap.common.WhiteboxTools" class="doc doc-heading">
        <code>
WhiteboxTools            (<span title="whitebox.whitebox_tools.WhiteboxTools">WhiteboxTools</span>)
        </code>



<a href="#leafmap.common.WhiteboxTools" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>This class inherits the whitebox WhiteboxTools class.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">WhiteboxTools</span><span class="p">(</span><span class="n">whitebox</span><span class="o">.</span><span class="n">WhiteboxTools</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class inherits the whitebox WhiteboxTools class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">












  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.__install_from_github" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__install_from_github</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


<a href="#leafmap.common.__install_from_github" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Install a package from a GitHub repository.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the GitHub repository.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__install_from_github</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Install a package from a GitHub repository.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the GitHub repository.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">download_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;Downloads&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">download_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir</span><span class="p">)</span>

        <span class="n">repo_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">zip_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;archive/master.zip&quot;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">repo_name</span> <span class="o">+</span> <span class="s2">&quot;-master.zip&quot;</span>
        <span class="n">download_from_url</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">zip_url</span><span class="p">,</span> <span class="n">out_file_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">repo_name</span> <span class="o">+</span> <span class="s2">&quot;-master&quot;</span><span class="p">)</span>
        <span class="n">pkg_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">work_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Installing </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">))</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;pip install .&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> has been installed successfully.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">))</span>
        <span class="c1"># print(&quot;\nPlease comment out &#39;install_from_github()&#39; and restart the kernel to take effect:\nJupyter menu -&gt; Kernel -&gt; Restart &amp; Clear Output&quot;)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.add_crs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_crs</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">epsg</span><span class="p">)</span></code>


<a href="#leafmap.common.add_crs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Add a CRS to a raster dataset.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The filename of the raster dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>epsg</code></td>
        <td><code>int | str</code></td>
        <td><p>The EPSG code of the CRS.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_crs</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">epsg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a CRS to a raster dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The filename of the raster dataset.</span>
<span class="sd">        epsg (int | str): The EPSG code of the CRS.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;rasterio is required for adding a CRS to a raster. Please install it using &#39;pip install rasterio&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;filename must exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">epsg</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">epsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">epsg</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">epsg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">epsg</span> <span class="o">=</span> <span class="s2">&quot;EPSG:&quot;</span> <span class="o">+</span> <span class="n">epsg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;epsg must be an integer or string.&quot;</span><span class="p">)</span>

    <span class="n">crs</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">CRS</span><span class="p">({</span><span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="n">epsg</span><span class="p">})</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.add_image_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_image_to_gif</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">in_image</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">circle_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.add_image_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds an image logo to a GIF image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>Input file path to the GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>Output file path to the GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>in_image</code></td>
        <td><code>str</code></td>
        <td><p>Input file path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>image_size</code></td>
        <td><code>tuple</code></td>
        <td><p>Resize image. Defaults to (80, 80).</p></td>
        <td><code>(80, 80)</code></td>
      </tr>
      <tr>
        <td><code>circle_mask</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply a circle mask to the image. This only works with non-png images. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_image_to_gif</span><span class="p">(</span>
    <span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">in_image</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_size</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">circle_mask</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds an image logo to a GIF image.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): Input file path to the GIF image.</span>
<span class="sd">        out_gif (str): Output file path to the GIF image.</span>
<span class="sd">        in_image (str): Input file path to the image.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        image_size (tuple, optional): Resize image. Defaults to (80, 80).</span>
<span class="sd">        circle_mask (bool, optional): Whether to apply a circle mask to the image. This only works with non-png images. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">io</span>

    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageSequence</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>

    <span class="n">is_url</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">in_image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">is_url</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_url</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_image</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The provided logo file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">check_dir</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">gif</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An error occurred while opening the image.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">logo_raw_image</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">in_image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">logo_raw_image</span> <span class="o">=</span> <span class="n">open_image_from_url</span><span class="p">(</span><span class="n">in_image</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_image</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_image</span><span class="p">)</span>
            <span class="n">logo_raw_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_image</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">logo_raw_size</span> <span class="o">=</span> <span class="n">logo_raw_image</span><span class="o">.</span><span class="n">size</span>

    <span class="n">ratio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">image_resize</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">ratio</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">ratio</span><span class="p">))</span>
    <span class="n">image_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">min</span><span class="p">(</span>
        <span class="n">logo_raw_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">logo_image</span> <span class="o">=</span> <span class="n">logo_raw_image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
    <span class="n">logo_image</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">ANTIALIAS</span><span class="p">)</span>

    <span class="n">gif_width</span><span class="p">,</span> <span class="n">gif_height</span> <span class="o">=</span> <span class="n">gif</span><span class="o">.</span><span class="n">size</span>
    <span class="n">mask_im</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">circle_mask</span><span class="p">:</span>
        <span class="n">mask_im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">mask_im</span><span class="p">)</span>
        <span class="n">draw</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">image_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">has_transparency</span><span class="p">(</span><span class="n">logo_raw_image</span><span class="p">):</span>
        <span class="n">mask_im</span> <span class="o">=</span> <span class="n">logo_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># default logo location is 5% width and 5% height of the image.</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gif_width</span> <span class="o">-</span> <span class="n">image_resize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gif_height</span> <span class="o">-</span> <span class="n">image_resize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span>
        <span class="c1"># xy = (int(0.05 * gif_width), int(0.05 * gif_height))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xy must be a tuple, e.g., (10, 10), (&#39;10%&#39;, &#39;10%&#39;)&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">gif_width</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">gif_height</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;xy is out of bounds. x must be within [0, </span><span class="si">{}</span><span class="s2">], and y must be within [0, </span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">gif_width</span><span class="p">,</span> <span class="n">gif_height</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">gif_width</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">gif_height</span><span class="p">)</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The specified xy is invalid. It must be formatted like this (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
                <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;The specified xy is invalid. It must be formatted like this: (10, 10) or (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">gif</span><span class="p">)):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">logo_image</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">mask_im</span><span class="p">)</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

        <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.add_mask_to_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_mask_to_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.add_mask_to_image" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Overlay a binary mask (e.g., roads, building footprints, etc) on an image. Credits to Xingjian Shi for the sample code.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>A local path or HTTP URL to an image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mask</code></td>
        <td><code>str</code></td>
        <td><p>A local path or HTTP URL to a binary mask.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>A local path to the output image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>color</code></td>
        <td><code>str</code></td>
        <td><p>Color of the mask. Defaults to 'red'.</p></td>
        <td><code>&#39;red&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If rasterio and detectron2 are not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_mask_to_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overlay a binary mask (e.g., roads, building footprints, etc) on an image. Credits to Xingjian Shi for the sample code.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): A local path or HTTP URL to an image.</span>
<span class="sd">        mask (str): A local path or HTTP URL to a binary mask.</span>
<span class="sd">        output (str): A local path to the output image.</span>
<span class="sd">        color (str, optional): Color of the mask. Defaults to &#39;red&#39;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If rasterio and detectron2 are not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">rasterio</span>
        <span class="kn">from</span> <span class="nn">detectron2.utils.visualizer</span> <span class="kn">import</span> <span class="n">Visualizer</span>
        <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;Please install rasterio and detectron2 to use this function. See https://detectron2.readthedocs.io/en/latest/tutorials/install.html&quot;</span>
        <span class="p">)</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">image_arr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">mask_arr</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">vis</span> <span class="o">=</span> <span class="n">Visualizer</span><span class="p">(</span><span class="n">image_arr</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="n">vis</span><span class="o">.</span><span class="n">draw_binary_mask</span><span class="p">(</span><span class="n">mask_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="n">out_arr</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">vis</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span><span class="o">.</span><span class="n">get_image</span><span class="p">())</span>

    <span class="n">out_arr</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">numpy_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.add_progress_bar_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_progress_bar_to_gif</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#leafmap.common.add_progress_bar_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds a progress bar to a GIF image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>duration</code></td>
        <td><code>int</code></td>
        <td><p>controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation. Defaults to 100.</p></td>
        <td><code>100</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_progress_bar_to_gif</span><span class="p">(</span>
    <span class="n">in_gif</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a progress bar to a GIF image.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The file path to the input GIF image.</span>
<span class="sd">        out_gif (str): The file path to the output GIF image.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        duration (int, optional): controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation. Defaults to 100.</span>
<span class="sd">        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">io</span>

    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageSequence</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="n">progress_bar_color</span> <span class="o">=</span> <span class="n">check_color</span><span class="p">(</span><span class="n">progress_bar_color</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;An error occurred while opening the gif.&quot;</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">n_frames</span>
    <span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="n">progress_bar_widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">count</span> <span class="o">*</span> <span class="n">W</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">progress_bar_shapes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">H</span> <span class="o">-</span> <span class="n">progress_bar_height</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">H</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">progress_bar_widths</span>
    <span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over each frame in the animated image</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">)):</span>
            <span class="c1"># Draw the text on the frame</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="c1"># w, h = draw.textsize(text[index])</span>
            <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">progress_bar_shapes</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">draw</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="c1"># https://www.pythoninformer.com/python-libraries/pillow/creating-animated-gif/</span>
        <span class="c1"># Save the frames as a new image</span>

        <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.add_text_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_text_to_gif</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#leafmap.common.add_text_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds animated text to a GIF image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>Top left corner of the text. It can be formatted like this: (10, 10) or ('15%', '25%'). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>int, str, list</code></td>
        <td><p>Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>Font type. Defaults to "arial.ttf".</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>Font color. It can be a string (e.g., 'red'), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., '#ff00ff').  Defaults to '#000000'.</p></td>
        <td><code>&#39;#000000&#39;</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar at the bottom of the GIF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>Color for the progress bar. Defaults to 'white'.</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>duration</code></td>
        <td><code>int</code></td>
        <td><p>controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation.. Defaults to 100.</p></td>
        <td><code>100</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_text_to_gif</span><span class="p">(</span>
    <span class="n">in_gif</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds animated text to a GIF image.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The file path to the input GIF image.</span>
<span class="sd">        out_gif (str): The file path to the output GIF image.</span>
<span class="sd">        xy (tuple, optional): Top left corner of the text. It can be formatted like this: (10, 10) or (&#39;15%&#39;, &#39;25%&#39;). Defaults to None.</span>
<span class="sd">        text_sequence (int, str, list, optional): Text to be drawn. It can be an integer number, a string, or a list of strings. Defaults to None.</span>
<span class="sd">        font_type (str, optional): Font type. Defaults to &quot;arial.ttf&quot;.</span>
<span class="sd">        font_size (int, optional): Font size. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): Font color. It can be a string (e.g., &#39;red&#39;), rgb tuple (e.g., (255, 127, 0)), or hex code (e.g., &#39;#ff00ff&#39;).  Defaults to &#39;#000000&#39;.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar at the bottom of the GIF. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): Color for the progress bar. Defaults to &#39;white&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): Height of the progress bar. Defaults to 5.</span>
<span class="sd">        duration (int, optional): controls how long each frame will be displayed for, in milliseconds. It is the inverse of the frame rate. Setting it to 100 milliseconds gives 10 frames per second. You can decrease the duration to give a smoother animation.. Defaults to 100.</span>
<span class="sd">        loop (int, optional): controls how many times the animation repeats. The default, 1, means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">io</span>

    <span class="kn">import</span> <span class="nn">pkg_resources</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span><span class="p">,</span> <span class="n">ImageSequence</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s2">&quot;leafmap&quot;</span><span class="p">,</span> <span class="s2">&quot;leafmap.py&quot;</span><span class="p">))</span>
    <span class="n">default_font</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/fonts/arial.ttf&quot;</span><span class="p">)</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">font_type</span> <span class="o">==</span> <span class="s2">&quot;arial.ttf&quot;</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">font_type</span> <span class="o">==</span> <span class="s2">&quot;alibaba.otf&quot;</span><span class="p">:</span>
        <span class="n">default_font</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/fonts/alibaba.otf&quot;</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">font_list</span> <span class="o">=</span> <span class="n">system_fonts</span><span class="p">(</span><span class="n">show_full_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">font_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">font_list</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">font_type</span> <span class="ow">in</span> <span class="n">font_list</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">font_type</span> <span class="ow">in</span> <span class="n">font_names</span><span class="p">):</span>
                <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">font_type</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The specified font type could not be found on your system. Using the default font instead.&quot;</span>
                <span class="p">)</span>
                <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">default_font</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>

    <span class="n">color</span> <span class="o">=</span> <span class="n">check_color</span><span class="p">(</span><span class="n">font_color</span><span class="p">)</span>
    <span class="n">progress_bar_color</span> <span class="o">=</span> <span class="n">check_color</span><span class="p">(</span><span class="n">progress_bar_color</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An error occurred while opening the gif.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">count</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">n_frames</span>
    <span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="n">progress_bar_widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">count</span> <span class="o">*</span> <span class="n">W</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">progress_bar_shapes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">H</span> <span class="o">-</span> <span class="n">progress_bar_height</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">H</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">progress_bar_widths</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># default text location is 5% width and 5% height of the image.</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xy must be a tuple, e.g., (10, 10), (&#39;10%&#39;, &#39;10%&#39;)&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">W</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;xy is out of bounds. x must be within [0, </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s2">], and y must be within [0, </span><span class="si">{</span><span class="n">H</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">W</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The specified xy is invalid. It must be formatted like this (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The specified xy is invalid. It must be formatted like this: (10, 10) or (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">text_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="n">text_sequence</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">text_sequence</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="n">text_sequence</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">text_sequence</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_sequence</span><span class="p">)</span> <span class="o">!=</span> <span class="n">count</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The length of the text sequence must be equal to the number (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">) of frames in the gif.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">text_sequence</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over each frame in the animated image</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ImageSequence</span><span class="o">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">image</span><span class="p">)):</span>
            <span class="c1"># Draw the text on the frame</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="c1"># w, h = draw.textsize(text[index])</span>
            <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">add_progress_bar</span><span class="p">:</span>
                <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">progress_bar_shapes</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="n">progress_bar_color</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">draw</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="c1"># https://www.pythoninformer.com/python-libraries/pillow/creating-animated-gif/</span>
        <span class="c1"># Save the frames as a new image</span>

        <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.adjust_longitude" class="doc doc-heading">
<code class="highlight language-python"><span class="n">adjust_longitude</span><span class="p">(</span><span class="n">in_fc</span><span class="p">)</span></code>


<a href="#leafmap.common.adjust_longitude" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adjusts longitude if it is less than -180 or greater than 180.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_fc</code></td>
        <td><code>dict</code></td>
        <td><p>The input dictionary containing coordinates.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary containing the converted longitudes</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">adjust_longitude</span><span class="p">(</span><span class="n">in_fc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjusts longitude if it is less than -180 or greater than 180.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_fc (dict): The input dictionary containing coordinates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the converted longitudes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">in_fc</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Point&quot;</span><span class="p">:</span>
                <span class="n">longitude</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                    <span class="n">longitude</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">longitude</span>
                <span class="k">elif</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                    <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="mi">360</span>
                <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

            <span class="k">elif</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index1</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="n">longitude</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                            <span class="n">longitude</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">longitude</span>
                        <span class="k">elif</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                            <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="mi">360</span>
                        <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="n">index1</span><span class="p">][</span><span class="n">index2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

            <span class="k">elif</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LineString&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
                    <span class="n">longitude</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                        <span class="n">longitude</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">longitude</span>
                    <span class="k">elif</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                        <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="mi">360</span>
                    <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

        <span class="k">elif</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Point&quot;</span><span class="p">:</span>
                <span class="n">longitude</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                    <span class="n">longitude</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">longitude</span>
                <span class="k">elif</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                    <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="mi">360</span>
                <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

            <span class="k">elif</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index1</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">index2</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="n">longitude</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                            <span class="n">longitude</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">longitude</span>
                        <span class="k">elif</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                            <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="mi">360</span>
                        <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="n">index1</span><span class="p">][</span><span class="n">index2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

            <span class="k">elif</span> <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LineString&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
                    <span class="n">longitude</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                        <span class="n">longitude</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">longitude</span>
                    <span class="k">elif</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                        <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="mi">360</span>
                    <span class="n">in_fc</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">longitude</span>

        <span class="k">return</span> <span class="n">in_fc</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.arc_active_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arc_active_map</span><span class="p">()</span></code>


<a href="#leafmap.common.arc_active_map" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the active map in ArcGIS Pro.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>arcpy.Map</code></td>
      <td><p>The active map in ArcGIS Pro.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">arc_active_map</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the active map in ArcGIS Pro.</span>

<span class="sd">    Returns:</span>
<span class="sd">        arcpy.Map: The active map in ArcGIS Pro.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_arcpy</span><span class="p">():</span>
        <span class="kn">import</span> <span class="nn">arcpy</span>

        <span class="n">aprx</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">ArcGISProject</span><span class="p">(</span><span class="s2">&quot;CURRENT&quot;</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">aprx</span><span class="o">.</span><span class="n">activeMap</span>
        <span class="k">return</span> <span class="n">m</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.arc_active_view" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arc_active_view</span><span class="p">()</span></code>


<a href="#leafmap.common.arc_active_view" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the active view in ArcGIS Pro.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>arcpy.MapView</code></td>
      <td><p>The active view in ArcGIS Pro.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">arc_active_view</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the active view in ArcGIS Pro.</span>

<span class="sd">    Returns:</span>
<span class="sd">        arcpy.MapView: The active view in ArcGIS Pro.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_arcpy</span><span class="p">():</span>
        <span class="kn">import</span> <span class="nn">arcpy</span>

        <span class="n">aprx</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">ArcGISProject</span><span class="p">(</span><span class="s2">&quot;CURRENT&quot;</span><span class="p">)</span>
        <span class="n">view</span> <span class="o">=</span> <span class="n">aprx</span><span class="o">.</span><span class="n">activeView</span>
        <span class="k">return</span> <span class="n">view</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.arc_add_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arc_add_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>


<a href="#leafmap.common.arc_add_layer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Add a layer to the active map in ArcGIS Pro.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the tile layer to add.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the layer. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>shown</code></td>
        <td><code>bool</code></td>
        <td><p>Whether the layer is shown. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the layer. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">arc_add_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a layer to the active map in ArcGIS Pro.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the tile layer to add.</span>
<span class="sd">        name (str, optional): The name of the layer. Defaults to None.</span>
<span class="sd">        shown (bool, optional): Whether the layer is shown. Defaults to True.</span>
<span class="sd">        opacity (float, optional): The opacity of the layer. Defaults to 1.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_arcpy</span><span class="p">():</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">arc_active_map</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">addDataFromPath</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">layers</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">listLayers</span><span class="p">(</span><span class="s2">&quot;Tiled service layer&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">layer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
                    <span class="n">layer</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="n">shown</span>
                    <span class="n">layer</span><span class="o">.</span><span class="n">transparency</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="p">(</span><span class="n">opacity</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.arc_zoom_to_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arc_zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></code>


<a href="#leafmap.common.arc_zoom_to_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Zoom to a bounding box.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bounds</code></td>
        <td><code>list</code></td>
        <td><p>The bounding box to zoom to in the form [xmin, ymin, xmax, ymax] or [(ymin, xmin), (ymax, xmax)].</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p><em>description</em></p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">arc_zoom_to_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Zoom to a bounding box.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (list): The bounding box to zoom to in the form [xmin, ymin, xmax, ymax] or [(ymin, xmin), (ymax, xmax)].</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">bounds</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">xmin</span><span class="p">),</span> <span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span> <span class="o">=</span> <span class="n">bounds</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bounds must be a tuple of length 2 or 4.&quot;</span><span class="p">)</span>

    <span class="n">arc_zoom_to_extent</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.arc_zoom_to_extent" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arc_zoom_to_extent</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span></code>


<a href="#leafmap.common.arc_zoom_to_extent" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Zoom to an extent in ArcGIS Pro.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum x value of the extent.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ymin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum y value of the extent.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>xmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum x value of the extent.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ymax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum y value of the extent.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">arc_zoom_to_extent</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Zoom to an extent in ArcGIS Pro.</span>

<span class="sd">    Args:</span>
<span class="sd">        xmin (float): The minimum x value of the extent.</span>
<span class="sd">        ymin (float): The minimum y value of the extent.</span>
<span class="sd">        xmax (float): The maximum x value of the extent.</span>
<span class="sd">        ymax (float): The maximum y value of the extent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_arcpy</span><span class="p">():</span>
        <span class="kn">import</span> <span class="nn">arcpy</span>

        <span class="n">view</span> <span class="o">=</span> <span class="n">arc_active_view</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">view</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">view</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">setExtent</span><span class="p">(</span>
                <span class="n">arcpy</span><span class="o">.</span><span class="n">Extent</span><span class="p">(</span>
                    <span class="n">xmin</span><span class="p">,</span>
                    <span class="n">ymin</span><span class="p">,</span>
                    <span class="n">xmax</span><span class="p">,</span>
                    <span class="n">ymax</span><span class="p">,</span>
                    <span class="n">spatial_reference</span><span class="o">=</span><span class="n">arcpy</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">(</span><span class="mi">4326</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># if isinstance(zoom, int):</span>
        <span class="c1">#     scale = 156543.04 * math.cos(0) / math.pow(2, zoom)</span>
        <span class="c1">#     view.camera.scale = scale  # Not working properly</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.array_to_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">array_to_image</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="s1">&#39;deflate&#39;</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;COG&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.array_to_image" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Save a NumPy array as a GeoTIFF using the projection information from an existing GeoTIFF file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>array</code></td>
        <td><code>np.ndarray</code></td>
        <td><p>The NumPy array to be saved as a GeoTIFF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output image. If None, a temporary file will be created. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to an existing GeoTIFF file with map projection information. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dtype</code></td>
        <td><code>np.dtype</code></td>
        <td><p>The data type of the output array. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>compress</code></td>
        <td><code>str</code></td>
        <td><p>The compression method. Can be one of the following: "deflate", "lzw", "packbits", "jpeg". Defaults to "deflate".</p></td>
        <td><code>&#39;deflate&#39;</code></td>
      </tr>
      <tr>
        <td><code>transpose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>cellsize</code></td>
        <td><code>float</code></td>
        <td><p>The resolution of the output image in meters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The CRS of the output image. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>transform</code></td>
        <td><code>tuple</code></td>
        <td><p>The affine transformation matrix, can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361).
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>driver</code></td>
        <td><code>str</code></td>
        <td><p>The driver to use for creating the output file, such as 'GTiff'. Defaults to "COG".</p></td>
        <td><code>&#39;COG&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the rasterio.open() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">array_to_image</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">compress</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;deflate&quot;</span><span class="p">,</span>
    <span class="n">transpose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">cellsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">transform</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">driver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;COG&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save a NumPy array as a GeoTIFF using the projection information from an existing GeoTIFF file.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (np.ndarray): The NumPy array to be saved as a GeoTIFF.</span>
<span class="sd">        output (str): The path to the output image. If None, a temporary file will be created. Defaults to None.</span>
<span class="sd">        source (str, optional): The path to an existing GeoTIFF file with map projection information. Defaults to None.</span>
<span class="sd">        dtype (np.dtype, optional): The data type of the output array. Defaults to None.</span>
<span class="sd">        compress (str, optional): The compression method. Can be one of the following: &quot;deflate&quot;, &quot;lzw&quot;, &quot;packbits&quot;, &quot;jpeg&quot;. Defaults to &quot;deflate&quot;.</span>
<span class="sd">        transpose (bool, optional): Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.</span>
<span class="sd">        cellsize (float, optional): The resolution of the output image in meters. Defaults to None.</span>
<span class="sd">        crs (str, optional): The CRS of the output image. Defaults to None.</span>
<span class="sd">        transform (tuple, optional): The affine transformation matrix, can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361).</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        driver (str, optional): The driver to use for creating the output file, such as &#39;GTiff&#39;. Defaults to &quot;COG&quot;.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the rasterio.open() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    <span class="kn">from</span> <span class="nn">rasterio.transform</span> <span class="kn">import</span> <span class="n">Affine</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array_to_memory_file</span><span class="p">(</span>
            <span class="n">array</span><span class="p">,</span>
            <span class="n">source</span><span class="p">,</span>
            <span class="n">dtype</span><span class="p">,</span>
            <span class="n">compress</span><span class="p">,</span>
            <span class="n">transpose</span><span class="p">,</span>
            <span class="n">cellsize</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">driver</span><span class="o">=</span><span class="n">driver</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="n">x_dim</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y_dim</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">array</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">array</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">y_dim</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">transpose</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;.tif&quot;</span>

    <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
            <span class="k">if</span> <span class="n">compress</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">compress</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">compression</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cellsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;resolution must be provided if source is not provided&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;crs must be provided if source is not provided, such as EPSG:3857&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Define the geotransformation parameters</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">cellsize</span> <span class="o">*</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">cellsize</span> <span class="o">*</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">Affine</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">Affine</span><span class="p">(</span><span class="o">*</span><span class="n">transform</span><span class="p">)</span>

        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Determine the minimum and maximum values in the array</span>
        <span class="n">min_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="c1"># Determine the best dtype for the array</span>
        <span class="k">if</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">128</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">127</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">65535</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">32768</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">32767</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>

    <span class="c1"># Convert the array to the best dtype</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># Define the GeoTIFF metadata</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="n">driver</span><span class="p">,</span>
        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
        <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">crs</span><span class="p">,</span>
        <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="n">transform</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">compress</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;compress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compress</span>

    <span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Create a new GeoTIFF file and write the array to it</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.array_to_memory_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">array_to_memory_file</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="s1">&#39;deflate&#39;</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cellsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;COG&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.array_to_memory_file" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a NumPy array to a memory file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>array</code></td>
        <td><code>numpy.ndarray</code></td>
        <td><p>The input NumPy array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>Path to the source file to extract metadata from. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dtype</code></td>
        <td><code>str</code></td>
        <td><p>The desired data type of the array. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>compress</code></td>
        <td><code>str</code></td>
        <td><p>The compression method for the output file. Defaults to "deflate".</p></td>
        <td><code>&#39;deflate&#39;</code></td>
      </tr>
      <tr>
        <td><code>transpose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>cellsize</code></td>
        <td><code>float</code></td>
        <td><p>The cell size of the array if source is not provided. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system of the array if source is not provided. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>transform</code></td>
        <td><code>tuple</code></td>
        <td><p>The affine transformation matrix if source is not provided.
Can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361). Defaults to None</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>driver</code></td>
        <td><code>str</code></td>
        <td><p>The driver to use for creating the output file, such as 'GTiff'. Defaults to "COG".</p></td>
        <td><code>&#39;COG&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the rasterio.open() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rasterio.DatasetReader</code></td>
      <td><p>The rasterio dataset reader object for the converted array.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">array_to_memory_file</span><span class="p">(</span>
    <span class="n">array</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">compress</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;deflate&quot;</span><span class="p">,</span>
    <span class="n">transpose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">cellsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">transform</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;COG&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a NumPy array to a memory file.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (numpy.ndarray): The input NumPy array.</span>
<span class="sd">        source (str, optional): Path to the source file to extract metadata from. Defaults to None.</span>
<span class="sd">        dtype (str, optional): The desired data type of the array. Defaults to None.</span>
<span class="sd">        compress (str, optional): The compression method for the output file. Defaults to &quot;deflate&quot;.</span>
<span class="sd">        transpose (bool, optional): Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.</span>
<span class="sd">        cellsize (float, optional): The cell size of the array if source is not provided. Defaults to None.</span>
<span class="sd">        crs (str, optional): The coordinate reference system of the array if source is not provided. Defaults to None.</span>
<span class="sd">        transform (tuple, optional): The affine transformation matrix if source is not provided.</span>
<span class="sd">            Can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361). Defaults to None</span>
<span class="sd">        driver (str, optional): The driver to use for creating the output file, such as &#39;GTiff&#39;. Defaults to &quot;COG&quot;.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the rasterio.open() function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        rasterio.DatasetReader: The rasterio dataset reader object for the converted array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    <span class="kn">from</span> <span class="nn">rasterio.transform</span> <span class="kn">import</span> <span class="n">Affine</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="n">x_dim</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y_dim</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">array</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">array</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">y_dim</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="s2">&quot;rio&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">rio</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">):</span>
                <span class="n">crs</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span>
            <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">rio</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">):</span>
                <span class="n">transform</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;source&quot;</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">encoding</span><span class="p">:</span>
                    <span class="n">source</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">transpose</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
            <span class="k">if</span> <span class="n">compress</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">compress</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">compression</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;crs must be provided if source is not provided, such as EPSG:3857&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cellsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cellsize must be provided if source is not provided&quot;</span><span class="p">)</span>
            <span class="c1"># Define the geotransformation parameters</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">cellsize</span> <span class="o">*</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">cellsize</span> <span class="o">*</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="c1"># (west, south, east, north, width, height)</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">Affine</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">Affine</span><span class="p">(</span><span class="o">*</span><span class="n">transform</span><span class="p">)</span>

        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Determine the minimum and maximum values in the array</span>
        <span class="n">min_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="c1"># Determine the best dtype for the array</span>
        <span class="k">if</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">128</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">127</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">65535</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span>
        <span class="k">elif</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">32768</span> <span class="ow">and</span> <span class="n">max_value</span> <span class="o">&lt;=</span> <span class="mi">32767</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>

    <span class="c1"># Convert the array to the best dtype</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># Define the GeoTIFF metadata</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="n">driver</span><span class="p">,</span>
        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
        <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">crs</span><span class="p">,</span>
        <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="n">transform</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">compress</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;compress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compress</span>

    <span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Create a new memory file and write the array to it</span>
    <span class="n">memory_file</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">MemoryFile</span><span class="p">()</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="n">memory_file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">**</span><span class="n">metadata</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">dst</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Read the dataset from memory</span>
    <span class="n">dataset_reader</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset_reader</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.assign_continuous_colors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assign_continuous_colors</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classification_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_rgb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="n">return_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.assign_continuous_colors" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Assigns continuous colors to a DataFrame column based on a specified scheme.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td></td>
        <td><p>A pandas DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>column</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column to assign colors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The name of the colormap to use.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of custom colors.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>A list of custom labels for the legend.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>scheme</code></td>
        <td><code>str</code></td>
        <td><p>The scheme for classifying the data. Default is 'Quantiles'.</p></td>
        <td><code>&#39;Quantiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>k</code></td>
        <td><code>int</code></td>
        <td><p>The number of classes for classification.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>legend_kwds</code></td>
        <td><code>dict</code></td>
        <td><p>Additional keyword arguments for configuring the legend.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>classification_kwds</code></td>
        <td><code>dict</code></td>
        <td><p>Additional keyword arguments for configuring the classification.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_rgb</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert colors to RGB values. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>The type of the returned values. Default is 'array'.</p></td>
        <td><code>&#39;array&#39;</code></td>
      </tr>
      <tr>
        <td><code>return_legend</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the legend. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The assigned colors as a numpy array or a tuple containing the colors and the legend, depending on the value of return_legend.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">assign_continuous_colors</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Quantiles&quot;</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">legend_kwds</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">classification_kwds</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_rgb</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
    <span class="n">return_legend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assigns continuous colors to a DataFrame column based on a specified scheme.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: A pandas DataFrame.</span>
<span class="sd">        column: The name of the column to assign colors.</span>
<span class="sd">        cmap: The name of the colormap to use.</span>
<span class="sd">        colors: A list of custom colors.</span>
<span class="sd">        labels: A list of custom labels for the legend.</span>
<span class="sd">        scheme: The scheme for classifying the data. Default is &#39;Quantiles&#39;.</span>
<span class="sd">        k: The number of classes for classification.</span>
<span class="sd">        legend_kwds: Additional keyword arguments for configuring the legend.</span>
<span class="sd">        classification_kwds: Additional keyword arguments for configuring the classification.</span>
<span class="sd">        to_rgb: Whether to convert colors to RGB values. Default is True.</span>
<span class="sd">        return_type: The type of the returned values. Default is &#39;array&#39;.</span>
<span class="sd">        return_legend: Whether to return the legend. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The assigned colors as a numpy array or a tuple containing the colors and the legend, depending on the value of return_legend.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">column</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">new_df</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="n">classify</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">legend_kwds</span><span class="p">,</span> <span class="n">classification_kwds</span>
    <span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">to_rgb</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">check_color</span><span class="p">(</span><span class="n">color</span><span class="p">))</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_legend</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">values</span><span class="p">,</span> <span class="n">legend</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">values</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.assign_discrete_colors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assign_discrete_colors</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">to_rgb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.assign_discrete_colors" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Assigns unique colors to each category in a categorical column of a dataframe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pandas.DataFrame</code></td>
        <td><p>The input dataframe.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>column</code></td>
        <td><code>str</code></td>
        <td><p>The name of the categorical column.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary mapping categories to colors.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_rgb</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the colors to RGB values. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>The type of the returned values. Can be 'list' or 'array'. Defaults to 'array'.</p></td>
        <td><code>&#39;array&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of colors for each category in the categorical column.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">assign_discrete_colors</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">to_rgb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;array&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns unique colors to each category in a categorical column of a dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): The input dataframe.</span>
<span class="sd">        column (str): The name of the categorical column.</span>
<span class="sd">        cmap (dict): A dictionary mapping categories to colors.</span>
<span class="sd">        to_rgb (bool): Whether to convert the colors to RGB values. Defaults to True.</span>
<span class="sd">        return_type (str): The type of the returned values. Can be &#39;list&#39; or &#39;array&#39;. Defaults to &#39;array&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of colors for each category in the categorical column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="c1"># Copy the categorical column from the original dataframe</span>
    <span class="n">category_column</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Map colors to the categorical values</span>
    <span class="n">category_column</span> <span class="o">=</span> <span class="n">category_column</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">category_column</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">to_rgb</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">check_color</span><span class="p">(</span><span class="n">color</span><span class="p">))</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">values</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.basemap_xyz_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">basemap_xyz_tiles</span><span class="p">()</span></code>


<a href="#leafmap.common.basemap_xyz_tiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns a dictionary containing a set of basemaps that are XYZ tile layers.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of XYZ tile layers.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">basemap_xyz_tiles</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a dictionary containing a set of basemaps that are XYZ tile layers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of XYZ tile layers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.leafmap</span> <span class="kn">import</span> <span class="n">basemaps</span>

    <span class="n">layers_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">basemaps</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">basemaps</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WMSLayer</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layers_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">basemaps</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">layers_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.bbox_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bbox_to_gdf</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.bbox_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a bounding box to a GeoPandas GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list</code></td>
        <td><p>A bounding box in the format of [minx, miny, maxx, maxy].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The CRS of the bounding box. Defaults to 'epsg:4326'.</p></td>
        <td><code>&#39;epsg:4326&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>GeoDataFrame</code></td>
      <td><p>A GeoDataFrame with a single polygon.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bbox_to_gdf</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a bounding box to a GeoPandas GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        bbox (list): A bounding box in the format of [minx, miny, maxx, maxy].</span>
<span class="sd">        crs (str, optional): The CRS of the bounding box. Defaults to &#39;epsg:4326&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoDataFrame: A GeoDataFrame with a single polygon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>

    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
        <span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="n">Polygon</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="o">*</span><span class="n">bbox</span><span class="p">)],</span>
        <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.bbox_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bbox_to_geojson</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></code>


<a href="#leafmap.common.bbox_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert coordinates of a bounding box to a geojson.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bounds</code></td>
        <td><code>list | tuple</code></td>
        <td><p>A list of coordinates representing [left, bottom, right, top] or m.bounds.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A geojson feature.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bbox_to_geojson</span><span class="p">(</span><span class="n">bounds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert coordinates of a bounding box to a geojson.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (list | tuple): A list of coordinates representing [left, bottom, right, top] or m.bounds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A geojson feature.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
                    <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
                    <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
                <span class="p">]</span>
            <span class="p">],</span>
        <span class="p">},</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.bbox_to_polygon" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bbox_to_polygon</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span></code>


<a href="#leafmap.common.bbox_to_polygon" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a bounding box to a shapely Polygon.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list</code></td>
        <td><p>A bounding box in the format of [minx, miny, maxx, maxy].</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Polygon</code></td>
      <td><p>A shapely Polygon.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bbox_to_polygon</span><span class="p">(</span><span class="n">bbox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a bounding box to a shapely Polygon.</span>

<span class="sd">    Args:</span>
<span class="sd">        bbox (list): A bounding box in the format of [minx, miny, maxx, maxy].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Polygon: A shapely Polygon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>

    <span class="k">return</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="o">*</span><span class="n">bbox</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.blend_images" class="doc doc-heading">
<code class="highlight language-python"><span class="n">blend_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.blend_images" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Blends two images together using the addWeighted function from the OpenCV library.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img1</code></td>
        <td><code>numpy.ndarray</code></td>
        <td><p>The first input image on top represented as a NumPy array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>img2</code></td>
        <td><code>numpy.ndarray</code></td>
        <td><p>The second input image at the bottom represented as a NumPy array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>alpha</code></td>
        <td><code>float</code></td>
        <td><p>The weighting factor for the first image in the blend. By default, this is set to 0.5.</p></td>
        <td><code>0.5</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output image. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>show</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to display the blended image. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>The size of the figure. Defaults to (12, 10).</p></td>
        <td><code>(12, 10)</code></td>
      </tr>
      <tr>
        <td><code>axis</code></td>
        <td><code>str</code></td>
        <td><p>The axis of the figure. Defaults to "off".</p></td>
        <td><code>&#39;off&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to the cv2.addWeighted() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>numpy.ndarray</code></td>
      <td><p>The blended image as a NumPy array.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">blend_images</span><span class="p">(</span>
    <span class="n">img1</span><span class="p">,</span>
    <span class="n">img2</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Blends two images together using the addWeighted function from the OpenCV library.</span>

<span class="sd">    Args:</span>
<span class="sd">        img1 (numpy.ndarray): The first input image on top represented as a NumPy array.</span>
<span class="sd">        img2 (numpy.ndarray): The second input image at the bottom represented as a NumPy array.</span>
<span class="sd">        alpha (float): The weighting factor for the first image in the blend. By default, this is set to 0.5.</span>
<span class="sd">        output (str, optional): The path to the output image. Defaults to False.</span>
<span class="sd">        show (bool, optional): Whether to display the blended image. Defaults to True.</span>
<span class="sd">        figsize (tuple, optional): The size of the figure. Defaults to (12, 10).</span>
<span class="sd">        axis (str, optional): The axis of the figure. Defaults to &quot;off&quot;.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the cv2.addWeighted() function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: The blended image as a NumPy array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">cv2</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="c1"># Resize the images to have the same dimensions</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">img1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">img1</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">img1</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">img1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input path </span><span class="si">{</span><span class="n">img1</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="n">img1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img1</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">img2</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">img2</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">img2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input path </span><span class="si">{</span><span class="n">img2</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="n">img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">img1</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">:</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="p">(</span><span class="n">img1</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">img2</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">:</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="p">(</span><span class="n">img2</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">img1</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">img2</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">img1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="n">img1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="c1"># Blend the images using the addWeighted function</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span>
    <span class="n">blend_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">array_to_image</span><span class="p">(</span><span class="n">blend_img</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">img2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blend_img</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blend_img</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.bounds_to_xy_range" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bounds_to_xy_range</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></code>


<a href="#leafmap.common.bounds_to_xy_range" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert bounds to x and y range to be used as input to bokeh map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bounds</code></td>
        <td><code>list</code></td>
        <td><p>A list of bounds in the form [(south, west), (north, east)] or [xmin, ymin, xmax, ymax].</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of (x_range, y_range).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bounds_to_xy_range</span><span class="p">(</span><span class="n">bounds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert bounds to x and y range to be used as input to bokeh map.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds (list): A list of bounds in the form [(south, west), (north, east)] or [xmin, ymin, xmax, ymax].</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of (x_range, y_range).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;bounds must be a list&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">north</span> <span class="o">=</span> <span class="n">bounds</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">south</span><span class="p">,</span> <span class="n">west</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">north</span><span class="p">,</span> <span class="n">east</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">)</span>
    <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">north</span><span class="p">)</span>
    <span class="n">x_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">y_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.center_zoom_to_xy_range" class="doc doc-heading">
<code class="highlight language-python"><span class="n">center_zoom_to_xy_range</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span></code>


<a href="#leafmap.common.center_zoom_to_xy_range" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert center and zoom to x and y range to be used as input to bokeh map.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>center</code></td>
        <td><code>tuple</code></td>
        <td><p>A tuple of (latitude, longitude).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>The zoom level.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of (x_range, y_range).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">center_zoom_to_xy_range</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">zoom</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert center and zoom to x and y range to be used as input to bokeh map.</span>

<span class="sd">    Args:</span>
<span class="sd">        center (tuple): A tuple of (latitude, longitude).</span>
<span class="sd">        zoom (int): The zoom level.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of (x_range, y_range).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;center must be a tuple or list&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;zoom must be an integer&quot;</span><span class="p">)</span>

    <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">center</span>
    <span class="n">x_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">179</span><span class="p">,</span> <span class="mi">179</span><span class="p">)</span>
    <span class="n">y_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
    <span class="n">x_full_length</span> <span class="o">=</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_full_length</span> <span class="o">=</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">x_length</span> <span class="o">=</span> <span class="n">x_full_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">zoom</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">y_length</span> <span class="o">=</span> <span class="n">y_full_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">zoom</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">south</span> <span class="o">=</span> <span class="n">latitude</span> <span class="o">-</span> <span class="n">y_length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">north</span> <span class="o">=</span> <span class="n">latitude</span> <span class="o">+</span> <span class="n">y_length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">west</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">-</span> <span class="n">x_length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">east</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">+</span> <span class="n">x_length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">)</span>
    <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">east</span><span class="p">,</span> <span class="n">north</span><span class="p">)</span>

    <span class="n">x_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">y_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.cesium_to_streamlit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cesium_to_streamlit</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">responsive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.cesium_to_streamlit" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Renders an cesium HTML file in a Streamlit app. This method is a static Streamlit Component, meaning, no information is passed back from Leaflet on browser interaction.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>html</code></td>
        <td><code>str</code></td>
        <td><p>The HTML file to render. It can a local file path or a URL.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the map. Defaults to 800.</p></td>
        <td><code>800</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the map. Defaults to 600.</p></td>
        <td><code>600</code></td>
      </tr>
      <tr>
        <td><code>responsive</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to make the map responsive. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>scrolling</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to allow the map to scroll. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the token in the HTML file to be replaced. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_value</code></td>
        <td><code>str</code></td>
        <td><p>The value of the token to pass to the HTML file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>streamlit.components</code></td>
      <td><p>components.html object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cesium_to_streamlit</span><span class="p">(</span>
    <span class="n">html</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
    <span class="n">responsive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renders an cesium HTML file in a Streamlit app. This method is a static Streamlit Component, meaning, no information is passed back from Leaflet on browser interaction.</span>

<span class="sd">    Args:</span>
<span class="sd">        html (str): The HTML file to render. It can a local file path or a URL.</span>
<span class="sd">        width (int, optional): Width of the map. Defaults to 800.</span>
<span class="sd">        height (int, optional): Height of the map. Defaults to 600.</span>
<span class="sd">        responsive (bool, optional): Whether to make the map responsive. Defaults to True.</span>
<span class="sd">        scrolling (bool, optional): Whether to allow the map to scroll. Defaults to False.</span>
<span class="sd">        token_name (str, optional): The name of the token in the HTML file to be replaced. Defaults to None.</span>
<span class="sd">        token_value (str, optional): The value of the token to pass to the HTML file. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        streamlit.components: components.html object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">token_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">token_name</span> <span class="o">=</span> <span class="s2">&quot;your_access_token&quot;</span>

    <span class="k">if</span> <span class="n">token_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">token_value</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CESIUM_TOKEN&quot;</span><span class="p">)</span>

    <span class="n">html_to_streamlit</span><span class="p">(</span>
        <span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">responsive</span><span class="p">,</span> <span class="n">scrolling</span><span class="p">,</span> <span class="n">token_name</span><span class="p">,</span> <span class="n">token_value</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.check_cmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span></code>


<a href="#leafmap.common.check_cmap" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check the colormap and return a list of colors.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str | list | Box</code></td>
        <td><p>The colormap to check.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of colors.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the colormap and return a list of colors.</span>

<span class="sd">    Args:</span>
<span class="sd">        cmap (str | list | Box): The colormap to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of colors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">box</span> <span class="kn">import</span> <span class="n">Box</span>
    <span class="kn">from</span> <span class="nn">.colormaps</span> <span class="kn">import</span> <span class="n">get_palette</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cmap</span><span class="si">}</span><span class="s2"> is not a valid colormap.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">Box</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">cmap</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cmap</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cmap</span><span class="si">}</span><span class="s2"> is not a valid colormap.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.check_color" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_color</span><span class="p">(</span><span class="n">in_color</span><span class="p">)</span></code>


<a href="#leafmap.common.check_color" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Checks the input color and returns the corresponding hex color code.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_color</code></td>
        <td><code>str or tuple or list</code></td>
        <td><p>It can be a string (e.g., 'red', '#ffff00', 'ffff00', 'ff0') or RGB tuple (e.g., (255, 127, 0)).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>A hex color code.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_color</span><span class="p">(</span><span class="n">in_color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks the input color and returns the corresponding hex color code.</span>

<span class="sd">    Args:</span>
<span class="sd">            in_color (str or tuple or list): It can be a string (e.g., &#39;red&#39;, &#39;#ffff00&#39;, &#39;ffff00&#39;, &#39;ff0&#39;) or RGB tuple (e.g., (255, 127, 0)).</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A hex color code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">colour</span>

    <span class="n">out_color</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span>  <span class="c1"># default black color</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">in_color</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_color</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">in_color</span>
    <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># rescale color if necessary</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">in_color</span><span class="p">):</span>
            <span class="n">in_color</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">in_color</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">in_color</span><span class="p">))</span><span class="o">.</span><span class="n">hex_l</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># try to guess the color system</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">in_color</span><span class="p">)</span><span class="o">.</span><span class="n">hex_l</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># try again by adding an extra # (GEE handle hex codes without #)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">in_color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hex_l</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The provided color (</span><span class="si">{</span><span class="n">in_color</span><span class="si">}</span><span class="s2">) is invalid. Using the default black color.&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_color</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.check_dir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_dir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">make_dirs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.check_dir" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Checks if a directory exists and creates it if it does not.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dir_path</code></td>
        <td><code>[str</code></td>
        <td><p>The path to the directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>make_dirs</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create the directory if it does not exist. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the directory could not be found.</p></td>
      </tr>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>If the input directory path is not a string.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path to the directory.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_dir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">make_dirs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a directory exists and creates it if it does not.</span>

<span class="sd">    Args:</span>
<span class="sd">        dir_path ([str): The path to the directory.</span>
<span class="sd">        make_dirs (bool, optional): Whether to create the directory if it does not exist. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the directory could not be found.</span>
<span class="sd">        TypeError: If the input directory path is not a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dir_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">):</span>
            <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">make_dirs</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dir_path</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">dir_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided directory could not be found.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided directory path must be a string.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.check_file_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">make_dirs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.check_file_path" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Gets the absolute file path.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>file_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>make_dirs</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create the directory if it does not exist. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the directory could not be found.</p></td>
      </tr>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>If the input directory path is not a string.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The absolute path to the file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">make_dirs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the absolute file path.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The path to the file.</span>
<span class="sd">        make_dirs (bool, optional): Whether to create the directory if it does not exist. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the directory could not be found.</span>
<span class="sd">        TypeError: If the input directory path is not a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The absolute path to the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">):</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="n">file_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">make_dirs</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">file_dir</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">file_path</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided file path must be a string.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.check_html_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_html_string</span><span class="p">(</span><span class="n">html_string</span><span class="p">)</span></code>


<a href="#leafmap.common.check_html_string" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check if an HTML string contains local images and convert them to base64.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>html_string</code></td>
        <td><code>str</code></td>
        <td><p>The HTML string.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The HTML string with local images converted to base64.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_html_string</span><span class="p">(</span><span class="n">html_string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an HTML string contains local images and convert them to base64.</span>

<span class="sd">    Args:</span>
<span class="sd">        html_string (str): The HTML string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The HTML string with local images converted to base64.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">re</span>
    <span class="kn">import</span> <span class="nn">base64</span>

    <span class="c1"># Search for img tags with src attribute</span>
    <span class="n">img_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;img[^&gt;]+src\s*=\s*[&quot;</span><span class="se">\&#39;</span><span class="s1">]([^&quot;</span><span class="se">\&#39;</span><span class="s1">:]+)[&quot;</span><span class="se">\&#39;</span><span class="s1">][^&gt;]*&gt;&#39;</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">img_regex</span><span class="p">,</span> <span class="n">html_string</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">img_file</span><span class="p">:</span>
            <span class="n">img_data</span> <span class="o">=</span> <span class="n">img_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">base64_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">img_data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">html_string</span> <span class="o">=</span> <span class="n">html_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;src=&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">match</span><span class="p">),</span>
                <span class="s1">&#39;src=&quot;data:image/png;base64,&#39;</span> <span class="o">+</span> <span class="n">base64_data</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">html_string</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.check_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


<a href="#leafmap.common.check_url" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check if an HTTP URL is working.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL to check.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the URL is working (returns a 200 status code), False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_url</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an HTTP URL is working.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the URL is working (returns a 200 status code), False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.classify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">classify</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classification_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.classify" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Classify a dataframe column using a variety of classification schemes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | pd.DataFrame | gpd.GeoDataFrame</code></td>
        <td><p>The data to classify. It can be a filepath to a vector dataset, a pandas dataframe, or a geopandas geodataframe.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>column</code></td>
        <td><code>str</code></td>
        <td><p>The column to classify.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The name of a colormap recognized by matplotlib. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of colors to use for the classification. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>A list of labels to use for the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>scheme</code></td>
        <td><code>str</code></td>
        <td><p>Name of a choropleth classification scheme (requires mapclassify).
Name of a choropleth classification scheme (requires mapclassify).
A mapclassify.MapClassifier object will be used
under the hood. Supported are all schemes provided by mapclassify (e.g.
'BoxPlot', 'EqualInterval', 'FisherJenks', 'FisherJenksSampled',
'HeadTailBreaks', 'JenksCaspall', 'JenksCaspallForced',
'JenksCaspallSampled', 'MaxP', 'MaximumBreaks',
'NaturalBreaks', 'Quantiles', 'Percentiles', 'StdMean',
'UserDefined'). Arguments can be passed in classification_kwds.</p></td>
        <td><code>&#39;Quantiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>k</code></td>
        <td><code>int</code></td>
        <td><p>Number of classes (ignored if scheme is None or if column is categorical). Default to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>legend_kwds</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments to pass to :func:<code>matplotlib.pyplot.legend</code> or <code>matplotlib.pyplot.colorbar</code>. Defaults to None.
Keyword arguments to pass to :func:<code>matplotlib.pyplot.legend</code> or
Additional accepted keywords when <code>scheme</code> is specified:
fmt : string
    A formatting specification for the bin edges of the classes in the
    legend. For example, to have no decimals: <code>{"fmt": "{:.0f}"}</code>.
labels : list-like
    A list of legend labels to override the auto-generated labblels.
    Needs to have the same number of elements as the number of
    classes (<code>k</code>).
interval : boolean (default False)
    An option to control brackets from mapclassify legend.
    If True, open/closed interval brackets are shown in the legend.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>classification_kwds</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments to pass to mapclassify. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame, dict</code></td>
      <td><p>A pandas dataframe with the classification applied and a legend dictionary.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">classify</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">column</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;Quantiles&quot;</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">legend_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">classification_kwds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify a dataframe column using a variety of classification schemes.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | pd.DataFrame | gpd.GeoDataFrame): The data to classify. It can be a filepath to a vector dataset, a pandas dataframe, or a geopandas geodataframe.</span>
<span class="sd">        column (str): The column to classify.</span>
<span class="sd">        cmap (str, optional): The name of a colormap recognized by matplotlib. Defaults to None.</span>
<span class="sd">        colors (list, optional): A list of colors to use for the classification. Defaults to None.</span>
<span class="sd">        labels (list, optional): A list of labels to use for the legend. Defaults to None.</span>
<span class="sd">        scheme (str, optional): Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">            Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">            A mapclassify.MapClassifier object will be used</span>
<span class="sd">            under the hood. Supported are all schemes provided by mapclassify (e.g.</span>
<span class="sd">            &#39;BoxPlot&#39;, &#39;EqualInterval&#39;, &#39;FisherJenks&#39;, &#39;FisherJenksSampled&#39;,</span>
<span class="sd">            &#39;HeadTailBreaks&#39;, &#39;JenksCaspall&#39;, &#39;JenksCaspallForced&#39;,</span>
<span class="sd">            &#39;JenksCaspallSampled&#39;, &#39;MaxP&#39;, &#39;MaximumBreaks&#39;,</span>
<span class="sd">            &#39;NaturalBreaks&#39;, &#39;Quantiles&#39;, &#39;Percentiles&#39;, &#39;StdMean&#39;,</span>
<span class="sd">            &#39;UserDefined&#39;). Arguments can be passed in classification_kwds.</span>
<span class="sd">        k (int, optional): Number of classes (ignored if scheme is None or if column is categorical). Default to 5.</span>
<span class="sd">        legend_kwds (dict, optional): Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or `matplotlib.pyplot.colorbar`. Defaults to None.</span>
<span class="sd">            Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or</span>
<span class="sd">            Additional accepted keywords when `scheme` is specified:</span>
<span class="sd">            fmt : string</span>
<span class="sd">                A formatting specification for the bin edges of the classes in the</span>
<span class="sd">                legend. For example, to have no decimals: ``{&quot;fmt&quot;: &quot;{:.0f}&quot;}``.</span>
<span class="sd">            labels : list-like</span>
<span class="sd">                A list of legend labels to override the auto-generated labblels.</span>
<span class="sd">                Needs to have the same number of elements as the number of</span>
<span class="sd">                classes (`k`).</span>
<span class="sd">            interval : boolean (default False)</span>
<span class="sd">                An option to control brackets from mapclassify legend.</span>
<span class="sd">                If True, open/closed interval brackets are shown in the legend.</span>
<span class="sd">        classification_kwds (dict, optional): Keyword arguments to pass to mapclassify. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame, dict: A pandas dataframe with the classification applied and a legend dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">mapclassify</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;mapclassify is required for this function. Install with `pip install mapclassify`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Data must be a GeoDataFrame or a path to a file that can be read by geopandas.read_file().&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The GeoDataFrame you are attempting to plot is &quot;</span>
            <span class="s2">&quot;empty. Nothing has been displayed.&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> is not a column in the GeoDataFrame. It must be one of </span><span class="si">{</span><span class="n">columns</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Convert categorical data to numeric</span>
    <span class="n">init_column</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">value_list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">object0</span><span class="p">):</span>
        <span class="n">value_list</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">value_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">value_list</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">)))</span>
        <span class="n">init_column</span> <span class="o">=</span> <span class="n">column</span>
        <span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;category&quot;</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">legend_kwds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend_kwds</span> <span class="o">=</span> <span class="n">legend_kwds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># To accept pd.Series and np.arrays as column</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The dataframe and given column have different number of rows.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">column</span>

            <span class="c1"># Make sure index of a Series matches index of df</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
    <span class="n">nan_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;bool&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Blues&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">))[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_color</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_color</span><span class="p">(</span><span class="n">colors</span><span class="p">)]</span> <span class="o">*</span> <span class="n">k</span>

    <span class="n">allowed_schemes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;BoxPlot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EqualInterval&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FisherJenks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FisherJenksSampled&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HeadTailBreaks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JenksCaspall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JenksCaspallForced&quot;</span><span class="p">,</span>
        <span class="s2">&quot;JenksCaspallSampled&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MaxP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MaximumBreaks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NaturalBreaks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Quantiles&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Percentiles&quot;</span><span class="p">,</span>
        <span class="s2">&quot;StdMean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UserDefined&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">scheme</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">allowed_schemes</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">scheme</span><span class="si">}</span><span class="s2"> is not a valid scheme. It must be one of </span><span class="si">{</span><span class="n">allowed_schemes</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">classification_kwds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">classification_kwds</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s2">&quot;k&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">classification_kwds</span><span class="p">:</span>
        <span class="n">classification_kwds</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>

    <span class="n">binning</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">nan_idx</span><span class="p">]),</span> <span class="n">scheme</span><span class="p">,</span> <span class="o">**</span><span class="n">classification_kwds</span>
    <span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">binning</span><span class="o">.</span><span class="n">yb</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">legend_kwds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend_kwds</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="s2">&quot;interval&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legend_kwds</span><span class="p">:</span>
        <span class="n">legend_kwds</span><span class="p">[</span><span class="s2">&quot;interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="s2">&quot;fmt&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legend_kwds</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">):</span>
            <span class="n">legend_kwds</span><span class="p">[</span><span class="s2">&quot;fmt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">legend_kwds</span><span class="p">[</span><span class="s2">&quot;fmt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.0f}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># set categorical to True for creating the legend</span>
        <span class="k">if</span> <span class="n">legend_kwds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;labels&quot;</span> <span class="ow">in</span> <span class="n">legend_kwds</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend_kwds</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">binning</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Number of labels must match number of bins, &quot;</span>
                    <span class="s2">&quot;received </span><span class="si">{}</span><span class="s2"> labels for </span><span class="si">{}</span><span class="s2"> bins&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">legend_kwds</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]),</span> <span class="n">binning</span><span class="o">.</span><span class="n">k</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_kwds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># fmt = &quot;{:.2f}&quot;</span>
            <span class="k">if</span> <span class="n">legend_kwds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;fmt&quot;</span> <span class="ow">in</span> <span class="n">legend_kwds</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="n">legend_kwds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fmt&quot;</span><span class="p">)</span>

            <span class="n">labels</span> <span class="o">=</span> <span class="n">binning</span><span class="o">.</span><span class="n">get_legend_classes</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">legend_kwds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">show_interval</span> <span class="o">=</span> <span class="n">legend_kwds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">show_interval</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">show_interval</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">init_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">value_list</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of labels must match the number of colors.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;labels must be a list or None.&quot;</span><span class="p">)</span>

    <span class="n">legend_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">legend_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.clip_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clip_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.clip_image" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Clip an image by mask.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>Path to the image file in GeoTIFF format.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mask</code></td>
        <td><code>str | list | dict</code></td>
        <td><p>The mask used to extract the image. It can be a path to vector datasets (e.g., GeoJSON, Shapefile), a list of coordinates, or m.user_roi.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Flags to indicate if you want to convert the output to COG. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the fiona or rasterio package is not installed.</p></td>
      </tr>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the image is not found.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the mask is not a valid GeoJSON or raster file.</p></td>
      </tr>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the mask file is not found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">clip_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clip an image by mask.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): Path to the image file in GeoTIFF format.</span>
<span class="sd">        mask (str | list | dict): The mask used to extract the image. It can be a path to vector datasets (e.g., GeoJSON, Shapefile), a list of coordinates, or m.user_roi.</span>
<span class="sd">        output (str): Path to the output file.</span>
<span class="sd">        to_cog (bool, optional): Flags to indicate if you want to convert the output to COG. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the fiona or rasterio package is not installed.</span>
<span class="sd">        FileNotFoundError: If the image is not found.</span>
<span class="sd">        ValueError: If the mask is not a valid GeoJSON or raster file.</span>
<span class="sd">        FileNotFoundError: If the mask file is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">json</span>
        <span class="kn">import</span> <span class="nn">fiona</span>
        <span class="kn">import</span> <span class="nn">rasterio</span>
        <span class="kn">import</span> <span class="nn">rasterio.mask</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">image</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Output must be a tif file.&quot;</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mask</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
                <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
                        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">mask</span><span class="p">]},</span>
                    <span class="p">}</span>
                <span class="p">],</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
                <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">mask</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">fiona</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">shapefile</span><span class="p">:</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">shapefile</span><span class="p">]</span>

    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
        <span class="n">out_image</span><span class="p">,</span> <span class="n">out_transform</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">crop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">out_meta</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">meta</span>

    <span class="n">out_meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
            <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">out_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">out_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="n">out_transform</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">out_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">dest</span><span class="p">:</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out_image</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">to_cog</span><span class="p">:</span>
        <span class="n">image_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.cog_validate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cog_validate</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.cog_validate" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Validate Cloud Optimized Geotiff.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>A dataset path or URL. Will be opened in "r" mode.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the output of the validation. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the rio-cogeo package is not installed.</p></td>
      </tr>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the provided file could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple containing the validation results (True is src_path is a valid COG, List of validation errors, and a list of validation warnings).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cog_validate</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate Cloud Optimized Geotiff.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): A dataset path or URL. Will be opened in &quot;r&quot; mode.</span>
<span class="sd">        verbose (bool, optional): Whether to print the output of the validation. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the rio-cogeo package is not installed.</span>
<span class="sd">        FileNotFoundError: If the provided file could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing the validation results (True is src_path is a valid COG, List of validation errors, and a list of validation warnings).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">rio_cogeo.cogeo</span> <span class="kn">import</span> <span class="n">cog_validate</span><span class="p">,</span> <span class="n">cog_info</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;The rio-cogeo package is not installed. Please install it with `pip install rio-cogeo` or `conda install rio-cogeo -c conda-forge`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided input file could not be found.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cog_info</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cog_validate</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.connect_postgis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">connect_postgis</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="n">use_env_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.connect_postgis" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Connects to a PostGIS database.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>database</code></td>
        <td><code>str</code></td>
        <td><p>Name of the database</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>host</code></td>
        <td><code>str</code></td>
        <td><p>Hosting server for the database. Defaults to "localhost".</p></td>
        <td><code>&#39;localhost&#39;</code></td>
      </tr>
      <tr>
        <td><code>user</code></td>
        <td><code>str</code></td>
        <td><p>User name to access the database. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>password</code></td>
        <td><code>str</code></td>
        <td><p>Password to access the database. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>int</code></td>
        <td><p>Port number to connect to at the server host. Defaults to 5432.</p></td>
        <td><code>5432</code></td>
      </tr>
      <tr>
        <td><code>use_env_var</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use environment variables. It set to True, user and password are treated as an environment variables with default values user="SQL_USER" and password="SQL_PASSWORD". Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If user is not specified.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If password is not specified.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>[type]</code></td>
      <td><p>[description]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">connect_postgis</span><span class="p">(</span>
    <span class="n">database</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="n">use_env_var</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Connects to a PostGIS database.</span>

<span class="sd">    Args:</span>
<span class="sd">        database (str): Name of the database</span>
<span class="sd">        host (str, optional): Hosting server for the database. Defaults to &quot;localhost&quot;.</span>
<span class="sd">        user (str, optional): User name to access the database. Defaults to None.</span>
<span class="sd">        password (str, optional): Password to access the database. Defaults to None.</span>
<span class="sd">        port (int, optional): Port number to connect to at the server host. Defaults to 5432.</span>
<span class="sd">        use_env_var (bool, optional): Whether to use environment variables. It set to True, user and password are treated as an environment variables with default values user=&quot;SQL_USER&quot; and password=&quot;SQL_PASSWORD&quot;. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If user is not specified.</span>
<span class="sd">        ValueError: If password is not specified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [type]: [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
    <span class="n">check_package</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sqlalchemy&quot;</span><span class="p">,</span>
        <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://docs.sqlalchemy.org/en/14/intro.html#installation&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

    <span class="k">if</span> <span class="n">use_env_var</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;SQL_USER&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;SQL_PASSWORD&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;user is not specified.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;password is not specified.&quot;</span><span class="p">)</span>

    <span class="n">connection_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;postgresql://</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">database</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">connection_string</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">engine</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.convert_coordinates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert_coordinates</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">source_crs</span><span class="p">,</span> <span class="n">target_crs</span><span class="o">=</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.convert_coordinates" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert coordinates from the source EPSG code to the target EPSG code.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>float</code></td>
        <td><p>The x-coordinate of the point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>float</code></td>
        <td><p>The y-coordinate of the point.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>source_crs</code></td>
        <td><code>str</code></td>
        <td><p>The EPSG code of the source coordinate system.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_crs</code></td>
        <td><code>str</code></td>
        <td><p>The EPSG code of the target coordinate system.
Defaults to '4326' (EPSG code for WGS84).</p></td>
        <td><code>&#39;epsg:4326&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple containing the converted longitude and latitude.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_coordinates</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">source_crs</span><span class="p">,</span> <span class="n">target_crs</span><span class="o">=</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert coordinates from the source EPSG code to the target EPSG code.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (float): The x-coordinate of the point.</span>
<span class="sd">        y (float): The y-coordinate of the point.</span>
<span class="sd">        source_crs (str): The EPSG code of the source coordinate system.</span>
<span class="sd">        target_crs (str, optional): The EPSG code of the target coordinate system.</span>
<span class="sd">            Defaults to &#39;4326&#39; (EPSG code for WGS84).</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing the converted longitude and latitude.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pyproj</span>

    <span class="c1"># Create the transformer</span>
    <span class="n">transformer</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="n">source_crs</span><span class="p">,</span> <span class="n">target_crs</span><span class="p">,</span> <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Perform the transformation</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Return the converted coordinates</span>
    <span class="k">return</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.convert_lidar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert_lidar</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point_format_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.convert_lidar" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a Las from one point format to another Automatically upgrades the file version if source file version
    is not compatible with the new point_format_id</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | laspy.lasdatas.base.LasBase</code></td>
        <td><p>The source data to be converted.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>destination</code></td>
        <td><code>str</code></td>
        <td><p>The destination file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>point_format_id</code></td>
        <td><code>int</code></td>
        <td><p>The new point format id (the default is None, which won't change the source format id).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>file_version</code></td>
        <td><code>str</code></td>
        <td><p>The new file version. None by default which means that the file_version may be upgraded
for compatibility with the new point_format. The file version will not be downgraded.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>aspy.lasdatas.base.LasBase</code></td>
      <td><p>The converted LasData object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_lidar</span><span class="p">(</span>
    <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point_format_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a Las from one point format to another Automatically upgrades the file version if source file version</span>
<span class="sd">        is not compatible with the new point_format_id</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | laspy.lasdatas.base.LasBase): The source data to be converted.</span>
<span class="sd">        destination (str, optional): The destination file path. Defaults to None.</span>
<span class="sd">        point_format_id (int, optional): The new point format id (the default is None, which won&#39;t change the source format id).</span>
<span class="sd">        file_version (str, optional): The new file version. None by default which means that the file_version may be upgraded</span>
<span class="sd">            for compatibility with the new point_format. The file version will not be downgraded.</span>

<span class="sd">    Returns:</span>
<span class="sd">        aspy.lasdatas.base.LasBase: The converted LasData object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">laspy</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The laspy package is required for this function. Use `pip install laspy[lazrs,laszip]` to install it.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">read_lidar</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

    <span class="n">las</span> <span class="o">=</span> <span class="n">laspy</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
        <span class="n">source</span><span class="p">,</span> <span class="n">point_format_id</span><span class="o">=</span><span class="n">point_format_id</span><span class="p">,</span> <span class="n">file_version</span><span class="o">=</span><span class="n">file_version</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">destination</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">las</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">destination</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="n">write_lidar</span><span class="p">(</span><span class="n">las</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">destination</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.coords_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">coords_to_geojson</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span></code>


<a href="#leafmap.common.coords_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a list of bbox coordinates representing [left, bottom, right, top] to geojson FeatureCollection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>coords</code></td>
        <td><code>list</code></td>
        <td><p>A list of bbox coordinates representing [left, bottom, right, top].</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A geojson FeatureCollection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">coords_to_geojson</span><span class="p">(</span><span class="n">coords</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a list of bbox coordinates representing [left, bottom, right, top] to geojson FeatureCollection.</span>

<span class="sd">    Args:</span>
<span class="sd">        coords (list): A list of bbox coordinates representing [left, bottom, right, top].</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A geojson FeatureCollection.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bbox_to_geojson</span><span class="p">(</span><span class="n">bbox</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">features</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.coords_to_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">coords_to_vector</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.coords_to_vector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a list of coordinates to a GeoDataFrame or a vector file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>coords</code></td>
        <td><code>list</code></td>
        <td><p>A list of coordinates in the format of [(x1, y1), (x2, y2), ...].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output vector file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The CRS of the coordinates. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>gpd.GeoDataFraem</code></td>
      <td><p>A GeoDataFrame of the coordinates.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">coords_to_vector</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a list of coordinates to a GeoDataFrame or a vector file.</span>

<span class="sd">    Args:</span>
<span class="sd">        coords (list): A list of coordinates in the format of [(x1, y1), (x2, y2), ...].</span>
<span class="sd">        output (str, optional): The path to the output vector file. Defaults to None.</span>
<span class="sd">        crs (str, optional): The CRS of the coordinates. Defaults to &quot;EPSG:4326&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpd.GeoDataFraem: A GeoDataFrame of the coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;coords must be a list of coordinates&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="c1"># convert the points to a GeoDataFrame</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.coords_to_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">coords_to_xy</span><span class="p">(</span><span class="n">src_fp</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">coord_crs</span><span class="o">=</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">,</span> <span class="n">request_payer</span><span class="o">=</span><span class="s1">&#39;bucket-owner&#39;</span><span class="p">,</span> <span class="n">env_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.coords_to_xy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a list of coordinates to pixel coordinates, i.e., (col, row) coordinates.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>src_fp</code></td>
        <td><code>str</code></td>
        <td><p>The source raster file path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>coords</code></td>
        <td><code>list</code></td>
        <td><p>A list of coordinates in the format of [[x1, y1], [x2, y2], ...]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>coord_crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate CRS of the input coordinates. Defaults to "epsg:4326".</p></td>
        <td><code>&#39;epsg:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>request_payer</code></td>
        <td></td>
        <td><p>Specifies who pays for the download from S3.
Can be "bucket-owner" or "requester". Defaults to "bucket-owner".</p></td>
        <td><code>&#39;bucket-owner&#39;</code></td>
      </tr>
      <tr>
        <td><code>env_args</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to rasterio.Env.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>open_args</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to rasterio.open.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to rasterio.transform.rowcol.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of pixel coordinates in the format of [[x1, y1], [x2, y2], ...]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">coords_to_xy</span><span class="p">(</span>
    <span class="n">src_fp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">coord_crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;epsg:4326&quot;</span><span class="p">,</span>
    <span class="n">request_payer</span><span class="o">=</span><span class="s2">&quot;bucket-owner&quot;</span><span class="p">,</span>
    <span class="n">env_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a list of coordinates to pixel coordinates, i.e., (col, row) coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        src_fp: The source raster file path.</span>
<span class="sd">        coords: A list of coordinates in the format of [[x1, y1], [x2, y2], ...]</span>
<span class="sd">        coord_crs: The coordinate CRS of the input coordinates. Defaults to &quot;epsg:4326&quot;.</span>
<span class="sd">        request_payer: Specifies who pays for the download from S3.</span>
<span class="sd">            Can be &quot;bucket-owner&quot; or &quot;requester&quot;. Defaults to &quot;bucket-owner&quot;.</span>
<span class="sd">        env_args: Additional keyword arguments to pass to rasterio.Env.</span>
<span class="sd">        open_args: Additional keyword arguments to pass to rasterio.open.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to rasterio.transform.rowcol.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of pixel coordinates in the format of [[x1, y1], [x2, y2], ...]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[[</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">3</span><span class="p">]]]</span>

    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">coords</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="n">AWS_REQUEST_PAYER</span><span class="o">=</span><span class="n">request_payer</span><span class="p">,</span> <span class="o">**</span><span class="n">env_args</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">src_fp</span><span class="p">,</span> <span class="o">**</span><span class="n">open_args</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">width</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">height</span>
            <span class="k">if</span> <span class="n">coord_crs</span> <span class="o">!=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
                <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">transform_coords</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">coord_crs</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rowcol</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">rows</span><span class="p">)]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">result</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">width</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">height</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No valid pixel coordinates found.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some coordinates are out of the image boundary.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.create_code_cell" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_code_cell</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;below&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.create_code_cell" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a code cell in the IPython Notebook.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>code</code></td>
        <td><code>str</code></td>
        <td><p>Code to fill the new code cell with. Defaults to ''.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>where</code></td>
        <td><code>str</code></td>
        <td><p>Where to add the new code cell. It can be one of the following: above, below, at_bottom. Defaults to 'below'.</p></td>
        <td><code>&#39;below&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_code_cell</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s2">&quot;below&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a code cell in the IPython Notebook.</span>

<span class="sd">    Args:</span>
<span class="sd">        code (str, optional): Code to fill the new code cell with. Defaults to &#39;&#39;.</span>
<span class="sd">        where (str, optional): Where to add the new code cell. It can be one of the following: above, below, at_bottom. Defaults to &#39;below&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">base64</span>

    <span class="c1"># try:</span>
    <span class="c1">#     import pyperclip</span>
    <span class="c1"># except ImportError:</span>
    <span class="c1">#     install_package(&quot;pyperclip&quot;)</span>
    <span class="c1">#     import pyperclip</span>

    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Javascript</span><span class="p">,</span> <span class="n">display</span>

    <span class="c1"># try:</span>
    <span class="c1">#     pyperclip.copy(str(code))</span>
    <span class="c1"># except Exception as e:</span>
    <span class="c1">#     pass</span>

    <span class="n">encoded_code</span> <span class="o">=</span> <span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">code</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">display</span><span class="p">(</span>
        <span class="n">Javascript</span><span class="p">(</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        var code = IPython.notebook.insert_cell_{0}(&#39;code&#39;);</span>
<span class="sd">        code.set_text(atob(&quot;{1}&quot;));</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">where</span><span class="p">,</span> <span class="n">encoded_code</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.create_download_link" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_download_link</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Click here to download: &#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.create_download_link" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Downloads a file from voila. Adopted from https://github.com/voila-dashboards/voila/issues/578</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the file to download</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>str. Defaults to "Click here to download: ".</p></td>
        <td><code>&#39;Click here to download: &#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>HTML download URL.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_download_link</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Click here to download: &quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a file from voila. Adopted from https://github.com/voila-dashboards/voila/issues/578</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The file path to the file to download</span>
<span class="sd">        title (str, optional): str. Defaults to &quot;Click here to download: &quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: HTML download URL.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">base64</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

    <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">b64</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;a download=&quot;</span><span class="si">{filename}</span><span class="s1">&quot; href=&quot;data:text/csv;base64,</span><span class="si">{payload}</span><span class="s1">&quot; style=&quot;color:#0000FF;&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{title}</span><span class="s1">&lt;/a&gt;&#39;</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">basename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.create_legend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Legend&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">builtin_legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="n">draggable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.create_legend" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a legend in HTML format. Reference: https://bit.ly/3oV6vnH</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Title of the legend. Defaults to 'Legend'. Defaults to "Legend".</p></td>
        <td><code>&#39;Legend&#39;</code></td>
      </tr>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of legend colors. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>labels</code></td>
        <td><code>list</code></td>
        <td><p>A list of legend labels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>legend_dict</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary containing legend items as keys and color as values.
If provided, legend_keys and legend_colors will be ignored. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>builtin_legend</code></td>
        <td><code>str</code></td>
        <td><p>Name of the builtin legend to add to the map. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The opacity of the legend. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the legend, can be one of the following:
"topleft", "topright", "bottomleft", "bottomright". Defaults to "bottomright".</p></td>
        <td><code>&#39;bottomright&#39;</code></td>
      </tr>
      <tr>
        <td><code>draggable</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the legend can be dragged to a new position. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output file path (*.html) to save the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>style</code></td>
        <td></td>
        <td><p>Additional keyword arguments to style the legend, such as position, bottom, right, z-index,
border, background-color, border-radius, padding, font-size, etc. The default style is:
style = {
    'position': 'fixed',
    'z-index': '9999',
    'border': '2px solid grey',
    'background-color': 'rgba(255, 255, 255, 0.8)',
    'border-radius': '5px',
    'padding': '10px',
    'font-size': '14px',
    'bottom': '20px',
    'right': '5px'
}</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The HTML code of the legend.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_legend</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">builtin_legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="n">draggable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="p">{},</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a legend in HTML format. Reference: https://bit.ly/3oV6vnH</span>

<span class="sd">    Args:</span>
<span class="sd">        title (str, optional): Title of the legend. Defaults to &#39;Legend&#39;. Defaults to &quot;Legend&quot;.</span>
<span class="sd">        colors (list, optional): A list of legend colors. Defaults to None.</span>
<span class="sd">        labels (list, optional): A list of legend labels. Defaults to None.</span>
<span class="sd">        legend_dict (dict, optional): A dictionary containing legend items as keys and color as values.</span>
<span class="sd">            If provided, legend_keys and legend_colors will be ignored. Defaults to None.</span>
<span class="sd">        builtin_legend (str, optional): Name of the builtin legend to add to the map. Defaults to None.</span>
<span class="sd">        opacity (float, optional): The opacity of the legend. Defaults to 1.0.</span>
<span class="sd">        position (str, optional): The position of the legend, can be one of the following:</span>
<span class="sd">            &quot;topleft&quot;, &quot;topright&quot;, &quot;bottomleft&quot;, &quot;bottomright&quot;. Defaults to &quot;bottomright&quot;.</span>
<span class="sd">        draggable (bool, optional): If True, the legend can be dragged to a new position. Defaults to True.</span>
<span class="sd">        output (str, optional): The output file path (*.html) to save the legend. Defaults to None.</span>
<span class="sd">        style: Additional keyword arguments to style the legend, such as position, bottom, right, z-index,</span>
<span class="sd">            border, background-color, border-radius, padding, font-size, etc. The default style is:</span>
<span class="sd">            style = {</span>
<span class="sd">                &#39;position&#39;: &#39;fixed&#39;,</span>
<span class="sd">                &#39;z-index&#39;: &#39;9999&#39;,</span>
<span class="sd">                &#39;border&#39;: &#39;2px solid grey&#39;,</span>
<span class="sd">                &#39;background-color&#39;: &#39;rgba(255, 255, 255, 0.8)&#39;,</span>
<span class="sd">                &#39;border-radius&#39;: &#39;5px&#39;,</span>
<span class="sd">                &#39;padding&#39;: &#39;10px&#39;,</span>
<span class="sd">                &#39;font-size&#39;: &#39;14px&#39;,</span>
<span class="sd">                &#39;bottom&#39;: &#39;20px&#39;,</span>
<span class="sd">                &#39;right&#39;: &#39;5px&#39;</span>
<span class="sd">            }</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The HTML code of the legend.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pkg_resources</span>
    <span class="kn">from</span> <span class="nn">.legends</span> <span class="kn">import</span> <span class="n">builtin_legends</span>

    <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s2">&quot;leafmap&quot;</span><span class="p">,</span> <span class="s2">&quot;leafmap.py&quot;</span><span class="p">))</span>
    <span class="n">legend_template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/template/legend_style.html&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">draggable</span><span class="p">:</span>
        <span class="n">legend_template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/template/legend.txt&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">legend_template</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The legend template does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend keys must be a list.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;One&quot;</span><span class="p">,</span> <span class="s2">&quot;Two&quot;</span><span class="p">,</span> <span class="s2">&quot;Three&quot;</span><span class="p">,</span> <span class="s2">&quot;Four&quot;</span><span class="p">,</span> <span class="s2">&quot;etc&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend colors must be a list.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend colors must be a list of tuples.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;#8DD3C7&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#FFFFB3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#BEBADA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#FB8072&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#80B1D3&quot;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend keys and values must be the same length.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">allowed_builtin_legends</span> <span class="o">=</span> <span class="n">builtin_legends</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">builtin_legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">builtin_legend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_builtin_legends</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;The builtin legend must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_builtin_legends</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">legend_dict</span> <span class="o">=</span> <span class="n">builtin_legends</span><span class="p">[</span><span class="n">builtin_legend</span><span class="p">]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">legend_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The legend dict must be a dictionary.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">legend_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">allowed_positions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;topleft&quot;</span><span class="p">,</span>
        <span class="s2">&quot;topright&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottomleft&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottomright&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_positions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The position must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_positions</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;bottomright&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;bottom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;20px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;right&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;left&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;top&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;bottomleft&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;bottom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;left&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;right&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;top&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;topright&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;top&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;right&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;left&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;bottom&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;topleft&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;top&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;left&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="n">style</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;right&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;bottom&quot;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;position&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fixed&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;z-index&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;z-index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;9999&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;background-color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;background-color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rgba(255, 255, 255, 0.8)&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;padding&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;padding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10px&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;border-radius&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;border-radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5px&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;font-size&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;font-size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;14px&quot;</span>

    <span class="n">content</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">legend_template</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">draggable</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">36</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">36</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">39</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">39</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;    &lt;li&gt;&lt;span style=&#39;background:</span><span class="si">{</span><span class="n">check_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span><span class="si">}</span><span class="s2">;opacity:</span><span class="si">{</span><span class="n">opacity</span><span class="si">}</span><span class="s2">;&#39;&gt;&lt;/span&gt;</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">41</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">style</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="s2">&quot;              </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">19</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">22</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">22</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">color</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">color</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;                    &lt;li&gt;&lt;span style=&#39;background:</span><span class="si">{}</span><span class="s2">;opacity:</span><span class="si">{}</span><span class="s2">;&#39;&gt;&lt;/span&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">color</span><span class="p">,</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">key</span>
                    <span class="p">)</span>
                    <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">33</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="n">legend_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">legend_text</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">legend_text</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.create_timelapse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_timelapse</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.tif&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">text_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font_type</span><span class="o">=</span><span class="s1">&#39;arial.ttf&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reduce_size</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clean_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.create_timelapse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a timelapse gif from a list of images.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>images</code></td>
        <td><code>list | str</code></td>
        <td><p>The list of images or input directory to create the gif from.
For example, '/path/to/images/*.tif' or ['/path/to/image1.tif', '/path/to/image2.tif', ...]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output gif.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>The extension of the images. Defaults to '.tif'.</p></td>
        <td><code>&#39;.tif&#39;</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>list</code></td>
        <td><p>The bands to use for the gif. For example, [0, 1, 2] for RGB, and [0] for grayscale. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>size</code></td>
        <td><code>tuple</code></td>
        <td><p>The size of the gif. For example, (500, 500). Defaults to None, using the original size.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list</code></td>
        <td><p>The bounding box of the gif. For example, [xmin, ymin, xmax, ymax]. Defaults to None, using the original bounding box.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fps</code></td>
        <td><code>int</code></td>
        <td><p>The frames per second of the gif. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>The number of times to loop the gif. Defaults to 0, looping forever.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar to the gif. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>The color of the progress bar, can be color name or hex code. Defaults to 'blue'.</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>The height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add text to the gif. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>text_xy</code></td>
        <td><code>tuple</code></td>
        <td><p>The x, y coordinates of the text. For example, ('10%', '10%').
Defaults to None, using the bottom left corner.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>text_sequence</code></td>
        <td><code>list</code></td>
        <td><p>The sequence of text to add to the gif. For example, ['year 1', 'year 2', ...].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>font_type</code></td>
        <td><code>str</code></td>
        <td><p>The font type of the text, can be 'arial.ttf' or 'alibaba.otf', or any system font. Defaults to 'arial.ttf'.</p></td>
        <td><code>&#39;arial.ttf&#39;</code></td>
      </tr>
      <tr>
        <td><code>font_size</code></td>
        <td><code>int</code></td>
        <td><p>The font size of the text. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>font_color</code></td>
        <td><code>str</code></td>
        <td><p>The color of the text, can be color name or hex code. Defaults to 'black'.</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the gif to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to False.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>reduce_size</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to reduce the size of the gif using ffmpeg. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>clean_up</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to clean up the temporary files. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_timelapse</span><span class="p">(</span>
    <span class="n">images</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">out_gif</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.tif&quot;</span><span class="p">,</span>
    <span class="n">bands</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bbox</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">loop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">add_text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">text_xy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">text_sequence</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">font_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span>
    <span class="n">font_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">font_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">mp4</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reduce_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">clean_up</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a timelapse gif from a list of images.</span>

<span class="sd">    Args:</span>
<span class="sd">        images (list | str): The list of images or input directory to create the gif from.</span>
<span class="sd">            For example, &#39;/path/to/images/*.tif&#39; or [&#39;/path/to/image1.tif&#39;, &#39;/path/to/image2.tif&#39;, ...]</span>
<span class="sd">        out_gif (str): File path to the output gif.</span>
<span class="sd">        ext (str, optional): The extension of the images. Defaults to &#39;.tif&#39;.</span>
<span class="sd">        bands (list, optional): The bands to use for the gif. For example, [0, 1, 2] for RGB, and [0] for grayscale. Defaults to None.</span>
<span class="sd">        size (tuple, optional): The size of the gif. For example, (500, 500). Defaults to None, using the original size.</span>
<span class="sd">        bbox (list, optional): The bounding box of the gif. For example, [xmin, ymin, xmax, ymax]. Defaults to None, using the original bounding box.</span>
<span class="sd">        fps (int, optional): The frames per second of the gif. Defaults to 5.</span>
<span class="sd">        loop (int, optional): The number of times to loop the gif. Defaults to 0, looping forever.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar to the gif. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): The color of the progress bar, can be color name or hex code. Defaults to &#39;blue&#39;.</span>
<span class="sd">        progress_bar_height (int, optional): The height of the progress bar. Defaults to 5.</span>
<span class="sd">        add_text (bool, optional): Whether to add text to the gif. Defaults to False.</span>
<span class="sd">        text_xy (tuple, optional): The x, y coordinates of the text. For example, (&#39;10%&#39;, &#39;10%&#39;).</span>
<span class="sd">            Defaults to None, using the bottom left corner.</span>
<span class="sd">        text_sequence (list, optional): The sequence of text to add to the gif. For example, [&#39;year 1&#39;, &#39;year 2&#39;, ...].</span>
<span class="sd">        font_type (str, optional): The font type of the text, can be &#39;arial.ttf&#39; or &#39;alibaba.otf&#39;, or any system font. Defaults to &#39;arial.ttf&#39;.</span>
<span class="sd">        font_size (int, optional): The font size of the text. Defaults to 20.</span>
<span class="sd">        font_color (str, optional): The color of the text, can be color name or hex code. Defaults to &#39;black&#39;.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the gif to mp4. Defaults to False.</span>
<span class="sd">        quiet (bool, optional): Whether to print the progress. Defaults to False.</span>
<span class="sd">        reduce_size (bool, optional): Whether to reduce the size of the gif using ffmpeg. Defaults to False.</span>
<span class="sd">        clean_up (bool, optional): Whether to clean up the temporary files. Defaults to True.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">images</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">):</span>
            <span class="n">images</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">images</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;images must be a list or a path to the image directory.&quot;</span><span class="p">)</span>

    <span class="n">images</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="s2">&quot;timelapse&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clip_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="s2">&quot;clip&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">clip_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">clip_dir</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox_to_geojson</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">clip_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

    <span class="k">if</span> <span class="s2">&quot;out_ext&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">out_ext</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;out_ext&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_ext</span> <span class="o">=</span> <span class="s2">&quot;.jpg&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">clip_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">clip_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
                <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
                    <span class="n">clip_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">clip_file</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">clip_file</span>

            <span class="k">if</span> <span class="s2">&quot;add_prefix&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">basename</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">))))</span>
                    <span class="o">+</span> <span class="s2">&quot;-&quot;</span>
                    <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="n">out_ext</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="n">out_ext</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>

            <span class="c1"># ignore GDAL warnings</span>
            <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
                <span class="n">numpy_to_image</span><span class="p">(</span>
                    <span class="n">image</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">basename</span><span class="p">),</span> <span class="n">bands</span><span class="o">=</span><span class="n">bands</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span>
                <span class="p">)</span>
        <span class="n">make_gif</span><span class="p">(</span>
            <span class="n">temp_dir</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">ext</span><span class="o">=</span><span class="n">out_ext</span><span class="p">,</span>
            <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
            <span class="n">mp4</span><span class="o">=</span><span class="n">mp4</span><span class="p">,</span>
            <span class="n">clean_up</span><span class="o">=</span><span class="n">clean_up</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">clip_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">clip_dir</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
            <span class="n">add_text_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">text_xy</span><span class="p">,</span>
                <span class="n">text_sequence</span><span class="p">,</span>
                <span class="n">font_type</span><span class="p">,</span>
                <span class="n">font_size</span><span class="p">,</span>
                <span class="n">font_color</span><span class="p">,</span>
                <span class="n">add_progress_bar</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">,</span>
                <span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">add_progress_bar</span><span class="p">:</span>
            <span class="n">add_progress_bar_to_gif</span><span class="p">(</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">out_gif</span><span class="p">,</span>
                <span class="n">progress_bar_color</span><span class="p">,</span>
                <span class="n">progress_bar_height</span><span class="p">,</span>
                <span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">,</span>
                <span class="n">loop</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">reduce_size</span><span class="p">:</span>
            <span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.csv_points_to_shp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_points_to_shp</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.csv_points_to_shp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a csv file containing points (latitude, longitude) into a shapefile.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>File path or HTTP URL to the input csv file. For example, https://raw.githubusercontent.com/opengeos/data/main/world/world_cities.csv</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_shp</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output shapefile.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>Column name for the latitude column. Defaults to 'latitude'.</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>Column name for the longitude column. Defaults to 'longitude'.</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">csv_points_to_shp</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a csv file containing points (latitude, longitude) into a shapefile.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): File path or HTTP URL to the input csv file. For example, https://raw.githubusercontent.com/opengeos/data/main/world/world_cities.csv</span>
<span class="sd">        out_shp (str): File path to the output shapefile.</span>
<span class="sd">        latitude (str, optional): Column name for the latitude column. Defaults to &#39;latitude&#39;.</span>
<span class="sd">        longitude (str, optional): Column name for the longitude column. Defaults to &#39;longitude&#39;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">in_csv</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_csv</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;Downloads&quot;</span><span class="p">)</span>
        <span class="n">out_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
        <span class="n">download_from_url</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">out_dir</span><span class="p">)</span>
        <span class="n">in_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">out_name</span><span class="p">)</span>

    <span class="n">wbt</span> <span class="o">=</span> <span class="n">whitebox</span><span class="o">.</span><span class="n">WhiteboxTools</span><span class="p">()</span>
    <span class="n">in_csv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>
    <span class="n">out_shp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_csv</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The provided csv file does not exist.&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csv_file</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">fieldnames</span>
        <span class="n">xfield</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span>
        <span class="n">yfield</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span>

    <span class="n">wbt</span><span class="o">.</span><span class="n">csv_points_to_vector</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="n">xfield</span><span class="o">=</span><span class="n">xfield</span><span class="p">,</span> <span class="n">yfield</span><span class="o">=</span><span class="n">yfield</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.csv_to_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_to_df</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.csv_to_df" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a CSV file to pandas dataframe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>File path to the input CSV.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>pandas DataFrame</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">csv_to_df</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a CSV file to pandas dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): File path to the input CSV.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: pandas DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.csv_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_to_gdf</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.csv_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates points for a CSV file and converts them to a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input CSV file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing latitude coordinates. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing longitude coordinates. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of characters. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">csv_to_gdf</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates points for a CSV file and converts them to a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): The file path to the input CSV file.</span>
<span class="sd">        latitude (str, optional): The name of the column containing latitude coordinates. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        longitude (str, optional): The name of the column containing longitude coordinates. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of characters. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">random_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">)</span>
    <span class="n">csv_to_geojson</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_geojson</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.csv_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_to_geojson</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.csv_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates points for a CSV file and exports data as a GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input CSV file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_geojson</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the exported GeoJSON. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing latitude coordinates. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing longitude coordinates. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of characters. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">csv_to_geojson</span><span class="p">(</span>
    <span class="n">in_csv</span><span class="p">,</span>
    <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates points for a CSV file and exports data as a GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): The file path to the input CSV file.</span>
<span class="sd">        out_geojson (str): The file path to the exported GeoJSON. Default to None.</span>
<span class="sd">        latitude (str, optional): The name of the column containing latitude coordinates. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        longitude (str, optional): The name of the column containing longitude coordinates. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of characters. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="n">in_csv</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>
    <span class="n">geojson</span> <span class="o">=</span> <span class="n">df_to_geojson</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="n">longitude</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">geojson</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">geojson</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.csv_to_shp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_to_shp</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.csv_to_shp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a csv file with latlon info to a point shapefile.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>The input csv file containing longitude and latitude columns.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_shp</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output shapefile.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the latitude column. Defaults to 'latitude'.</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the longitude column. Defaults to 'longitude'.</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">csv_to_shp</span><span class="p">(</span>
    <span class="n">in_csv</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a csv file with latlon info to a point shapefile.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): The input csv file containing longitude and latitude columns.</span>
<span class="sd">        out_shp (str): The file path to the output shapefile.</span>
<span class="sd">        latitude (str, optional): The column name of the latitude column. Defaults to &#39;latitude&#39;.</span>
<span class="sd">        longitude (str, optional): The column name of the longitude column. Defaults to &#39;longitude&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">shapefile</span> <span class="k">as</span> <span class="nn">shp</span>

    <span class="k">if</span> <span class="n">in_csv</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_csv</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
        <span class="n">in_csv</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">in_csv</span><span class="p">)</span>
        <span class="n">in_csv</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">shp</span><span class="o">.</span><span class="n">Writer</span><span class="p">(</span><span class="n">out_shp</span><span class="p">,</span> <span class="n">shapeType</span><span class="o">=</span><span class="n">shp</span><span class="o">.</span><span class="n">POINT</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">csvreader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">csvreader</span><span class="o">.</span><span class="n">fieldnames</span>
            <span class="p">[</span><span class="n">points</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">header</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csvreader</span><span class="p">:</span>
                <span class="n">points</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">longitude</span><span class="p">])),</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">latitude</span><span class="p">])))</span>
                <span class="n">points</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="o">*</span><span class="nb">tuple</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">header</span><span class="p">]))</span>

        <span class="n">out_prj</span> <span class="o">=</span> <span class="n">out_shp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.prj&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_prj</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">prj_str</span> <span class="o">=</span> <span class="s1">&#39;GEOGCS[&quot;GCS_WGS_1984&quot;,DATUM[&quot;D_WGS_1984&quot;,SPHEROID[&quot;WGS_1984&quot;,6378137,298.257223563]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]] &#39;</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prj_str</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.csv_to_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csv_to_vector</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.csv_to_vector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates points for a CSV file and converts them to a vector dataset.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_csv</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input CSV file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output vector dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing latitude coordinates. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing longitude coordinates. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of characters. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">csv_to_vector</span><span class="p">(</span>
    <span class="n">in_csv</span><span class="p">,</span>
    <span class="n">output</span><span class="p">,</span>
    <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates points for a CSV file and converts them to a vector dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_csv (str): The file path to the input CSV file.</span>
<span class="sd">        output (str): The file path to the output vector dataset.</span>
<span class="sd">        latitude (str, optional): The name of the column containing latitude coordinates. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        longitude (str, optional): The name of the column containing longitude coordinates. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of characters. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">csv_to_gdf</span><span class="p">(</span><span class="n">in_csv</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.delete_shp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_shp</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.delete_shp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Deletes a shapefile.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_shp</code></td>
        <td><code>str</code></td>
        <td><p>The input shapefile to delete.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print out descriptive text. Defaults to True.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_shp</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes a shapefile.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_shp (str): The input shapefile to delete.</span>
<span class="sd">        verbose (bool, optional): Whether to print out descriptive text. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

    <span class="n">in_shp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
    <span class="n">in_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">files</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">in_dir</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="n">basename</span> <span class="o">+</span> <span class="s2">&quot;.*&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">in_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleted </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.df_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">df_to_gdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.df_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a pandas DataFrame to a GeoPandas GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pandas.DataFrame</code></td>
        <td><p>The pandas DataFrame to convert.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>geometry</code></td>
        <td><code>str</code></td>
        <td><p>The name of the geometry column in the DataFrame.</p></td>
        <td><code>&#39;geometry&#39;</code></td>
      </tr>
      <tr>
        <td><code>src_crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system (CRS) of the GeoDataFrame. Default is "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The target CRS of the GeoDataFrame. Default is None</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>geopandas.GeoDataFrame</code></td>
      <td><p>The converted GeoPandas GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">df_to_gdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a pandas DataFrame to a GeoPandas GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): The pandas DataFrame to convert.</span>
<span class="sd">        geometry (str): The name of the geometry column in the DataFrame.</span>
<span class="sd">        src_crs (str): The coordinate reference system (CRS) of the GeoDataFrame. Default is &quot;EPSG:4326&quot;.</span>
<span class="sd">        dst_crs (str): The target CRS of the GeoDataFrame. Default is None</span>

<span class="sd">    Returns:</span>
<span class="sd">        geopandas.GeoDataFrame: The converted GeoPandas GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely</span> <span class="kn">import</span> <span class="n">wkt</span>

    <span class="c1"># Convert the geometry column to Shapely geometry objects</span>
    <span class="n">df</span><span class="p">[</span><span class="n">geometry</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">geometry</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">wkt</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="c1"># Convert the pandas DataFrame to a GeoPandas GeoDataFrame</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">src_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dst_crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dst_crs</span> <span class="o">!=</span> <span class="n">src_crs</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.df_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">df_to_geojson</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.df_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates points for a Pandas DataFrame and exports data as a GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pandas.DataFrame</code></td>
        <td><p>The input Pandas DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_geojson</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the exported GeoJSON. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing latitude coordinates. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>longitude</code></td>
        <td><code>str</code></td>
        <td><p>The name of the column containing longitude coordinates. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of characters. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">df_to_geojson</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">latitude</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates points for a Pandas DataFrame and exports data as a GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): The input Pandas DataFrame.</span>
<span class="sd">        out_geojson (str): The file path to the exported GeoJSON. Default to None.</span>
<span class="sd">        latitude (str, optional): The name of the column containing latitude coordinates. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        longitude (str, optional): The name of the column containing longitude coordinates. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of characters. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">from</span> <span class="nn">geojson</span> <span class="kn">import</span> <span class="n">Feature</span><span class="p">,</span> <span class="n">FeatureCollection</span><span class="p">,</span> <span class="n">Point</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">Feature</span><span class="p">(</span>
            <span class="n">geometry</span><span class="o">=</span><span class="n">Point</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">longitude</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">latitude</span><span class="p">]))),</span>
            <span class="n">properties</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">row</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">geojson</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">geojson</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">geojson</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.dict_to_json" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dict_to_json</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>


<a href="#leafmap.common.dict_to_json" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Writes a dictionary to a JSON file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the JSON file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>indent</code></td>
        <td><code>int</code></td>
        <td><p>The indentation of the JSON file. Defaults to 4.</p></td>
        <td><code>4</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>If the input data is not a dictionary.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dict_to_json</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a dictionary to a JSON file.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): A dictionary.</span>
<span class="sd">        file_path (str): The path to the JSON file.</span>
<span class="sd">        indent (int, optional): The indentation of the JSON file. Defaults to 4.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the input data is not a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>

    <span class="n">file_path</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided data must be a dictionary.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.disjoint" class="doc doc-heading">
<code class="highlight language-python"><span class="n">disjoint</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">selecting_features</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.disjoint" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Find the features in the input_features that do not intersect the selecting_features.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_features</code></td>
        <td><code>str | GeoDataFrame</code></td>
        <td><p>The input features to select from. Can be a file path or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>selecting_features</code></td>
        <td><code>str | GeoDataFrame</code></td>
        <td><p>The features in the Input Features parameter will be selected based
on their relationship to the features from this layer.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>are</code></td>
        <td><p>The output path to save the GeoDataFrame in a vector format (e.g., shapefile). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str | GeoDataFrame</code></td>
      <td><p>The path to the output file or the GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">disjoint</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">selecting_features</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the features in the input_features that do not intersect the selecting_features.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_features (str | GeoDataFrame): The input features to select from. Can be a file path or a GeoDataFrame.</span>
<span class="sd">        selecting_features (str | GeoDataFrame): The features in the Input Features parameter will be selected based</span>
<span class="sd">            on their relationship to the features from this layer.</span>
<span class="sd">        output (are, optional): The output path to save the GeoDataFrame in a vector format (e.g., shapefile). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str | GeoDataFrame: The path to the output file or the GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">input_features</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;input_features must be a file path or a GeoDataFrame&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selecting_features</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">selecting_features</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">selecting_features</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selecting_features</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;selecting_features must be a file path or a GeoDataFrame&quot;</span><span class="p">)</span>

    <span class="n">selecting_features</span> <span class="o">=</span> <span class="n">selecting_features</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">input_features</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>

    <span class="n">input_features</span><span class="p">[</span><span class="s2">&quot;savedindex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_features</span><span class="o">.</span><span class="n">index</span>
    <span class="n">intersecting</span> <span class="o">=</span> <span class="n">selecting_features</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)[</span><span class="s2">&quot;savedindex&quot;</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">input_features</span><span class="p">[</span><span class="o">~</span><span class="n">input_features</span><span class="o">.</span><span class="n">savedindex</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">intersecting</span><span class="p">)]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;savedindex&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">results</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.display_html" class="doc doc-heading">
<code class="highlight language-python"><span class="n">display_html</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;600px&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.display_html" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Show an HTML file in a Jupyter notebook.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The path to the HTML file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>str</code></td>
        <td><p>The width of the HTML file. Defaults to "100%".</p></td>
        <td><code>&#39;100%&#39;</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>str</code></td>
        <td><p>The height of the HTML file. Defaults to "600px".</p></td>
        <td><code>&#39;600px&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>IFrame</code></td>
      <td><p>An IFrame object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">display_html</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;600px&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show an HTML file in a Jupyter notebook.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The path to the HTML file.</span>
<span class="sd">        width (str, optional): The width of the HTML file. Defaults to &quot;100%&quot;.</span>
<span class="sd">        height (str, optional): The height of the HTML file. Defaults to &quot;600px&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        IFrame: An IFrame object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">IFrame</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cookies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subfolder</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.download_file" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download a file from URL, including Google Drive shared URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>Google Drive URL is also supported. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>Output filename. Default is basename of URL.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress terminal output. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>proxy</code></td>
        <td><code>str</code></td>
        <td><p>Proxy. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>speed</code></td>
        <td><code>float</code></td>
        <td><p>Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>use_cookies</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to use cookies. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verify</code></td>
        <td><code>bool | str</code></td>
        <td><p>Either a bool, in which case it controls whether the server's TLS certificate is verified, or a string,
in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>id</code></td>
        <td><code>str</code></td>
        <td><p>Google Drive's file ID. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fuzzy</code></td>
        <td><code>bool</code></td>
        <td><p>Fuzzy extraction of Google Drive's file Id. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>resume</code></td>
        <td><code>bool</code></td>
        <td><p>Resume the download from existing tmp file if possible. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>unzip</code></td>
        <td><code>bool</code></td>
        <td><p>Unzip the file. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Overwrite the file if it already exists. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>subfolder</code></td>
        <td><code>bool</code></td>
        <td><p>Create a subfolder with the same name as the file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The output file path.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_cookies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">subfolder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file from URL, including Google Drive shared URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str, optional): Google Drive URL is also supported. Defaults to None.</span>
<span class="sd">        output (str, optional): Output filename. Default is basename of URL.</span>
<span class="sd">        quiet (bool, optional): Suppress terminal output. Default is False.</span>
<span class="sd">        proxy (str, optional): Proxy. Defaults to None.</span>
<span class="sd">        speed (float, optional): Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</span>
<span class="sd">        use_cookies (bool, optional): Flag to use cookies. Defaults to True.</span>
<span class="sd">        verify (bool | str, optional): Either a bool, in which case it controls whether the server&#39;s TLS certificate is verified, or a string,</span>
<span class="sd">            in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.</span>
<span class="sd">        id (str, optional): Google Drive&#39;s file ID. Defaults to None.</span>
<span class="sd">        fuzzy (bool, optional): Fuzzy extraction of Google Drive&#39;s file Id. Defaults to False.</span>
<span class="sd">        resume (bool, optional): Resume the download from existing tmp file if possible. Defaults to False.</span>
<span class="sd">        unzip (bool, optional): Unzip the file. Defaults to True.</span>
<span class="sd">        overwrite (bool, optional): Overwrite the file if it already exists. Defaults to False.</span>
<span class="sd">        subfolder (bool, optional): Create a subfolder with the same name as the file. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The output file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">gdown</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The gdown package is required for this function. Use `pip install gdown` to install it.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">overwrite</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2"> already exists. Skip downloading. Set overwrite=True to overwrite.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;https://drive.google.com/file/d/&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="n">proxy</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">use_cookies</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">,</span> <span class="n">resume</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">unzip</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting files...&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">subfolder</span><span class="p">:</span>
                    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">output</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                    <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tar&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tar.gz&quot;</span><span class="p">):</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;r:gz&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span>

            <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar_ref</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting files...&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">subfolder</span><span class="p">:</span>
                    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">output</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                    <span class="n">tar_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tar_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_file_lite" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_file_lite</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

<a href="#leafmap.common.download_file_lite" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download a file using Pyodide. This function is only available on JupyterLite. Call the function with await, such as await download_file_lite(url).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The local path to save the file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>binary</code></td>
        <td><code>bool</code></td>
        <td><p>Whether the file is binary. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite the file if it exists. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">download_file_lite</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file using Pyodide. This function is only available on JupyterLite. Call the function with await, such as await download_file_lite(url).</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the file.</span>
<span class="sd">        output (str, optional): The local path to save the file. Defaults to None.</span>
<span class="sd">        binary (bool, optional): Whether the file is binary. Defaults to False.</span>
<span class="sd">        overwrite (bool, optional): Whether to overwrite the file if it exists. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">import</span> <span class="nn">pyodide</span>

    <span class="k">if</span> <span class="s2">&quot;pyodide&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pyodide is not available.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">output</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="s2">&quot;jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">,</span> <span class="s2">&quot;.tiff&quot;</span><span class="p">,</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span> <span class="s2">&quot;gz&quot;</span><span class="p">,</span> <span class="s2">&quot;bz2&quot;</span><span class="p">,</span> <span class="s2">&quot;xz&quot;</span><span class="p">]:</span>
        <span class="n">binary</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2"> already exists, skip downloading.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">pyodide</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">pyfetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">bytes</span><span class="p">())</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">pyodide</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">open_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">fd</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cookies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subfolder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multi_part</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.download_files" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download files from URLs, including Google Drive shared URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urls</code></td>
        <td><code>list</code></td>
        <td><p>The list of urls to download. Google Drive URL is also supported.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>filenames</code></td>
        <td><code>list</code></td>
        <td><p>Output filename. Default is basename of URL.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress terminal output. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>proxy</code></td>
        <td><code>str</code></td>
        <td><p>Proxy. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>speed</code></td>
        <td><code>float</code></td>
        <td><p>Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>use_cookies</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to use cookies. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verify</code></td>
        <td><code>bool | str</code></td>
        <td><p>Either a bool, in which case it controls whether the server's TLS certificate is verified, or a string, in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>id</code></td>
        <td><code>str</code></td>
        <td><p>Google Drive's file ID. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fuzzy</code></td>
        <td><code>bool</code></td>
        <td><p>Fuzzy extraction of Google Drive's file Id. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>resume</code></td>
        <td><code>bool</code></td>
        <td><p>Resume the download from existing tmp file if possible. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>unzip</code></td>
        <td><code>bool</code></td>
        <td><p>Unzip the file. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Overwrite the file if it already exists. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>subfolder</code></td>
        <td><code>bool</code></td>
        <td><p>Create a subfolder with the same name as the file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>multi_part</code></td>
        <td><code>bool</code></td>
        <td><p>If the file is a multi-part file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>files = ["sam_hq_vit_tiny.zip", "sam_hq_vit_tiny.z01", "sam_hq_vit_tiny.z02", "sam_hq_vit_tiny.z03"]
base_url = "https://github.com/opengeos/datasets/releases/download/models/"
urls = [base_url + f for f in files]
leafmap.download_files(urls, out_dir="models", multi_part=True)</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_files</span><span class="p">(</span>
    <span class="n">urls</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_cookies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">resume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">subfolder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">multi_part</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download files from URLs, including Google Drive shared URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        urls (list): The list of urls to download. Google Drive URL is also supported.</span>
<span class="sd">        out_dir (str, optional): The output directory. Defaults to None.</span>
<span class="sd">        filenames (list, optional): Output filename. Default is basename of URL.</span>
<span class="sd">        quiet (bool, optional): Suppress terminal output. Default is False.</span>
<span class="sd">        proxy (str, optional): Proxy. Defaults to None.</span>
<span class="sd">        speed (float, optional): Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</span>
<span class="sd">        use_cookies (bool, optional): Flag to use cookies. Defaults to True.</span>
<span class="sd">        verify (bool | str, optional): Either a bool, in which case it controls whether the server&#39;s TLS certificate is verified, or a string, in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.</span>
<span class="sd">        id (str, optional): Google Drive&#39;s file ID. Defaults to None.</span>
<span class="sd">        fuzzy (bool, optional): Fuzzy extraction of Google Drive&#39;s file Id. Defaults to False.</span>
<span class="sd">        resume (bool, optional): Resume the download from existing tmp file if possible. Defaults to False.</span>
<span class="sd">        unzip (bool, optional): Unzip the file. Defaults to True.</span>
<span class="sd">        overwrite (bool, optional): Overwrite the file if it already exists. Defaults to False.</span>
<span class="sd">        subfolder (bool, optional): Create a subfolder with the same name as the file. Defaults to False.</span>
<span class="sd">        multi_part (bool, optional): If the file is a multi-part file. Defaults to False.</span>

<span class="sd">    Examples:</span>

<span class="sd">        files = [&quot;sam_hq_vit_tiny.zip&quot;, &quot;sam_hq_vit_tiny.z01&quot;, &quot;sam_hq_vit_tiny.z02&quot;, &quot;sam_hq_vit_tiny.z03&quot;]</span>
<span class="sd">        base_url = &quot;https://github.com/opengeos/datasets/releases/download/models/&quot;</span>
<span class="sd">        urls = [base_url + f for f in files]</span>
<span class="sd">        leafmap.download_files(urls, out_dir=&quot;models&quot;, multi_part=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">filenames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>

    <span class="n">filepaths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">url</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">filenames</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

        <span class="n">filepaths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">multi_part</span><span class="p">:</span>
            <span class="n">unzip</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">download_file</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">quiet</span><span class="p">,</span>
            <span class="n">proxy</span><span class="p">,</span>
            <span class="n">speed</span><span class="p">,</span>
            <span class="n">use_cookies</span><span class="p">,</span>
            <span class="n">verify</span><span class="p">,</span>
            <span class="nb">id</span><span class="p">,</span>
            <span class="n">fuzzy</span><span class="p">,</span>
            <span class="n">resume</span><span class="p">,</span>
            <span class="n">unzip</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="p">,</span>
            <span class="n">subfolder</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">multi_part</span><span class="p">:</span>
        <span class="n">archive</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">extract_archive</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">filepaths</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_folder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_folder</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cookies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remaining_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.download_folder" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Downloads the entire folder from URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the Google Drive folder. Must be of the format 'https://drive.google.com/drive/folders/{url}'. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>id</code></td>
        <td><code>str</code></td>
        <td><p>Google Drive's folder ID. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>String containing the path of the output folder. Defaults to current working directory.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress terminal output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>proxy</code></td>
        <td><code>str</code></td>
        <td><p>Proxy. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>speed</code></td>
        <td><code>float</code></td>
        <td><p>Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>use_cookies</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to use cookies. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>resume</code></td>
        <td><code>bool</code></td>
        <td><p>Resume the download from existing tmp file if possible. Defaults to False.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>List of files downloaded, or None if failed.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_folder</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">use_cookies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">remaining_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads the entire folder from URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str, optional): URL of the Google Drive folder. Must be of the format &#39;https://drive.google.com/drive/folders/{url}&#39;. Defaults to None.</span>
<span class="sd">        id (str, optional): Google Drive&#39;s folder ID. Defaults to None.</span>
<span class="sd">        output (str, optional):  String containing the path of the output folder. Defaults to current working directory.</span>
<span class="sd">        quiet (bool, optional): Suppress terminal output. Defaults to False.</span>
<span class="sd">        proxy (str, optional): Proxy. Defaults to None.</span>
<span class="sd">        speed (float, optional): Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</span>
<span class="sd">        use_cookies (bool, optional): Flag to use cookies. Defaults to True.</span>
<span class="sd">        resume (bool, optional): Resume the download from existing tmp file if possible. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of files downloaded, or None if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">gdown</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The gdown package is required for this function. Use `pip install gdown` to install it.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">files</span> <span class="o">=</span> <span class="n">gdown</span><span class="o">.</span><span class="n">download_folder</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="n">proxy</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">use_cookies</span><span class="p">,</span> <span class="n">remaining_ok</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">files</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_from_gdrive" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_from_gdrive</span><span class="p">(</span><span class="n">gfile_url</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.download_from_gdrive" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download a file shared via Google Drive
   (e.g., https://drive.google.com/file/d/18SUo_HcDGltuWYZs1s7PpOmOq_FvFn04/view?usp=sharing)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gfile_url</code></td>
        <td><code>str</code></td>
        <td><p>The Google Drive shared file URL</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_name</code></td>
        <td><code>str</code></td>
        <td><p>The output file name to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory. Defaults to '.'.</p></td>
        <td><code>&#39;.&#39;</code></td>
      </tr>
      <tr>
        <td><code>unzip</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to unzip the output file if it is a zip file. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to display or not the output of the function</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_from_gdrive</span><span class="p">(</span><span class="n">gfile_url</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file shared via Google Drive</span>
<span class="sd">       (e.g., https://drive.google.com/file/d/18SUo_HcDGltuWYZs1s7PpOmOq_FvFn04/view?usp=sharing)</span>

<span class="sd">    Args:</span>
<span class="sd">        gfile_url (str): The Google Drive shared file URL</span>
<span class="sd">        file_name (str): The output file name to use.</span>
<span class="sd">        out_dir (str, optional): The output directory. Defaults to &#39;.&#39;.</span>
<span class="sd">        unzip (bool, optional): Whether to unzip the output file if it is a zip file. Defaults to True.</span>
<span class="sd">        verbose (bool, optional): Whether to display or not the output of the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">google_drive_downloader</span> <span class="kn">import</span> <span class="n">GoogleDriveDownloader</span> <span class="k">as</span> <span class="n">gdd</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s1">&#39;Please install googledrivedownloader using &quot;pip install googledrivedownloader&quot;&#39;</span>
        <span class="p">)</span>

    <span class="n">file_id</span> <span class="o">=</span> <span class="n">gfile_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Google Drive file id: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_id</span><span class="p">))</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">check_dir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="n">dest_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="n">gdd</span><span class="o">.</span><span class="n">download_file_from_google_drive</span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">unzip</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_from_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">out_file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.download_from_url" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download a file from a URL (e.g., https://github.com/opengeos/whitebox-python/raw/master/examples/testdata.zip)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The HTTP URL to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_file_name</code></td>
        <td><code>str</code></td>
        <td><p>The output file name to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory to use. Defaults to '.'.</p></td>
        <td><code>&#39;.&#39;</code></td>
      </tr>
      <tr>
        <td><code>unzip</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to unzip the downloaded file if it is a zip file. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to display or not the output of the function</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_from_url</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">out_file_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">unzip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file from a URL (e.g., https://github.com/opengeos/whitebox-python/raw/master/examples/testdata.zip)</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The HTTP URL to download.</span>
<span class="sd">        out_file_name (str, optional): The output file name to use. Defaults to None.</span>
<span class="sd">        out_dir (str, optional): The output directory to use. Defaults to &#39;.&#39;.</span>
<span class="sd">        unzip (bool, optional): Whether to unzip the downloaded file if it is a zip file. Defaults to True.</span>
<span class="sd">        verbose (bool, optional): Whether to display or not the output of the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">in_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">check_dir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_file_name</span> <span class="o">=</span> <span class="n">in_file_name</span>
    <span class="n">out_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">out_file_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading </span><span class="si">{}</span><span class="s2"> ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The URL is invalid. Please double check the URL.&quot;</span><span class="p">)</span>

    <span class="n">final_path</span> <span class="o">=</span> <span class="n">out_file_path</span>

    <span class="k">if</span> <span class="n">unzip</span><span class="p">:</span>
        <span class="c1"># if it is a zip file</span>
        <span class="k">if</span> <span class="s2">&quot;.zip&quot;</span> <span class="ow">in</span> <span class="n">out_file_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unzipping </span><span class="si">{}</span><span class="s2"> ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">out_file_name</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
                <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
            <span class="n">final_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">),</span> <span class="n">out_file_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># if it is a tar file</span>
        <span class="k">if</span> <span class="s2">&quot;.tar&quot;</span> <span class="ow">in</span> <span class="n">out_file_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unzipping </span><span class="si">{}</span><span class="s2"> ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">out_file_name</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar_ref</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar_ref</span><span class="p">:</span>

                    <span class="k">def</span> <span class="nf">is_within_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
                        <span class="n">abs_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
                        <span class="n">abs_target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

                        <span class="n">prefix</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">([</span><span class="n">abs_directory</span><span class="p">,</span> <span class="n">abs_target</span><span class="p">])</span>

                        <span class="k">return</span> <span class="n">prefix</span> <span class="o">==</span> <span class="n">abs_directory</span>

                    <span class="k">def</span> <span class="nf">safe_extract</span><span class="p">(</span>
                        <span class="n">tar</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">members</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">numeric_owner</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">):</span>
                        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">tar</span><span class="o">.</span><span class="n">getmembers</span><span class="p">():</span>
                            <span class="n">member_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_within_directory</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">member_path</span><span class="p">):</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Attempted Path Traversal in Tar File&quot;</span><span class="p">)</span>

                        <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">members</span><span class="p">,</span> <span class="n">numeric_owner</span><span class="o">=</span><span class="n">numeric_owner</span><span class="p">)</span>

                    <span class="n">safe_extract</span><span class="p">(</span><span class="n">tar_ref</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">)</span>

            <span class="n">final_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">),</span> <span class="n">out_file_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.tart&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data downloaded to: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">final_path</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_google_buildings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_google_buildings</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge_output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_geojson</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.download_google_buildings" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download Google Open Building dataset for a specific location. Check the dataset links from
    https://sites.research.google/open-buildings.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>location</code></td>
        <td><code>str</code></td>
        <td><p>The location name for which to download the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The output directory to save the downloaded files. If not provided, the current working directory is used.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>merge_output</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Optional. The output file path for merging the downloaded files into a single GeoDataFrame.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>head</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Optional. The number of files to download. If not provided, all files will be downloaded.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>keep_geojson</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, the GeoJSON files will be kept after converting them to CSV files.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, overwrite the existing files.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, suppresses the download progress messages.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the <code>gpd.to_file</code> function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>A list of file paths of the downloaded files.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_google_buildings</span><span class="p">(</span>
    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">merge_output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">head</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">keep_geojson</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Download Google Open Building dataset for a specific location. Check the dataset links from</span>
<span class="sd">        https://sites.research.google/open-buildings.</span>

<span class="sd">    Args:</span>
<span class="sd">        location: The location name for which to download the dataset.</span>
<span class="sd">        out_dir: The output directory to save the downloaded files. If not provided, the current working directory is used.</span>
<span class="sd">        merge_output: Optional. The output file path for merging the downloaded files into a single GeoDataFrame.</span>
<span class="sd">        head: Optional. The number of files to download. If not provided, all files will be downloaded.</span>
<span class="sd">        keep_geojson: Optional. If True, the GeoJSON files will be kept after converting them to CSV files.</span>
<span class="sd">        overwrite: Optional. If True, overwrite the existing files.</span>
<span class="sd">        quiet: Optional. If True, suppresses the download progress messages.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the `gpd.to_file` function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of file paths of the downloaded files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely</span> <span class="kn">import</span> <span class="n">wkt</span>

    <span class="n">building_url</span> <span class="o">=</span> <span class="s2">&quot;https://sites.research.google/open-buildings/tiles.geojson&quot;</span>
    <span class="n">country_url</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;https://naciscdn.org/naturalearth/110m/cultural/ne_110m_admin_0_countries.zip&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">building_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">building_url</span><span class="p">)</span>
    <span class="n">country_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">country_url</span><span class="p">)</span>

    <span class="n">country</span> <span class="o">=</span> <span class="n">country_gdf</span><span class="p">[</span><span class="n">country_gdf</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">location</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">country</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">country</span> <span class="o">=</span> <span class="n">country_gdf</span><span class="p">[</span><span class="n">country_gdf</span><span class="p">[</span><span class="s2">&quot;NAME_LONG&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">location</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">country</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2"> in the Natural Earth dataset.&quot;</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">building_gdf</span><span class="p">[</span><span class="n">building_gdf</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">country</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;size_mb&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="si">}</span><span class="s2"> links for </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;tile_url&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">download_files</span><span class="p">(</span><span class="n">links</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">link</span><span class="p">))</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">]</span>

        <span class="n">gdfs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="c1"># Read the CSV file into a pandas DataFrame</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

            <span class="c1"># Create a geometry column from the &quot;geometry&quot; column in the DataFrame</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wkt</span><span class="o">.</span><span class="n">loads</span><span class="p">)</span>

            <span class="c1"># Convert the pandas DataFrame to a GeoDataFrame</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
            <span class="k">if</span> <span class="n">keep_geojson</span><span class="p">:</span>
                <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span>
                    <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.csv.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">),</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            <span class="n">gdfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">merge_output</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">merge_output</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">merge_output</span><span class="si">}</span><span class="s2"> already exists, skip merging...&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merging GeoDataFrames ...&quot;</span><span class="p">)</span>
                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gdfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span>
                <span class="p">)</span>
                <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">merge_output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No buildings found for </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_ms_buildings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_ms_buildings</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge_output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.download_ms_buildings" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download Microsoft Buildings dataset for a specific location. Check the dataset links from
    https://minedbuildings.blob.core.windows.net/global-buildings/dataset-links.csv.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>location</code></td>
        <td><code>str</code></td>
        <td><p>The location name for which to download the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The output directory to save the downloaded files. If not provided, the current working directory is used.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>merge_output</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Optional. The output file path for merging the downloaded files into a single GeoDataFrame.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>head</code></td>
        <td></td>
        <td><p>Optional. The number of files to download. If not provided, all files will be downloaded.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, suppresses the download progress messages.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the <code>gpd.to_file</code> function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>A list of file paths of the downloaded files.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_ms_buildings</span><span class="p">(</span>
    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">merge_output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Download Microsoft Buildings dataset for a specific location. Check the dataset links from</span>
<span class="sd">        https://minedbuildings.blob.core.windows.net/global-buildings/dataset-links.csv.</span>

<span class="sd">    Args:</span>
<span class="sd">        location: The location name for which to download the dataset.</span>
<span class="sd">        out_dir: The output directory to save the downloaded files. If not provided, the current working directory is used.</span>
<span class="sd">        merge_output: Optional. The output file path for merging the downloaded files into a single GeoDataFrame.</span>
<span class="sd">        head: Optional. The number of files to download. If not provided, all files will be downloaded.</span>
<span class="sd">        quiet: Optional. If True, suppresses the download progress messages.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the `gpd.to_file` function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of file paths of the downloaded files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">shape</span>

    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">dataset_links</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="s2">&quot;https://minedbuildings.blob.core.windows.net/global-buildings/dataset-links.csv&quot;</span>
    <span class="p">)</span>
    <span class="n">country_links</span> <span class="o">=</span> <span class="n">dataset_links</span><span class="p">[</span><span class="n">dataset_links</span><span class="o">.</span><span class="n">Location</span> <span class="o">==</span> <span class="n">location</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">country_links</span><span class="p">)</span><span class="si">}</span><span class="s2"> links for </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">country_links</span> <span class="o">=</span> <span class="n">country_links</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>

    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">country_links</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">country_links</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">QuadKey</span><span class="si">}</span><span class="s2">.geojson&quot;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">QuadKey</span><span class="si">}</span><span class="s2">.geojson&quot;</span><span class="p">)</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> already exists, skipping...&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="mi">4326</span><span class="p">)</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">merge_output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">merge_output</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">merge_output</span><span class="si">}</span><span class="s2"> already exists, skip merging...&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filenames</span>
        <span class="n">merge_vector</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">merge_output</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">filenames</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_ned" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_ned</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_url</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">query</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.download_ned" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download the US National Elevation Datasets (NED) for a region.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>str | list</code></td>
        <td><p>A filepath to a vector dataset or a list of bounds in the form of [minx, miny, maxx, maxy].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The directory to download the files to. Defaults to None, which uses the current working directory.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_url</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the download URLs of the files. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>download_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the download_file function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>geopandas_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the geopandas.read_file() function.
Used for reading a region URL|filepath.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>query</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the The_national_map_USGS.find_details() function.
See https://apps.nationalmap.gov/tnmaccess/#/product for more information.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of the download URLs of the files if return_url is True.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_ned</span><span class="p">(</span>
    <span class="n">region</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_url</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">query</span><span class="o">=</span><span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download the US National Elevation Datasets (NED) for a region.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (str | list): A filepath to a vector dataset or a list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">        out_dir (str, optional): The directory to download the files to. Defaults to None, which uses the current working directory.</span>
<span class="sd">        return_url (bool, optional): Whether to return the download URLs of the files. Defaults to False.</span>
<span class="sd">        download_args (dict, optional): A dictionary of arguments to pass to the download_file function. Defaults to {}.</span>
<span class="sd">        geopandas_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">            Used for reading a region URL|filepath.</span>
<span class="sd">        query (dict, optional): A dictionary of arguments to pass to the The_national_map_USGS.find_details() function.</span>
<span class="sd">            See https://apps.nationalmap.gov/tnmaccess/#/product for more information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of the download URLs of the files if return_url is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;datasets&quot;</span><span class="p">:</span> <span class="s2">&quot;National Elevation Dataset (NED) 1/3 arc-second&quot;</span><span class="p">,</span>
            <span class="s2">&quot;prodFormats&quot;</span><span class="p">:</span> <span class="s2">&quot;GeoTIFF&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="n">TNM</span> <span class="o">=</span> <span class="n">The_national_map_USGS</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">return_url</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TNM</span><span class="o">.</span><span class="n">find_tiles</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="n">geopandas_args</span><span class="p">,</span> <span class="n">API</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TNM</span><span class="o">.</span><span class="n">download_tiles</span><span class="p">(</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">out_dir</span><span class="o">=</span><span class="n">out_dir</span><span class="p">,</span>
        <span class="n">download_args</span><span class="o">=</span><span class="n">download_args</span><span class="p">,</span>
        <span class="n">geopandas_args</span><span class="o">=</span><span class="n">geopandas_args</span><span class="p">,</span>
        <span class="n">API</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.download_tnm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_tnm</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_url</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">API</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.download_tnm" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download the US National Elevation Datasets (NED) for a region.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>str | list</code></td>
        <td><p>An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].
Alternatively you could use API parameters such as polygon or bbox.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The directory to download the files to. Defaults to None, which uses the current working directory.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_url</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the download URLs of the files. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>download_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the download_file function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>geopandas_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the geopandas.read_file() function.
Used for reading a region URL|filepath.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>API</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the The_national_map_USGS.find_details() function.
Exposes most of the documented API. Defaults to {}</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of the download URLs of the files if return_url is True.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_tnm</span><span class="p">(</span>
    <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_url</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">download_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">geopandas_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">API</span><span class="o">=</span><span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download the US National Elevation Datasets (NED) for a region.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (str | list, optional): An URL|filepath to a vector dataset Or a list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">            Alternatively you could use API parameters such as polygon or bbox.</span>
<span class="sd">        out_dir (str, optional): The directory to download the files to. Defaults to None, which uses the current working directory.</span>
<span class="sd">        return_url (bool, optional): Whether to return the download URLs of the files. Defaults to False.</span>
<span class="sd">        download_args (dict, optional): A dictionary of arguments to pass to the download_file function. Defaults to {}.</span>
<span class="sd">        geopandas_args (dict, optional): A dictionary of arguments to pass to the geopandas.read_file() function.</span>
<span class="sd">            Used for reading a region URL|filepath.</span>
<span class="sd">        API (dict, optional): A dictionary of arguments to pass to the The_national_map_USGS.find_details() function.</span>
<span class="sd">            Exposes most of the documented API. Defaults to {}</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of the download URLs of the files if return_url is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">TNM</span> <span class="o">=</span> <span class="n">The_national_map_USGS</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">return_url</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TNM</span><span class="o">.</span><span class="n">find_tiles</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">geopandas_args</span><span class="o">=</span><span class="n">geopandas_args</span><span class="p">,</span> <span class="n">API</span><span class="o">=</span><span class="n">API</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TNM</span><span class="o">.</span><span class="n">download_tiles</span><span class="p">(</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">out_dir</span><span class="o">=</span><span class="n">out_dir</span><span class="p">,</span>
        <span class="n">download_args</span><span class="o">=</span><span class="n">download_args</span><span class="p">,</span>
        <span class="n">geopandas_args</span><span class="o">=</span><span class="n">geopandas_args</span><span class="p">,</span>
        <span class="n">API</span><span class="o">=</span><span class="n">API</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.edit_download_html" class="doc doc-heading">
<code class="highlight language-python"><span class="n">edit_download_html</span><span class="p">(</span><span class="n">htmlWidget</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Click here to download: &#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.edit_download_html" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Downloads a file from voila. Adopted from https://github.com/voila-dashboards/voila/issues/578#issuecomment-617668058</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>htmlWidget</code></td>
        <td><code>object</code></td>
        <td><p>The HTML widget to display the URL.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>File path to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>Download description. Defaults to "Click here to download: ".</p></td>
        <td><code>&#39;Click here to download: &#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">edit_download_html</span><span class="p">(</span><span class="n">htmlWidget</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Click here to download: &quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a file from voila. Adopted from https://github.com/voila-dashboards/voila/issues/578#issuecomment-617668058</span>

<span class="sd">    Args:</span>
<span class="sd">        htmlWidget (object): The HTML widget to display the URL.</span>
<span class="sd">        filename (str): File path to download.</span>
<span class="sd">        title (str, optional): Download description. Defaults to &quot;Click here to download: &quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># from IPython.display import HTML</span>
    <span class="c1"># import ipywidgets as widgets</span>
    <span class="kn">import</span> <span class="nn">base64</span>

    <span class="c1"># Change widget html temporarily to a font-awesome spinner</span>
    <span class="n">htmlWidget</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&lt;i class=&quot;fa fa-spinner fa-spin fa-2x fa-fw&quot;&gt;&lt;/i&gt;&lt;span class=&quot;sr-only&quot;&gt;Loading...&lt;/span&gt;&#39;</span>

    <span class="c1"># Process raw data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">b64</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="c1"># Create and assign html to widget</span>
    <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;a download=&quot;</span><span class="si">{filename}</span><span class="s1">&quot; href=&quot;data:text/csv;base64,</span><span class="si">{payload}</span><span class="s1">&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{title}</span><span class="s1">&lt;/a&gt;&#39;</span>
    <span class="n">htmlWidget</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span> <span class="o">+</span> <span class="n">basename</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">basename</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.explode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explode</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span></code>


<a href="#leafmap.common.explode" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Explode a GeoJSON geometry's coordinates object and yield
coordinate tuples. As long as the input is conforming, the type of
the geometry doesn't matter.  From Fiona 1.4.8</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>coords</code></td>
        <td><code>list</code></td>
        <td><p>A list of coordinates.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Yields:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>[type]</code></td>
      <td><p>[description]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="n">coords</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Explode a GeoJSON geometry&#39;s coordinates object and yield</span>
<span class="sd">    coordinate tuples. As long as the input is conforming, the type of</span>
<span class="sd">    the geometry doesn&#39;t matter.  From Fiona 1.4.8</span>

<span class="sd">    Args:</span>
<span class="sd">        coords (list): A list of coordinates.</span>

<span class="sd">    Yields:</span>
<span class="sd">        [type]: [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">yield</span> <span class="n">coords</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">explode</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">f</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.extract_archive" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract_archive</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.extract_archive" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Extracts a multipart archive.</p>
<p>This function uses the patoolib library to extract a multipart archive.
If the patoolib library is not installed, it attempts to install it.
If the archive does not end with ".zip", it appends ".zip" to the archive name.
If the extraction fails (for example, if the files already exist), it skips the extraction.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>archive</code></td>
        <td><code>str</code></td>
        <td><p>The path to the archive file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>outdir</code></td>
        <td><code>str</code></td>
        <td><p>The directory where the archive should be extracted.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Arbitrary keyword arguments for the patoolib.extract_archive function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>An exception is raised if the extraction fails for reasons other than the files already existing.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>files = ["sam_hq_vit_tiny.zip", "sam_hq_vit_tiny.z01", "sam_hq_vit_tiny.z02", "sam_hq_vit_tiny.z03"]
base_url = "https://github.com/opengeos/datasets/releases/download/models/"
urls = [base_url + f for f in files]
leafmap.download_files(urls, out_dir="models", multi_part=True)</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_archive</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts a multipart archive.</span>

<span class="sd">    This function uses the patoolib library to extract a multipart archive.</span>
<span class="sd">    If the patoolib library is not installed, it attempts to install it.</span>
<span class="sd">    If the archive does not end with &quot;.zip&quot;, it appends &quot;.zip&quot; to the archive name.</span>
<span class="sd">    If the extraction fails (for example, if the files already exist), it skips the extraction.</span>

<span class="sd">    Args:</span>
<span class="sd">        archive (str): The path to the archive file.</span>
<span class="sd">        outdir (str): The directory where the archive should be extracted.</span>
<span class="sd">        **kwargs: Arbitrary keyword arguments for the patoolib.extract_archive function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: An exception is raised if the extraction fails for reasons other than the files already existing.</span>

<span class="sd">    Example:</span>

<span class="sd">        files = [&quot;sam_hq_vit_tiny.zip&quot;, &quot;sam_hq_vit_tiny.z01&quot;, &quot;sam_hq_vit_tiny.z02&quot;, &quot;sam_hq_vit_tiny.z03&quot;]</span>
<span class="sd">        base_url = &quot;https://github.com/opengeos/datasets/releases/download/models/&quot;</span>
<span class="sd">        urls = [base_url + f for f in files]</span>
<span class="sd">        leafmap.download_files(urls, out_dir=&quot;models&quot;, multi_part=True)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">patoolib</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">install_package</span><span class="p">(</span><span class="s2">&quot;patool&quot;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">patoolib</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
        <span class="n">archive</span> <span class="o">=</span> <span class="n">archive</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span>

    <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">patoolib</span><span class="o">.</span><span class="n">extract_archive</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="n">outdir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The unzipped files might already exist. Skipping extraction.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.filter_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_bounds</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">within</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.filter_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Filters a GeoDataFrame or GeoSeries by a bounding box.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | GeoDataFrame</code></td>
        <td><p>The input data to filter. Can be a file path or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list | GeoDataFrame</code></td>
        <td><p>The bounding box to filter by. Can be a list of 4 coordinates or a file path or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>within</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to filter by the bounding box or the bounding box's interior. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>align</code></td>
        <td><code>bool</code></td>
        <td><p>If True, automatically aligns GeoSeries based on their indices. If False, the order of elements is preserved.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>GeoDataFrame</code></td>
      <td><p>The filtered data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_bounds</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">within</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a GeoDataFrame or GeoSeries by a bounding box.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | GeoDataFrame): The input data to filter. Can be a file path or a GeoDataFrame.</span>
<span class="sd">        bbox (list | GeoDataFrame): The bounding box to filter by. Can be a list of 4 coordinates or a file path or a GeoDataFrame.</span>
<span class="sd">        within (bool, optional): Whether to filter by the bounding box or the bounding box&#39;s interior. Defaults to False.</span>
<span class="sd">        align (bool, optional): If True, automatically aligns GeoSeries based on their indices. If False, the order of elements is preserved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoDataFrame: The filtered data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;data must be a file path or a GeoDataFrame or GeoSeries&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bbox must be a list of 4 coordinates&quot;</span><span class="p">)</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox_to_gdf</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">within</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">unary_union</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">unary_union</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.filter_date" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_date</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">date_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.filter_date" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Filters a DataFrame, GeoDataFrame or GeoSeries by a date range.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | DataFrame | GeoDataFrame</code></td>
        <td><p>The input data to filter. Can be a file path or a DataFrame or GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>The start date, e.g., 2023-01-01. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>The end date, e.g., 2023-12-31. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>date_field</code></td>
        <td><code>str</code></td>
        <td><p>The name of the date field. Defaults to "date".</p></td>
        <td><code>&#39;date&#39;</code></td>
      </tr>
      <tr>
        <td><code>date_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments for pd.to_datetime. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>The filtered data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_date</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">date_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a DataFrame, GeoDataFrame or GeoSeries by a date range.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | DataFrame | GeoDataFrame): The input data to filter. Can be a file path or a DataFrame or GeoDataFrame.</span>
<span class="sd">        start_date (str, optional): The start date, e.g., 2023-01-01. Defaults to None.</span>
<span class="sd">        end_date (str, optional): The end date, e.g., 2023-12-31. Defaults to None.</span>
<span class="sd">        date_field (str, optional): The name of the date field. Defaults to &quot;date&quot;.</span>
<span class="sd">        date_args (dict, optional): Additional arguments for pd.to_datetime. Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: The filtered data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">datetime</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;data must be a file path or a GeoDataFrame or GeoSeries&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">date_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;date_field must be one of </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">new_field</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">date_field</span><span class="si">}</span><span class="s2">_temp&quot;</span>
    <span class="n">data</span><span class="p">[</span><span class="n">new_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">date_field</span><span class="p">],</span> <span class="o">**</span><span class="n">date_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">end_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">start_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">new_field</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">new_field</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">new_field</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">new_field</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.find_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_files</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.find_files" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Find files in a directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_dir</code></td>
        <td><code>str</code></td>
        <td><p>The input directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>The file extension to match. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fullpath</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the full path. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to search recursively. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of matching files.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_files</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find files in a directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_dir (str): The input directory.</span>
<span class="sd">        ext (str, optional): The file extension to match. Defaults to None.</span>
<span class="sd">        fullpath (bool, optional): Whether to return the full path. Defaults to True.</span>
<span class="sd">        recursive (bool, optional): Whether to search recursively. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of matching files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fullpath</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">joinpath</span><span class="p">())</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fullpath</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">joinpath</span><span class="p">())</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span>

    <span class="n">files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdb_layer_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdb_layer_names</span><span class="p">(</span><span class="n">gdb_path</span><span class="p">)</span></code>


<a href="#leafmap.common.gdb_layer_names" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get a list of layer names in a File Geodatabase (GDB).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdb_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the File Geodatabase (GDB).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>A list of layer names in the GDB.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdb_layer_names</span><span class="p">(</span><span class="n">gdb_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of layer names in a File Geodatabase (GDB).</span>

<span class="sd">    Args:</span>
<span class="sd">        gdb_path (str): The path to the File Geodatabase (GDB).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: A list of layer names in the GDB.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">ogr</span>

    <span class="c1"># Open the GDB</span>
    <span class="n">gdb_driver</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="s2">&quot;OpenFileGDB&quot;</span><span class="p">)</span>
    <span class="n">gdb_dataset</span> <span class="o">=</span> <span class="n">gdb_driver</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">gdb_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Get the number of layers in the GDB</span>
    <span class="n">layer_count</span> <span class="o">=</span> <span class="n">gdb_dataset</span><span class="o">.</span><span class="n">GetLayerCount</span><span class="p">()</span>
    <span class="c1"># Iterate over the layers</span>
    <span class="n">layer_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">layer_count</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">gdb_dataset</span><span class="o">.</span><span class="n">GetLayerByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">feature_class_name</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span>
        <span class="n">layer_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_class_name</span><span class="p">)</span>

    <span class="c1"># Close the GDB dataset</span>
    <span class="n">gdb_dataset</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">layer_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdb_to_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdb_to_vector</span><span class="p">(</span><span class="n">gdb_path</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gdal_driver</span><span class="o">=</span><span class="s1">&#39;GPKG&#39;</span><span class="p">,</span> <span class="n">file_extension</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.gdb_to_vector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts layers from a File Geodatabase (GDB) to a vector format.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdb_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the File Geodatabase (GDB).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory to save the converted files.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layers</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>A list of layer names to convert. If None, all layers will be converted. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>filenames</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>A list of output file names. If None, the layer names will be used as the file names. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gdal_driver</code></td>
        <td><code>str</code></td>
        <td><p>The GDAL driver name for the output vector format. Default is "GPKG".</p></td>
        <td><code>&#39;GPKG&#39;</code></td>
      </tr>
      <tr>
        <td><code>file_extension</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The file extension for the output files. If None, it will be determined automatically based on the gdal_driver. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite the existing output files. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>If True, suppress the log output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdb_to_vector</span><span class="p">(</span>
    <span class="n">gdb_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">layers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filenames</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gdal_driver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GPKG&quot;</span><span class="p">,</span>
    <span class="n">file_extension</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts layers from a File Geodatabase (GDB) to a vector format.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdb_path (str): The path to the File Geodatabase (GDB).</span>
<span class="sd">        out_dir (str): The output directory to save the converted files.</span>
<span class="sd">        layers (Optional[List[str]]): A list of layer names to convert. If None, all layers will be converted. Default is None.</span>
<span class="sd">        filenames (Optional[List[str]]): A list of output file names. If None, the layer names will be used as the file names. Default is None.</span>
<span class="sd">        gdal_driver (str): The GDAL driver name for the output vector format. Default is &quot;GPKG&quot;.</span>
<span class="sd">        file_extension (Optional[str]): The file extension for the output files. If None, it will be determined automatically based on the gdal_driver. Default is None.</span>
<span class="sd">        overwrite (bool): Whether to overwrite the existing output files. Default is False.</span>
<span class="sd">        quiet (bool): If True, suppress the log output. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">ogr</span>

    <span class="c1"># Open the GDB</span>
    <span class="n">gdb_driver</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="s2">&quot;OpenFileGDB&quot;</span><span class="p">)</span>
    <span class="n">gdb_dataset</span> <span class="o">=</span> <span class="n">gdb_driver</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">gdb_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Get the number of layers in the GDB</span>
    <span class="n">layer_count</span> <span class="o">=</span> <span class="n">gdb_dataset</span><span class="o">.</span><span class="n">GetLayerCount</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">layers</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">filenames</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">filenames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The length of filenames must match the length of layers.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Iterate over the layers</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">layer_count</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">gdb_dataset</span><span class="o">.</span><span class="n">GetLayerByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">feature_class_name</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">layers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">feature_class_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="n">file_extension</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file_extension</span> <span class="o">=</span> <span class="n">get_gdal_file_extension</span><span class="p">(</span><span class="n">gdal_driver</span><span class="p">)</span>

        <span class="c1"># Create the output file path</span>
        <span class="k">if</span> <span class="n">filenames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">filenames</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">file_extension</span><span class="p">)</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">out_dir</span><span class="p">,</span> <span class="n">feature_class_name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">file_extension</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2"> already exists. Skipping...&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converting layer </span><span class="si">{</span><span class="n">feature_class_name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="c1"># Create the output driver</span>
        <span class="n">output_driver</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="n">gdal_driver</span><span class="p">)</span>
        <span class="n">output_dataset</span> <span class="o">=</span> <span class="n">output_driver</span><span class="o">.</span><span class="n">CreateDataSource</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

        <span class="c1"># Copy the input layer to the output format</span>
        <span class="n">output_dataset</span><span class="o">.</span><span class="n">CopyLayer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">feature_class_name</span><span class="p">)</span>

        <span class="n">output_dataset</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Close the GDB dataset</span>
    <span class="n">gdb_dataset</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdf_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdf_bounds</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">return_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.gdf_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the bounding box of a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>gpd.GeoDataFrame</code></td>
        <td><p>A GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>return_geom</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the bounding box as a GeoDataFrame. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list | gpd.GeoDataFrame</code></td>
      <td><p>A bounding box in the form of a list (minx, miny, maxx, maxy) or GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdf_bounds</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">return_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the bounding box of a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (gpd.GeoDataFrame): A GeoDataFrame.</span>
<span class="sd">        return_geom (bool, optional): Whether to return the bounding box as a GeoDataFrame. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list | gpd.GeoDataFrame: A bounding box in the form of a list (minx, miny, maxx, maxy) or GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
    <span class="k">if</span> <span class="n">return_geom</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bbox_to_gdf</span><span class="p">(</span><span class="n">bbox</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bounds</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdf_centroid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdf_centroid</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">return_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.gdf_centroid" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the centroid of a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>gpd.GeoDataFrame</code></td>
        <td><p>A GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>return_geom</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the bounding box as a GeoDataFrame. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list | gpd.GeoDataFrame</code></td>
      <td><p>A bounding box in the form of a list (lon, lat) or GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdf_centroid</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">return_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the centroid of a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (gpd.GeoDataFrame): A GeoDataFrame.</span>
<span class="sd">        return_geom (bool, optional): Whether to return the bounding box as a GeoDataFrame. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list | gpd.GeoDataFrame: A bounding box in the form of a list (lon, lat) or GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">centroid</span> <span class="o">=</span> <span class="n">gdf_bounds</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">return_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">centroid</span>
    <span class="k">if</span> <span class="n">return_geom</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">centroid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdf_geom_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdf_geom_type</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.gdf_geom_type" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the geometry type of a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>gpd.GeoDataFrame</code></td>
        <td><p>A GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>first_only</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the geometry type of the f
irst feature in the GeoDataFrame. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The geometry type of the GeoDataFrame, such as Point, LineString,
    Polygon, MultiPoint, MultiLineString, MultiPolygon.
    For more info, see https://shapely.readthedocs.io/en/stable/manual.html</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdf_geom_type</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the geometry type of a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (gpd.GeoDataFrame): A GeoDataFrame.</span>
<span class="sd">        first_only (bool, optional): Whether to return the geometry type of the f</span>
<span class="sd">            irst feature in the GeoDataFrame. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The geometry type of the GeoDataFrame, such as Point, LineString,</span>
<span class="sd">            Polygon, MultiPoint, MultiLineString, MultiPolygon.</span>
<span class="sd">            For more info, see https://shapely.readthedocs.io/en/stable/manual.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="n">first_only</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">type</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">type</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdf_to_bokeh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdf_to_bokeh</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span></code>


<a href="#leafmap.common.gdf_to_bokeh" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Function to convert a GeoPandas GeoDataFrame to a Bokeh
ColumnDataSource object.</p>
<p>:param: (GeoDataFrame) gdf: GeoPandas GeoDataFrame with polygon(s) under
                            the column name 'geometry.'</p>
<p>:return: ColumnDataSource for Bokeh.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdf_to_bokeh</span><span class="p">(</span><span class="n">gdf</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to convert a GeoPandas GeoDataFrame to a Bokeh</span>
<span class="sd">    ColumnDataSource object.</span>

<span class="sd">    :param: (GeoDataFrame) gdf: GeoPandas GeoDataFrame with polygon(s) under</span>
<span class="sd">                                the column name &#39;geometry.&#39;</span>

<span class="sd">    :return: ColumnDataSource for Bokeh.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span>

    <span class="n">shape_type</span> <span class="o">=</span> <span class="n">gdf_geom_type</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="n">gdf_new</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">gdf_new</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">get_geometry_coords</span><span class="p">,</span>
        <span class="n">geom</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
        <span class="n">coord_type</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">shape_type</span><span class="o">=</span><span class="n">shape_type</span><span class="p">,</span>
        <span class="n">mercator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">gdf_new</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">get_geometry_coords</span><span class="p">,</span>
        <span class="n">geom</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
        <span class="n">coord_type</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">shape_type</span><span class="o">=</span><span class="n">shape_type</span><span class="p">,</span>
        <span class="n">mercator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">gdf_new</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdf_to_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdf_to_df</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">drop_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.gdf_to_df" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoDataFrame to a pandas DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>gpd.GeoDataFrame</code></td>
        <td><p>A GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>drop_geom</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop the geometry column. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>A pandas DataFrame containing the GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdf_to_df</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">drop_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoDataFrame to a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (gpd.GeoDataFrame): A GeoDataFrame.</span>
<span class="sd">        drop_geom (bool, optional): Whether to drop the geometry column. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A pandas DataFrame containing the GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="n">drop_geom</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gdf_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gdf_to_geojson</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tuple_to_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.gdf_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoDataFame to GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>GeoDataFrame</code></td>
        <td><p>A GeoPandas GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_geojson</code></td>
        <td><code>str</code></td>
        <td><p>File path to he output GeoJSON. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>epsg</code></td>
        <td><code>str</code></td>
        <td><p>An EPSG string, e.g., "4326". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tuple_to_list</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert tuples to lists. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding to use for the GeoJSON. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>When the output file extension is incorrect.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>When the conversion fails.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>When the out_json is None returns a dict.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gdf_to_geojson</span><span class="p">(</span>
    <span class="n">gdf</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tuple_to_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoDataFame to GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (GeoDataFrame): A GeoPandas GeoDataFrame.</span>
<span class="sd">        out_geojson (str, optional): File path to he output GeoJSON. Defaults to None.</span>
<span class="sd">        epsg (str, optional): An EPSG string, e.g., &quot;4326&quot;. Defaults to None.</span>
<span class="sd">        tuple_to_list (bool, optional): Whether to convert tuples to lists. Defaults to False.</span>
<span class="sd">        encoding (str, optional): The encoding to use for the GeoJSON. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: When the output file extension is incorrect.</span>
<span class="sd">        Exception: When the conversion fails.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: When the out_json is None returns a dict.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">listit</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">listit</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="n">t</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">epsg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span> <span class="o">!=</span> <span class="n">epsg</span><span class="p">:</span>
                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">)</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>

        <span class="k">if</span> <span class="n">tuple_to_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]:</span>
                <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">listit</span><span class="p">(</span>
                    <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">geojson</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;The output file extension must be either .json or .geojson&quot;</span>
                <span class="p">)</span>
            <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

            <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gedi_download_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gedi_download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.gedi_download_file" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Downloads a file from the given URL and saves it to the specified filename.
If no filename is provided, the name of the file from the URL will be used.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the file to download.
e.g., https://daac.ornl.gov/daacdata/gedi/GEDI_L4A_AGB_Density_V2_1/data/GEDI04_A_2019298202754_O04921_01_T02899_02_002_02_V002.h5</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The name of the file to save the downloaded content to. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>username</code></td>
        <td><code>str</code></td>
        <td><p>Username for authentication. Can also be set using the EARTHDATA_USERNAME environment variable. Defaults to None.
Create an account at https://urs.earthdata.nasa.gov</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>password</code></td>
        <td><code>str</code></td>
        <td><p>Password for authentication. Can also be set using the EARTHDATA_PASSWORD environment variable. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gedi_download_file</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads a file from the given URL and saves it to the specified filename.</span>
<span class="sd">    If no filename is provided, the name of the file from the URL will be used.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the file to download.</span>
<span class="sd">            e.g., https://daac.ornl.gov/daacdata/gedi/GEDI_L4A_AGB_Density_V2_1/data/GEDI04_A_2019298202754_O04921_01_T02899_02_002_02_V002.h5</span>
<span class="sd">        filename (str, optional): The name of the file to save the downloaded content to. Defaults to None.</span>
<span class="sd">        username (str, optional): Username for authentication. Can also be set using the EARTHDATA_USERNAME environment variable. Defaults to None.</span>
<span class="sd">            Create an account at https://urs.earthdata.nasa.gov</span>
<span class="sd">        password (str, optional): Password for authentication. Can also be set using the EARTHDATA_PASSWORD environment variable. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">requests</span>
    <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

    <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EARTHDATA_USERNAME&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EARTHDATA_PASSWORD&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Username and password must be provided. Create an account at https://urs.earthdata.nasa.gov.&quot;</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">),</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">total_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content-length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">block_size</span> <span class="o">=</span> <span class="mi">1024</span>  <span class="c1"># 1 KB</span>

            <span class="c1"># Use the filename from the URL if not provided</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
                <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total_size</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">unit_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">block_size</span><span class="p">):</span>
                    <span class="n">progress_bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">progress_bar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gedi_download_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gedi_download_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.gedi_download_files" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Downloads files from the given URLs and saves them to the specified directory.
If no directory is provided, the current directory will be used.
If no filenames are provided, the names of the files from the URLs will be used.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urls</code></td>
        <td><code>List[str]</code></td>
        <td><p>The URLs of the files to download.
e.g., ["https://example.com/file1.txt", "https://example.com/file2.txt"]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>outdir</code></td>
        <td><code>str</code></td>
        <td><p>The directory to save the downloaded files to. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>filenames</code></td>
        <td><code>str</code></td>
        <td><p>The names of the files to save the downloaded content to. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>username</code></td>
        <td><code>str</code></td>
        <td><p>Username for authentication. Can also be set using the EARTHDATA_USERNAME environment variable. Defaults to None.
Create an account at https://urs.earthdata.nasa.gov</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>password</code></td>
        <td><code>str</code></td>
        <td><p>Password for authentication. Can also be set using the EARTHDATA_PASSWORD environment variable. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite the existing output files. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gedi_download_files</span><span class="p">(</span>
    <span class="n">urls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">outdir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filenames</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads files from the given URLs and saves them to the specified directory.</span>
<span class="sd">    If no directory is provided, the current directory will be used.</span>
<span class="sd">    If no filenames are provided, the names of the files from the URLs will be used.</span>

<span class="sd">    Args:</span>
<span class="sd">        urls (List[str]): The URLs of the files to download.</span>
<span class="sd">            e.g., [&quot;https://example.com/file1.txt&quot;, &quot;https://example.com/file2.txt&quot;]</span>
<span class="sd">        outdir (str, optional): The directory to save the downloaded files to. Defaults to None.</span>
<span class="sd">        filenames (str, optional): The names of the files to save the downloaded content to. Defaults to None.</span>
<span class="sd">        username (str, optional): Username for authentication. Can also be set using the EARTHDATA_USERNAME environment variable. Defaults to None.</span>
<span class="sd">            Create an account at https://urs.earthdata.nasa.gov</span>
<span class="sd">        password (str, optional): Password for authentication. Can also be set using the EARTHDATA_PASSWORD environment variable. Defaults to None.</span>
<span class="sd">        overwrite (bool): Whether to overwrite the existing output files. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">requests</span>
    <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="n">urls</span><span class="p">[</span><span class="s2">&quot;granule_url&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EARTHDATA_USERNAME&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EARTHDATA_PASSWORD&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Username and password must be provided.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outdir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading file </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Use the filename from the URL if not provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filenames</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2"> already exists. Skipping...&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">r1</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">),</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">total_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content-length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">block_size</span> <span class="o">=</span> <span class="mi">1024</span>  <span class="c1"># 1 KB</span>

            <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total_size</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">unit_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">block_size</span><span class="p">):</span>
                    <span class="n">progress_bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">progress_bar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gedi_search" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gedi_search</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_roi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;gdf&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_filesize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.gedi_search" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Searches for GEDI data using the Common Metadata Repository (CMR) API.
The source code for this function is adapted from https://github.com/ornldaac/gedi_tutorials.
Credits to ORNL DAAC and Rupesh Shrestha.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>roi</code></td>
        <td></td>
        <td><p>A list, tuple, or file path representing the bounding box coordinates
in the format (min_lon, min_lat, max_lon, max_lat), or a GeoDataFrame
containing the region of interest geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The start date of the temporal range to search for data
in the format 'YYYY-MM-DD'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The end date of the temporal range to search for data
in the format 'YYYY-MM-DD'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>add_roi</code></td>
        <td><code>bool</code></td>
        <td><p>A boolean value indicating whether to include the region of interest
as a granule in the search results. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>The type of the search results to return. Must be one of 'df'
(DataFrame), 'gdf' (GeoDataFrame), or 'csv' (CSV file). Default is 'gdf'.</p></td>
        <td><code>&#39;gdf&#39;</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The file path to save the CSV output when return_type is 'csv'.
Optional and only applicable when return_type is 'csv'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sort_filesize</code></td>
        <td><code>bool</code></td>
        <td><p>A boolean value indicating whether to sort the search results.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the CMR API.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The search results as a pandas DataFrame (return_type='df'), geopandas GeoDataFrame
(return_type='gdf'), or a CSV file (return_type='csv').</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If roi is not a list, tuple, or file path.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gedi_search</span><span class="p">(</span>
    <span class="n">roi</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_roi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gdf&quot;</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sort_filesize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Searches for GEDI data using the Common Metadata Repository (CMR) API.</span>
<span class="sd">    The source code for this function is adapted from https://github.com/ornldaac/gedi_tutorials.</span>
<span class="sd">    Credits to ORNL DAAC and Rupesh Shrestha.</span>

<span class="sd">    Args:</span>
<span class="sd">        roi: A list, tuple, or file path representing the bounding box coordinates</span>
<span class="sd">            in the format (min_lon, min_lat, max_lon, max_lat), or a GeoDataFrame</span>
<span class="sd">            containing the region of interest geometry.</span>
<span class="sd">        start_date: The start date of the temporal range to search for data</span>
<span class="sd">            in the format &#39;YYYY-MM-DD&#39;.</span>
<span class="sd">        end_date: The end date of the temporal range to search for data</span>
<span class="sd">            in the format &#39;YYYY-MM-DD&#39;.</span>
<span class="sd">        add_roi: A boolean value indicating whether to include the region of interest</span>
<span class="sd">            as a granule in the search results. Default is False.</span>
<span class="sd">        return_type: The type of the search results to return. Must be one of &#39;df&#39;</span>
<span class="sd">            (DataFrame), &#39;gdf&#39; (GeoDataFrame), or &#39;csv&#39; (CSV file). Default is &#39;gdf&#39;.</span>
<span class="sd">        output: The file path to save the CSV output when return_type is &#39;csv&#39;.</span>
<span class="sd">            Optional and only applicable when return_type is &#39;csv&#39;.</span>
<span class="sd">        sort_filesize: A boolean value indicating whether to sort the search results.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the CMR API.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The search results as a pandas DataFrame (return_type=&#39;df&#39;), geopandas GeoDataFrame</span>
<span class="sd">        (return_type=&#39;gdf&#39;), or a CSV file (return_type=&#39;csv&#39;).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If roi is not a list, tuple, or file path.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">requests</span>
    <span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">MultiPolygon</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">box</span>
    <span class="kn">from</span> <span class="nn">shapely.ops</span> <span class="kn">import</span> <span class="n">orient</span>

    <span class="c1"># CMR API base url</span>
    <span class="n">cmrurl</span> <span class="o">=</span> <span class="s2">&quot;https://cmr.earthdata.nasa.gov/search/&quot;</span>

    <span class="n">doi</span> <span class="o">=</span> <span class="s2">&quot;10.3334/ORNLDAAC/2056&quot;</span>  <span class="c1"># GEDI L4A DOI</span>

    <span class="c1"># Construct the DOI search URL</span>
    <span class="n">doisearch</span> <span class="o">=</span> <span class="n">cmrurl</span> <span class="o">+</span> <span class="s2">&quot;collections.json?doi=&quot;</span> <span class="o">+</span> <span class="n">doi</span>

    <span class="c1"># Send a request to the CMR API to get the concept ID</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">doisearch</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">concept_id</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;feed&quot;</span><span class="p">][</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="c1"># CMR formatted start and end times</span>
    <span class="k">if</span> <span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dt_format</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%SZ&quot;</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">temporal_str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">start_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">dt_format</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">end_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">dt_format</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temporal_str</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># CMR formatted bounding box</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">bound_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">roi</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
        <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">orient</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>  <span class="c1"># make counter-clockwise</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">orient</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>  <span class="c1"># make counter-clockwise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;roi must be a list, tuple, or a file path.&quot;</span><span class="p">)</span>

    <span class="n">page_num</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">page_size</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># CMR page size limit</span>

    <span class="n">granule_arr</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Define CMR search parameters</span>
        <span class="n">cmr_param</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;collection_concept_id&quot;</span><span class="p">:</span> <span class="n">concept_id</span><span class="p">,</span>
            <span class="s2">&quot;page_size&quot;</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span>
            <span class="s2">&quot;page_num&quot;</span><span class="p">:</span> <span class="n">page_num</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">temporal_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmr_param</span><span class="p">[</span><span class="s2">&quot;temporal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temporal_str</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">cmr_param</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">granulesearch</span> <span class="o">=</span> <span class="n">cmrurl</span> <span class="o">+</span> <span class="s2">&quot;granules.json&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">cmr_param</span><span class="p">[</span><span class="s2">&quot;bounding_box[]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bound_str</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">granulesearch</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">cmr_param</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmr_param</span><span class="p">[</span><span class="s2">&quot;simplify-shapefile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
            <span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;shapefile&quot;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="s2">&quot;region.geojson&quot;</span><span class="p">,</span>
                    <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
                    <span class="s2">&quot;application/geo+json&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">granulesearch</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cmr_param</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">geojson</span><span class="p">)</span>

        <span class="c1"># Send a request to the CMR API to get the granules</span>
        <span class="n">granules</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;feed&quot;</span><span class="p">][</span><span class="s2">&quot;entry&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">granules</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">granules</span><span class="p">):</span>
                <span class="n">granule_url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">granule_poly</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

                <span class="c1"># Read file size</span>
                <span class="n">granule_size</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;granule_size&quot;</span><span class="p">])</span>

                <span class="c1"># Read bounding geometries</span>
                <span class="k">if</span> <span class="s2">&quot;polygons&quot;</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                    <span class="n">polygons</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;polygons&quot;</span><span class="p">]</span>
                    <span class="n">multipolygons</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">polygons</span><span class="p">:</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
                        <span class="n">ltln</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)))</span>
                        <span class="n">multipolygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">Polygon</span><span class="p">(</span>
                                <span class="p">[</span>
                                    <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])]</span>
                                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ltln</span>
                                <span class="p">]</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="n">granule_poly</span> <span class="o">=</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="n">multipolygons</span><span class="p">)</span>

                <span class="c1"># Get URL to HDF5 files</span>
                <span class="k">for</span> <span class="n">links</span> <span class="ow">in</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="s2">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">links</span>
                        <span class="ow">and</span> <span class="n">links</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Download&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="n">links</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
                    <span class="p">):</span>
                        <span class="n">granule_url</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>

                <span class="n">granule_id</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
                <span class="n">time_start</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;time_start&quot;</span><span class="p">]</span>
                <span class="n">time_end</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;time_end&quot;</span><span class="p">]</span>

                <span class="n">granule_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">granule_id</span><span class="p">,</span>
                        <span class="n">title</span><span class="p">,</span>
                        <span class="n">time_start</span><span class="p">,</span>
                        <span class="n">time_end</span><span class="p">,</span>
                        <span class="n">granule_size</span><span class="p">,</span>
                        <span class="n">granule_url</span><span class="p">,</span>
                        <span class="n">granule_poly</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">)</span>

            <span class="n">page_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># Add bound as the last row into the dataframe</span>
    <span class="k">if</span> <span class="n">add_roi</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
            <span class="n">granule_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;roi&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">box</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">granule_arr</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;roi&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">roi</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">item</span><span class="p">()])</span>

    <span class="c1"># Create a pandas dataframe</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time_start&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time_end&quot;</span><span class="p">,</span>
        <span class="s2">&quot;granule_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;granule_url&quot;</span><span class="p">,</span>
        <span class="s2">&quot;granule_poly&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">l4adf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">granule_arr</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

    <span class="c1"># Drop granules with empty geometry</span>
    <span class="n">l4adf</span> <span class="o">=</span> <span class="n">l4adf</span><span class="p">[</span><span class="n">l4adf</span><span class="p">[</span><span class="s2">&quot;granule_poly&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sort_filesize</span><span class="p">:</span>
        <span class="n">l4adf</span> <span class="o">=</span> <span class="n">l4adf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;granule_size&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;df&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">l4adf</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;gdf&quot;</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">l4adf</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;granule_poly&quot;</span><span class="p">)</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="k">return</span> <span class="n">gdf</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;granule_poly&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">l4adf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;return_type must be one of &#39;df&#39;, &#39;gdf&#39;, or &#39;csv&#39;.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gedi_subset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gedi_subset</span><span class="p">(</span><span class="n">spatial</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">],</span> <span class="n">max_results</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.gedi_subset" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Subsets GEDI data using the Harmony API.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>spatial</code></td>
        <td><code>Union[str, gpd.GeoDataFrame, List[float]]</code></td>
        <td><p>Spatial extent for subsetting.
Can be a file path to a shapefile, a GeoDataFrame, or a list of bounding box coordinates [minx, miny, maxx, maxy].
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>Start date for subsetting in 'YYYY-MM-DD' format.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>End date for subsetting in 'YYYY-MM-DD' format.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>Output directory to save the subsetted files.
Defaults to None, which will use the current working directory.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>collection</code></td>
        <td><code>Collection</code></td>
        <td><p>GEDI data collection. If not provided,
the default collection with DOI '10.3334/ORNLDAAC/2056' will be used.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>variables</code></td>
        <td><code>List[str]</code></td>
        <td><p>List of variable names to subset.
Defaults to ['all'], which subsets all available variables.</p></td>
        <td><code>[&#39;all&#39;]</code></td>
      </tr>
      <tr>
        <td><code>max_results</code></td>
        <td><code>int</code></td>
        <td><p>Maximum number of results to return.
Defaults to None, which returns all results.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>username</code></td>
        <td><code>str</code></td>
        <td><p>Earthdata username.
Defaults to None, which will attempt to read from the 'EARTHDATA_USERNAME' environment variable.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>password</code></td>
        <td><code>str</code></td>
        <td><p>Earthdata password.
Defaults to None, which will attempt to read from the 'EARTHDATA_PASSWORD' environment variable.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite existing files in the output directory.
Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to the Harmony API request.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the 'harmony' package is not installed.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the 'spatial', 'start_date', or 'end_date' arguments are not valid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>This function does not return any value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gedi_subset</span><span class="p">(</span>
    <span class="n">spatial</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">collection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">],</span>
    <span class="n">max_results</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subsets GEDI data using the Harmony API.</span>

<span class="sd">    Args:</span>
<span class="sd">        spatial (Union[str, gpd.GeoDataFrame, List[float]], optional): Spatial extent for subsetting.</span>
<span class="sd">            Can be a file path to a shapefile, a GeoDataFrame, or a list of bounding box coordinates [minx, miny, maxx, maxy].</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        start_date (str, optional): Start date for subsetting in &#39;YYYY-MM-DD&#39; format.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        end_date (str, optional): End date for subsetting in &#39;YYYY-MM-DD&#39; format.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        out_dir (str, optional): Output directory to save the subsetted files.</span>
<span class="sd">            Defaults to None, which will use the current working directory.</span>
<span class="sd">        collection (Collection, optional): GEDI data collection. If not provided,</span>
<span class="sd">            the default collection with DOI &#39;10.3334/ORNLDAAC/2056&#39; will be used.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        variables (List[str], optional): List of variable names to subset.</span>
<span class="sd">            Defaults to [&#39;all&#39;], which subsets all available variables.</span>
<span class="sd">        max_results (int, optional): Maximum number of results to return.</span>
<span class="sd">            Defaults to None, which returns all results.</span>
<span class="sd">        username (str, optional): Earthdata username.</span>
<span class="sd">            Defaults to None, which will attempt to read from the &#39;EARTHDATA_USERNAME&#39; environment variable.</span>
<span class="sd">        password (str, optional): Earthdata password.</span>
<span class="sd">            Defaults to None, which will attempt to read from the &#39;EARTHDATA_PASSWORD&#39; environment variable.</span>
<span class="sd">        overwrite (bool, optional): Whether to overwrite existing files in the output directory.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the Harmony API request.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the &#39;harmony&#39; package is not installed.</span>
<span class="sd">        ValueError: If the &#39;spatial&#39;, &#39;start_date&#39;, or &#39;end_date&#39; arguments are not valid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: This function does not return any value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">harmony</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">install_package</span><span class="p">(</span><span class="s2">&quot;harmony-py&quot;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="nn">re</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
    <span class="kn">from</span> <span class="nn">harmony</span> <span class="kn">import</span> <span class="n">BBox</span><span class="p">,</span> <span class="n">Client</span><span class="p">,</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">Request</span>

    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">collection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># GEDI L4A DOI</span>
        <span class="n">doi</span> <span class="o">=</span> <span class="s2">&quot;10.3334/ORNLDAAC/2056&quot;</span>

        <span class="c1"># CMR API base url</span>
        <span class="n">doisearch</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://cmr.earthdata.nasa.gov/search/collections.json?doi=</span><span class="si">{</span><span class="n">doi</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">concept_id</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">doisearch</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;feed&quot;</span><span class="p">][</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">concept_id</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">concept_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EARTHDATA_USERNAME&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EARTHDATA_PASSWORD&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;username and password must be provided.&quot;</span><span class="p">)</span>

    <span class="n">harmony_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spatial</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">spatial</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">spatial</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spatial</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">spatial</span> <span class="o">=</span> <span class="n">spatial</span><span class="o">.</span><span class="n">total_bounds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spatial</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">spatial</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">bounding_box</span> <span class="o">=</span> <span class="n">BBox</span><span class="p">(</span><span class="n">spatial</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">spatial</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">spatial</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">spatial</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;spatial must be a list of bounding box coordinates or a GeoDataFrame, or a file path.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">start_date</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;start_date and end_date must be provided.&quot;</span><span class="p">)</span>
        <span class="n">temporal_range</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temporal_range</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">end_date</span><span class="p">}</span>

    <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span>
        <span class="n">collection</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span>
        <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span>
        <span class="n">temporal</span><span class="o">=</span><span class="n">temporal_range</span><span class="p">,</span>
        <span class="n">spatial</span><span class="o">=</span><span class="n">bounding_box</span><span class="p">,</span>
        <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># submit harmony request, will return job id</span>
    <span class="n">subset_job_id</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing job: </span><span class="si">{</span><span class="n">subset_job_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Waiting for the job to finish&quot;</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">result_json</span><span class="p">(</span><span class="n">subset_job_id</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading subset files...&quot;</span><span class="p">)</span>
    <span class="n">futures</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">download_all</span><span class="p">(</span>
        <span class="n">subset_job_id</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">:</span>
        <span class="c1"># all subsetted files have this suffix</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;subsetted.h5&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done downloading files.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_bounds</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Calculate the bounds of a GeoJSON object.</p>
<p>This function uses the shapely library to calculate the bounds of a GeoJSON object.
If the shapely library is not installed, it will print a message and return None.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>geojson</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary representing a GeoJSON object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of bounds (minx, miny, maxx, maxy) if shapely is installed, None otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_bounds</span><span class="p">(</span><span class="n">geojson</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the bounds of a GeoJSON object.</span>

<span class="sd">    This function uses the shapely library to calculate the bounds of a GeoJSON object.</span>
<span class="sd">    If the shapely library is not installed, it will print a message and return None.</span>

<span class="sd">    Args:</span>
<span class="sd">        geojson (dict): A dictionary representing a GeoJSON object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of bounds (minx, miny, maxx, maxy) if shapely is installed, None otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">shapely</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shapely is not installed&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">geojson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">shapely</span><span class="o">.</span><span class="n">bounds</span><span class="p">(</span><span class="n">shapely</span><span class="o">.</span><span class="n">from_geojson</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">geojson</span><span class="p">))))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_to_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_to_df</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">drop_geometry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_to_df" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoJSON object to a pandas DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The input GeoJSON file or dict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoJSON object. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
      <tr>
        <td><code>drop_geometry</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to drop the geometry column. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the input GeoJSON file could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>A pandas DataFrame containing the GeoJSON object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_to_df</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">drop_geometry</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoJSON object to a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The input GeoJSON file or dict.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoJSON object. Defaults to &quot;utf-8&quot;.</span>
<span class="sd">        drop_geometry (bool, optional): Whether to drop the geometry column. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the input GeoJSON file could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A pandas DataFrame containing the GeoJSON object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">in_geojson</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided GeoJSON file could not be found.&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">in_geojson</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;properties.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">drop_geometry</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)))]</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_to_gdf</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoJSON object to a geopandas GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The input GeoJSON file or GeoJSON object as a dict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoJSON object. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>geopandas.GeoDataFrame</code></td>
      <td><p>A geopandas GeoDataFrame containing the GeoJSON object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_to_gdf</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoJSON object to a geopandas GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The input GeoJSON file or GeoJSON object as a dict.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoJSON object. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        geopandas.GeoDataFrame: A geopandas GeoDataFrame containing the GeoJSON object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">out_file</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s2">&quot;geojson&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">out_file</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_to_gpkg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_to_gpkg</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">out_gpkg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_to_gpkg" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoJSON object to GeoPackage.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The input GeoJSON file or dict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gpkg</code></td>
        <td><code>str</code></td>
        <td><p>The output GeoPackage path.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_to_gpkg</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">out_gpkg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoJSON object to GeoPackage.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The input GeoJSON file or dict.</span>
<span class="sd">        out_gpkg (str): The output GeoPackage path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">json</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_gpkg</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;.gpkg&quot;</span><span class="p">:</span>
        <span class="n">out_gpkg</span> <span class="o">=</span> <span class="n">out_gpkg</span> <span class="o">+</span> <span class="s2">&quot;.gpkg&quot;</span>
    <span class="n">out_gpkg</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_gpkg</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">out_file</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s2">&quot;geojson&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">out_file</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_gpkg</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">out_gpkg</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GPKG&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_to_mbtiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_to_mbtiles</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_to_mbtiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts vector data to .mbtiles using Tippecanoe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the input vector data file (e.g., .geojson).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output .mbtiles file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Optional name for the layer. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>options</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>List of additional arguments for tippecanoe. For example '-zg' for auto maxzoom. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>If True, suppress the log output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>Output from the Tippecanoe command, or None if there was an error or if Tippecanoe is not installed.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>subprocess.CalledProcessError</code></td>
        <td><p>If there's an error executing the tippecanoe command.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_to_mbtiles</span><span class="p">(</span>
    <span class="n">input_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts vector data to .mbtiles using Tippecanoe.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (str): Path to the input vector data file (e.g., .geojson).</span>
<span class="sd">        output_file (str): Path to the output .mbtiles file.</span>
<span class="sd">        layer_name (Optional[str]): Optional name for the layer. Defaults to None.</span>
<span class="sd">        options (Optional[List[str]]): List of additional arguments for tippecanoe. For example &#39;-zg&#39; for auto maxzoom. Defaults to None.</span>
<span class="sd">        quiet (bool): If True, suppress the log output. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: Output from the Tippecanoe command, or None if there was an error or if Tippecanoe is not installed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        subprocess.CalledProcessError: If there&#39;s an error executing the tippecanoe command.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">subprocess</span>
    <span class="kn">import</span> <span class="nn">shutil</span>

    <span class="c1"># Check if tippecanoe exists</span>
    <span class="k">if</span> <span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;tippecanoe&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: tippecanoe is not installed.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You can install it using conda with the following command:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;conda install -c conda-forge tippecanoe&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tippecanoe&quot;</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">output_file</span><span class="p">]</span>

    <span class="c1"># Add layer name specification if provided</span>
    <span class="k">if</span> <span class="n">layer_name</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-L&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>

    <span class="c1"># Append additional arguments if provided</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">exit_code</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">exit_code</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">(</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error executing tippecanoe: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="s2">&quot;Tippecanoe process completed successfully.&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_to_pmtiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_to_pmtiles</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_to_pmtiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts vector data to PMTiles using Tippecanoe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the input vector data file (e.g., .geojson).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output .mbtiles file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Optional name for the layer. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>projection</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Projection for the output PMTiles file. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>If True, overwrite the existing output file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>options</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>List of additional arguments for tippecanoe. Defaults to None.
To reduce the size of the output file, use '-zg' or '-z max-zoom'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>If True, suppress the log output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>Output from the Tippecanoe command, or None if there was an error or if Tippecanoe is not installed.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>subprocess.CalledProcessError</code></td>
        <td><p>If there's an error executing the tippecanoe command.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_to_pmtiles</span><span class="p">(</span>
    <span class="n">input_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">projection</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts vector data to PMTiles using Tippecanoe.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (str): Path to the input vector data file (e.g., .geojson).</span>
<span class="sd">        output_file (str): Path to the output .mbtiles file.</span>
<span class="sd">        layer_name (Optional[str]): Optional name for the layer. Defaults to None.</span>
<span class="sd">        projection (Optional[str]): Projection for the output PMTiles file. Defaults to &quot;EPSG:4326&quot;.</span>
<span class="sd">        overwrite (bool): If True, overwrite the existing output file. Defaults to False.</span>
<span class="sd">        options (Optional[List[str]]): List of additional arguments for tippecanoe. Defaults to None.</span>
<span class="sd">            To reduce the size of the output file, use &#39;-zg&#39; or &#39;-z max-zoom&#39;.</span>
<span class="sd">        quiet (bool): If True, suppress the log output. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: Output from the Tippecanoe command, or None if there was an error or if Tippecanoe is not installed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        subprocess.CalledProcessError: If there&#39;s an error executing the tippecanoe command.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">subprocess</span>
    <span class="kn">import</span> <span class="nn">shutil</span>

    <span class="c1"># Check if tippecanoe exists</span>
    <span class="k">if</span> <span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;tippecanoe&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: tippecanoe is not installed.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You can install it using conda with the following command:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;conda install -c conda-forge tippecanoe&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">input_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.pmtiles&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">output_file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pmtiles&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: output file must be a .pmtiles file.&quot;</span><span class="p">)</span>

    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tippecanoe&quot;</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">output_file</span><span class="p">]</span>

    <span class="c1"># Add layer name specification if provided</span>
    <span class="k">if</span> <span class="n">layer_name</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-L&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>

    <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--projection&quot;</span><span class="p">,</span> <span class="n">projection</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;--force&quot;</span><span class="p">)</span>

    <span class="c1"># Append additional arguments if provided</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">exit_code</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">exit_code</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">(</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error executing tippecanoe: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="s2">&quot;Tippecanoe process completed successfully.&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geojson_to_shp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geojson_to_shp</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.geojson_to_shp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoJSON object to GeoPandas GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The input GeoJSON file or dict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_shp</code></td>
        <td><code>str</code></td>
        <td><p>The output shapefile path.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geojson_to_shp</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoJSON object to GeoPandas GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The input GeoJSON file or dict.</span>
<span class="sd">        out_shp (str): The output shapefile path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">json</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s2">&quot;.shp&quot;</span><span class="p">:</span>
        <span class="n">out_shp</span> <span class="o">=</span> <span class="n">out_shp</span> <span class="o">+</span> <span class="s2">&quot;.shp&quot;</span>
    <span class="n">out_shp</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">out_file</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s2">&quot;geojson&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">out_file</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geom_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geom_type</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.geom_type" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the geometry type of a GeoJSON object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>dict</code></td>
        <td><p>A GeoJSON object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the GeoJSON object. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The geometry type of the GeoJSON object, such as Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon.
    For more info, see https://shapely.readthedocs.io/en/stable/manual.html</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geom_type</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the geometry type of a GeoJSON object.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (dict): A GeoJSON object.</span>
<span class="sd">        encoding (str, optional): The encoding of the GeoJSON object. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The geometry type of the GeoJSON object, such as Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon.</span>
<span class="sd">            For more info, see https://shapely.readthedocs.io/en/stable/manual.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">in_geojson</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">in_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                        <span class="s2">&quot;The provided GeoJSON file could not be found.&quot;</span>
                    <span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">in_geojson</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The input geojson must be a type of str or dict.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.geometry_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">geometry_bounds</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>


<a href="#leafmap.common.geometry_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the bounds of a geometry.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>geometry</code></td>
        <td><code>dict</code></td>
        <td><p>A GeoJSON geometry.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>decimals</code></td>
        <td><code>int</code></td>
        <td><p>The number of decimal places to round the bounds to. Defaults to 4.</p></td>
        <td><code>4</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of bounds in the form of [minx, miny, maxx, maxy].</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">geometry_bounds</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the bounds of a geometry.</span>

<span class="sd">    Args:</span>
<span class="sd">        geometry (dict): A GeoJSON geometry.</span>
<span class="sd">        decimals (int, optional): The number of decimal places to round the bounds to. Defaults to 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of bounds in the form of [minx, miny, maxx, maxy].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;geometry must be a GeoJSON-like dictionary.&quot;</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
    <span class="n">west</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">decimals</span><span class="p">)</span>
    <span class="n">east</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">decimals</span><span class="p">)</span>
    <span class="n">south</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">decimals</span><span class="p">)</span>
    <span class="n">north</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">decimals</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">north</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_3dep_dem" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_3dep_dem</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="s1">&#39;EPSG:5070&#39;</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_3dep_dem" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get DEM data at any resolution from 3DEP.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>geometry</code></td>
        <td><code>Polygon | MultiPolygon | tuple</code></td>
        <td><p>It can be a polygon or a bounding
box of form (xmin, ymin, xmax, ymax).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>int</code></td>
        <td><p>arget DEM source resolution in meters. Defaults to 30.</p></td>
        <td><code>30</code></td>
      </tr>
      <tr>
        <td><code>src_crs</code></td>
        <td><code>str</code></td>
        <td><p>The spatial reference system of the input geometry. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output GeoTIFF file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The spatial reference system of the output GeoTIFF file. Defaults to "EPSG:5070".</p></td>
        <td><code>&#39;EPSG:5070&#39;</code></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Convert to Cloud Optimized GeoTIFF. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite the output file if it exists. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.DataArray</code></td>
      <td><p>DEM at the specified resolution in meters and CRS.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_3dep_dem</span><span class="p">(</span>
    <span class="n">geometry</span><span class="p">,</span>
    <span class="n">resolution</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">src_crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dst_crs</span><span class="o">=</span><span class="s2">&quot;EPSG:5070&quot;</span><span class="p">,</span>
    <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get DEM data at any resolution from 3DEP.</span>

<span class="sd">    Args:</span>
<span class="sd">        geometry (Polygon | MultiPolygon | tuple): It can be a polygon or a bounding</span>
<span class="sd">            box of form (xmin, ymin, xmax, ymax).</span>
<span class="sd">        resolution (int): arget DEM source resolution in meters. Defaults to 30.</span>
<span class="sd">        src_crs (str, optional): The spatial reference system of the input geometry. Defaults to &quot;EPSG:4326&quot;.</span>
<span class="sd">        output (str, optional): The output GeoTIFF file. Defaults to None.</span>
<span class="sd">        dst_crs (str, optional): The spatial reference system of the output GeoTIFF file. Defaults to &quot;EPSG:5070&quot;.</span>
<span class="sd">        to_cog (bool, optional): Convert to Cloud Optimized GeoTIFF. Defaults to False.</span>
<span class="sd">        overwrite (bool, optional): Whether to overwrite the output file if it exists. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        xarray.DataArray: DEM at the specified resolution in meters and CRS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">py3dep</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;py3dep is not installed. Install it with pip install py3dep&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;geopandas is not installed. Install it with pip install geopandas&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2"> already exists. Set overwrite=True to overwrite it&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">geometry</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span>

    <span class="n">dem</span> <span class="o">=</span> <span class="n">py3dep</span><span class="o">.</span><span class="n">get_dem</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">src_crs</span><span class="p">)</span>
    <span class="n">dem</span> <span class="o">=</span> <span class="n">dem</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;.tif&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">dem</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">to_raster</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">to_cog</span><span class="p">:</span>
            <span class="n">image_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dem</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_api_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_api_key</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.get_api_key" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieves an API key. If a key is provided, it is returned directly. If a
name is provided, the function attempts to retrieve the key from user data
(if running in Google Colab) or from environment variables.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The name of the key to retrieve. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The key to return directly. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>The retrieved key, or None if no key was found.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_api_key</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves an API key. If a key is provided, it is returned directly. If a</span>
<span class="sd">    name is provided, the function attempts to retrieve the key from user data</span>
<span class="sd">    (if running in Google Colab) or from environment variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (Optional[str], optional): The name of the key to retrieve. Defaults to None.</span>
<span class="sd">        key (Optional[str], optional): The key to return directly. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: The retrieved key, or None if no key was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">key</span>
    <span class="k">elif</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_in_colab_shell</span><span class="p">():</span>
            <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">userdata</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">userdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_bounds</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">north_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.get_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Bounding box of a GeoJSON geometry, GeometryCollection, or FeatureCollection.
left, bottom, right, top
<em>not</em> xmin, ymin, xmax, ymax
If not north_up, y will be switched to guarantee the above.
Source code adapted from https://github.com/mapbox/rasterio/blob/master/rasterio/features.py#L361</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>geometry</code></td>
        <td><code>dict</code></td>
        <td><p>A GeoJSON dict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>north_up</code></td>
        <td><code>bool</code></td>
        <td><p>. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>transform</code></td>
        <td><code>[type]</code></td>
        <td><p>. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of coordinates representing [left, bottom, right, top]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_bounds</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">north_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Bounding box of a GeoJSON geometry, GeometryCollection, or FeatureCollection.</span>
<span class="sd">    left, bottom, right, top</span>
<span class="sd">    *not* xmin, ymin, xmax, ymax</span>
<span class="sd">    If not north_up, y will be switched to guarantee the above.</span>
<span class="sd">    Source code adapted from https://github.com/mapbox/rasterio/blob/master/rasterio/features.py#L361</span>

<span class="sd">    Args:</span>
<span class="sd">        geometry (dict): A GeoJSON dict.</span>
<span class="sd">        north_up (bool, optional): . Defaults to True.</span>
<span class="sd">        transform ([type], optional): . Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of coordinates representing [left, bottom, right, top]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;bbox&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">])</span>

    <span class="n">geometry</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">geometry</span>

    <span class="c1"># geometry must be a geometry, GeometryCollection, or FeatureCollection</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="s2">&quot;coordinates&quot;</span> <span class="ow">in</span> <span class="n">geometry</span> <span class="ow">or</span> <span class="s2">&quot;geometries&quot;</span> <span class="ow">in</span> <span class="n">geometry</span> <span class="ow">or</span> <span class="s2">&quot;features&quot;</span> <span class="ow">in</span> <span class="n">geometry</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;geometry must be a GeoJSON-like geometry, GeometryCollection, &quot;</span>
            <span class="s2">&quot;or FeatureCollection&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;features&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
        <span class="c1"># Input is a FeatureCollection</span>
        <span class="n">xmins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ymins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xmaxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ymaxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">get_bounds</span><span class="p">(</span><span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">])</span>
            <span class="n">xmins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
            <span class="n">ymins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ymin</span><span class="p">)</span>
            <span class="n">xmaxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
            <span class="n">ymaxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ymax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">north_up</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmins</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">ymins</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmaxs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmins</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmaxs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">ymins</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s2">&quot;geometries&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
        <span class="c1"># Input is a geometry collection</span>
        <span class="n">xmins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ymins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xmaxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ymaxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">geometry</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;geometries&quot;</span><span class="p">]:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">get_bounds</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
            <span class="n">xmins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
            <span class="n">ymins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ymin</span><span class="p">)</span>
            <span class="n">xmaxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
            <span class="n">ymaxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ymax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">north_up</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmins</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">ymins</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmaxs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmins</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">ymaxs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmaxs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">ymins</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s2">&quot;coordinates&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
        <span class="c1"># Input is a singular geometry object</span>
        <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">explode</span><span class="p">(</span><span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]))</span>
            <span class="n">xyz_px</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span> <span class="o">*</span> <span class="n">point</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">xyz</span><span class="p">]</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">xyz_px</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">min</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">explode</span><span class="p">(</span><span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]))))</span>
            <span class="k">if</span> <span class="n">north_up</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">min</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">min</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># all valid inputs returned above, so whatever falls through is an error</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="s2">&quot;geometry must be a GeoJSON-like geometry, GeometryCollection, &quot;</span>
        <span class="s2">&quot;or FeatureCollection&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_census_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_census_dict</span><span class="p">(</span><span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.get_census_dict" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns a dictionary of Census data.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>reset</code></td>
        <td><code>bool</code></td>
        <td><p>Reset the dictionary. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of Census data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_census_dict</span><span class="p">(</span><span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a dictionary of Census data.</span>

<span class="sd">    Args:</span>
<span class="sd">        reset (bool, optional): Reset the dictionary. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of Census data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">import</span> <span class="nn">pkg_resources</span>

    <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s2">&quot;leafmap&quot;</span><span class="p">,</span> <span class="s2">&quot;leafmap.py&quot;</span><span class="p">))</span>
    <span class="n">census_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">,</span> <span class="s2">&quot;data/census_data.json&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reset</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">owslib.wms</span> <span class="kn">import</span> <span class="n">WebMapService</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Please install owslib using &#39;pip install owslib&#39;.&quot;</span><span class="p">)</span>

        <span class="n">census_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Current&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2021&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2019&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2018&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2016&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2015&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2014&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2013&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACS 2012&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ECON 2012&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Census 2020&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Census 2010&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Physical Features&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Decennial Census 2020&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Decennial Census 2010&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Decennial Census 2000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Decennial Physical Features&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">links</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieving data. Please wait ...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Decennial&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">links</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;https://tigerweb.geo.census.gov/arcgis/services/TIGERweb/tigerWMS_</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/MapServer/WMSServer&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">links</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;https://tigerweb.geo.census.gov/arcgis/services/Census2020/tigerWMS_</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Decennial&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/MapServer/WMSServer&quot;</span>
                <span class="p">)</span>

            <span class="n">wms</span> <span class="o">=</span> <span class="n">WebMapService</span><span class="p">(</span><span class="n">links</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wms</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">census_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">links</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="n">layers</span><span class="p">,</span>
                <span class="c1"># &quot;title&quot;: wms.identification.title,</span>
                <span class="c1"># &quot;abstract&quot;: wms.identification.abstract,</span>
            <span class="p">}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">census_data</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">census_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">census_data</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">census_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">census_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_center" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_center</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">north_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.get_center" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the centroid of a GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>geometry</code></td>
        <td><code>dict</code></td>
        <td><p>A GeoJSON dict.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>north_up</code></td>
        <td><code>bool</code></td>
        <td><p>. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>transform</code></td>
        <td><code>[type]</code></td>
        <td><p>. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>[lon, lat]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_center</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">north_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the centroid of a GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        geometry (dict): A GeoJSON dict.</span>
<span class="sd">        north_up (bool, optional): . Defaults to True.</span>
<span class="sd">        transform ([type], optional): . Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: [lon, lat]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">get_bounds</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">north_up</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="p">((</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># (lat, lon)</span>
    <span class="k">return</span> <span class="n">center</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_direct_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_direct_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


<a href="#leafmap.common.get_direct_url" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the direct URL for a given URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL to get the direct URL for.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The direct URL.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_direct_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the direct URL for a given URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL to get the direct URL for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The direct URL.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url must be a string.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url must start with http.&quot;</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">url</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_gdal_drivers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_gdal_drivers</span><span class="p">()</span></code>


<a href="#leafmap.common.get_gdal_drivers" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get a list of available driver names in the GDAL library.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>A list of available driver names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_gdal_drivers</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of available driver names in the GDAL library.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: A list of available driver names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">ogr</span>

    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Iterate over all registered drivers</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ogr</span><span class="o">.</span><span class="n">GetDriverCount</span><span class="p">()):</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">GetDriver</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">driver_name</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span>
        <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driver_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">driver_list</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_gdal_file_extension" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_gdal_file_extension</span><span class="p">(</span><span class="n">driver_name</span><span class="p">)</span></code>


<a href="#leafmap.common.get_gdal_file_extension" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the file extension corresponding to a driver name in the GDAL library.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>driver_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the driver.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>The file extension corresponding to the driver name, or None if the driver is not found or does not have a specific file extension.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_gdal_file_extension</span><span class="p">(</span><span class="n">driver_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the file extension corresponding to a driver name in the GDAL library.</span>

<span class="sd">    Args:</span>
<span class="sd">        driver_name (str): The name of the driver.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: The file extension corresponding to the driver name, or None if the driver is not found or does not have a specific file extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">ogr</span>

    <span class="n">driver</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="n">driver_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">driver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">drivers</span> <span class="o">=</span> <span class="n">get_gdal_drivers</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Driver </span><span class="si">{</span><span class="n">driver_name</span><span class="si">}</span><span class="s2"> not found. Available drivers: </span><span class="si">{</span><span class="n">drivers</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">GetMetadata</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;DMD_EXTENSION&quot;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
        <span class="n">file_extension</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">GetMetadataItem</span><span class="p">(</span><span class="s2">&quot;DMD_EXTENSION&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">file_extensions</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">GetMetadataItem</span><span class="p">(</span><span class="s2">&quot;DMD_EXTENSIONS&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_extensions</span> <span class="o">==</span> <span class="s2">&quot;json geojson&quot;</span><span class="p">:</span>
            <span class="n">file_extension</span> <span class="o">=</span> <span class="s2">&quot;geojson&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_extension</span> <span class="o">=</span> <span class="n">file_extensions</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">file_extension</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_geometry_coords" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_geometry_coords</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">coord_type</span><span class="p">,</span> <span class="n">shape_type</span><span class="p">,</span> <span class="n">mercator</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.get_geometry_coords" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the coordinates ('x' or 'y') of edges of a Polygon exterior.</p>
<p>:param: (GeoPandas Series) row : The row of each of the GeoPandas DataFrame.
:param: (str) geom : The column name.
:param: (str) coord_type : Whether it's 'x' or 'y' coordinate.
:param: (str) shape_type</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_geometry_coords</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">coord_type</span><span class="p">,</span> <span class="n">shape_type</span><span class="p">,</span> <span class="n">mercator</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the coordinates (&#39;x&#39; or &#39;y&#39;) of edges of a Polygon exterior.</span>

<span class="sd">    :param: (GeoPandas Series) row : The row of each of the GeoPandas DataFrame.</span>
<span class="sd">    :param: (str) geom : The column name.</span>
<span class="sd">    :param: (str) coord_type : Whether it&#39;s &#39;x&#39; or &#39;y&#39; coordinate.</span>
<span class="sd">    :param: (str) shape_type</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Parse the exterior of the coordinate</span>
    <span class="k">if</span> <span class="n">shape_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;polygon&quot;</span><span class="p">,</span> <span class="s2">&quot;multipolygon&quot;</span><span class="p">]:</span>
        <span class="n">exterior</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">geom</span><span class="p">]</span><span class="o">.</span><span class="n">geoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">exterior</span>
        <span class="k">if</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="c1"># Get the x coordinates of the exterior</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mercator</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">coords</span>

        <span class="k">elif</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="c1"># Get the y coordinates of the exterior</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mercator</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">lnglat_to_meters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">coords</span>

    <span class="k">elif</span> <span class="n">shape_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;linestring&quot;</span><span class="p">,</span> <span class="s2">&quot;multilinestring&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">geom</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mercator</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">coords</span>
        <span class="k">elif</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">geom</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mercator</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">lnglat_to_meters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">coords</span>

    <span class="k">elif</span> <span class="n">shape_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="s2">&quot;multipoint&quot;</span><span class="p">]:</span>
        <span class="n">exterior</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">geom</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="c1"># Get the x coordinates of the exterior</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mercator</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">coords</span>

        <span class="k">elif</span> <span class="n">coord_type</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="c1"># Get the y coordinates of the exterior</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mercator</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="n">lnglat_to_meters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">coords</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">coords</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_geometry_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_geometry_type</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">)</span></code>


<a href="#leafmap.common.get_geometry_type" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the geometry type of a GeoJSON file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_geojson</code></td>
        <td><code>str | dict</code></td>
        <td><p>The path to the GeoJSON file or a GeoJSON dictionary.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The geometry type. Can be one of "Point", "LineString", "Polygon", "MultiPoint",
    "MultiLineString", "MultiPolygon", "GeometryCollection", or "Unknown".</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_geometry_type</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the geometry type of a GeoJSON file.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_geojson (str | dict): The path to the GeoJSON file or a GeoJSON dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The geometry type. Can be one of &quot;Point&quot;, &quot;LineString&quot;, &quot;Polygon&quot;, &quot;MultiPoint&quot;,</span>
<span class="sd">            &quot;MultiLineString&quot;, &quot;MultiPolygon&quot;, &quot;GeometryCollection&quot;, or &quot;Unknown&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">geojson</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  <span class="c1"># If input is a file path</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">geojson_file</span><span class="p">:</span>
                <span class="n">geojson_data</span> <span class="o">=</span> <span class="n">geojson</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">geojson_file</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_geojson</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>  <span class="c1"># If input is a GeoJSON dictionary</span>
            <span class="n">geojson_data</span> <span class="o">=</span> <span class="n">in_geojson</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Invalid input type. Expected file path or dictionary.&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">geojson_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">geojson_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">:</span>
                <span class="n">features</span> <span class="o">=</span> <span class="n">geojson_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="k">if</span> <span class="n">features</span><span class="p">:</span>
                    <span class="n">first_feature</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">geometry</span> <span class="o">=</span> <span class="n">first_feature</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">geometry</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s2">&quot;No geometry type found in the first feature.&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;No features found in the FeatureCollection.&quot;</span>
            <span class="k">elif</span> <span class="n">geojson_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Feature&quot;</span><span class="p">:</span>
                <span class="n">geometry</span> <span class="o">=</span> <span class="n">geojson_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">geometry</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">geometry</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">geometry</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;No geometry type found in the Feature.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;Unsupported GeoJSON type.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;No &#39;type&#39; field found in the GeoJSON data.&quot;</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_google_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_google_map</span><span class="p">(</span><span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;HYBRID&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_google_map" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Gets Google basemap tile layer.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>map_type</code></td>
        <td><code>str</code></td>
        <td><p>Can be one of "ROADMAP", "SATELLITE", "HYBRID" or "TERRAIN". Defaults to 'HYBRID'.</p></td>
        <td><code>&#39;HYBRID&#39;</code></td>
      </tr>
      <tr>
        <td><code>show</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add the layer to the map. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Google Maps API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional arguments to pass to ipyleaflet.TileLayer().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_google_map</span><span class="p">(</span>
    <span class="n">map_type</span><span class="o">=</span><span class="s2">&quot;HYBRID&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets Google basemap tile layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        map_type (str, optional): Can be one of &quot;ROADMAP&quot;, &quot;SATELLITE&quot;, &quot;HYBRID&quot; or &quot;TERRAIN&quot;. Defaults to &#39;HYBRID&#39;.</span>
<span class="sd">        show (bool, optional): Whether to add the layer to the map. Defaults to True.</span>
<span class="sd">        api_key (str, optional): The Google Maps API key. Defaults to None.</span>
<span class="sd">        **kwargs: Additional arguments to pass to ipyleaflet.TileLayer().</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">allow_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ROADMAP&quot;</span><span class="p">,</span> <span class="s2">&quot;SATELLITE&quot;</span><span class="p">,</span> <span class="s2">&quot;HYBRID&quot;</span><span class="p">,</span> <span class="s2">&quot;TERRAIN&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">map_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allow_types</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;map_type must be one of the following: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">allow_types</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GOOGLE_MAPS_API_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR-API-KEY&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">MAP_TILES</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ROADMAP&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri.WorldStreetMap&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;SATELLITE&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;TERRAIN&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri.WorldTopoMap&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;HYBRID&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Google Maps API key is required to use Google Maps. You can generate one from https://bit.ly/3sw0THG and use geemap.set_api_key(), defaulting to Esri basemaps.&quot;</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">MAP_TILES</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ROADMAP&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://mt1.google.com/vt/lyrs=m&amp;x=</span><span class="se">{{</span><span class="s2">x</span><span class="se">}}</span><span class="s2">&amp;y=</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}</span><span class="s2">&amp;z=</span><span class="se">{{</span><span class="s2">z</span><span class="se">}}</span><span class="s2">&amp;key=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Maps&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;SATELLITE&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://mt1.google.com/vt/lyrs=s&amp;x=</span><span class="se">{{</span><span class="s2">x</span><span class="se">}}</span><span class="s2">&amp;y=</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}</span><span class="s2">&amp;z=</span><span class="se">{{</span><span class="s2">z</span><span class="se">}}</span><span class="s2">&amp;key=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Satellite&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;TERRAIN&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://mt1.google.com/vt/lyrs=p&amp;x=</span><span class="se">{{</span><span class="s2">x</span><span class="se">}}</span><span class="s2">&amp;y=</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}</span><span class="s2">&amp;z=</span><span class="se">{{</span><span class="s2">z</span><span class="se">}}</span><span class="s2">&amp;key=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Terrain&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;HYBRID&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://mt1.google.com/vt/lyrs=y&amp;x=</span><span class="se">{{</span><span class="s2">x</span><span class="se">}}</span><span class="s2">&amp;y=</span><span class="se">{{</span><span class="s2">y</span><span class="se">}}</span><span class="s2">&amp;z=</span><span class="se">{{</span><span class="s2">z</span><span class="se">}}</span><span class="s2">&amp;key=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Hybrid&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span>

    <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">ipyleaflet</span>

        <span class="n">layer</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">MAP_TILES</span><span class="p">[</span><span class="n">map_type</span><span class="p">][</span><span class="s2">&quot;url&quot;</span><span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">MAP_TILES</span><span class="p">[</span><span class="n">map_type</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="n">attribution</span><span class="o">=</span><span class="n">MAP_TILES</span><span class="p">[</span><span class="n">map_type</span><span class="p">][</span><span class="s2">&quot;attribution&quot;</span><span class="p">],</span>
            <span class="n">visible</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;folium&quot;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">folium</span>

        <span class="n">layer</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
            <span class="n">tiles</span><span class="o">=</span><span class="n">MAP_TILES</span><span class="p">[</span><span class="n">map_type</span><span class="p">][</span><span class="s2">&quot;url&quot;</span><span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="n">MAP_TILES</span><span class="p">[</span><span class="n">map_type</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">MAP_TILES</span><span class="p">[</span><span class="n">map_type</span><span class="p">][</span><span class="s2">&quot;attribution&quot;</span><span class="p">],</span>
            <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;backend must be either &#39;ipyleaflet&#39; or &#39;folium&#39;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">layer</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_local_tile_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indexes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;Local COG&#39;</span><span class="p">,</span> <span class="n">client_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cors_all&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_local_tile_layer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generate an ipyleaflet/folium TileLayer from a local raster dataset or remote Cloud Optimized GeoTIFF (COG).
    If you are using this function in JupyterHub on a remote server and the raster does not render properly, try
    running the following two lines before calling this function:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>import os
os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;
</code></pre></div></td></tr></table></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>str</code></td>
        <td><p>The port to use for the server. Defaults to "default".</p></td>
        <td><code>&#39;default&#39;</code></td>
      </tr>
      <tr>
        <td><code>debug</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the server will be started in debug mode. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>indexes</code></td>
        <td><code>int</code></td>
        <td><p>The band(s) to use. Band indexing starts at 1. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>colormap</code></td>
        <td><code>str</code></td>
        <td><p>The name of the colormap from <code>matplotlib</code> to use when plotting a single band. See https://matplotlib.org/stable/gallery/color/colormap_reference.html. Default is greyscale.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to use when colormapping the colormap when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to use when colormapping the colormap when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>The value from the band to use to interpret as not valid data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The tile layer format. Can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to None.</p></td>
        <td><code>&#39;Local COG&#39;</code></td>
      </tr>
      <tr>
        <td><code>client_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to the TileClient. Defaults to {}.</p></td>
        <td><code>{&#39;cors_all&#39;: False}</code></td>
      </tr>
      <tr>
        <td><code>return_client</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the tile client will be returned. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the error messages will be suppressed. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ipyleaflet.TileLayer | folium.TileLayer</code></td>
      <td><p>An ipyleaflet.TileLayer or folium.TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_local_tile_layer</span><span class="p">(</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">indexes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;Local COG&quot;</span><span class="p">,</span>
    <span class="n">client_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cors_all&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">return_client</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an ipyleaflet/folium TileLayer from a local raster dataset or remote Cloud Optimized GeoTIFF (COG).</span>
<span class="sd">        If you are using this function in JupyterHub on a remote server and the raster does not render properly, try</span>
<span class="sd">        running the following two lines before calling this function:</span>

<span class="sd">        import os</span>
<span class="sd">        os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = &#39;proxy/{port}&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</span>
<span class="sd">        port (str, optional): The port to use for the server. Defaults to &quot;default&quot;.</span>
<span class="sd">        debug (bool, optional): If True, the server will be started in debug mode. Defaults to False.</span>
<span class="sd">        indexes (int, optional): The band(s) to use. Band indexing starts at 1. Defaults to None.</span>
<span class="sd">        colormap (str, optional): The name of the colormap from `matplotlib` to use when plotting a single band. See https://matplotlib.org/stable/gallery/color/colormap_reference.html. Default is greyscale.</span>
<span class="sd">        vmin (float, optional): The minimum value to use when colormapping the colormap when plotting a single band. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to use when colormapping the colormap when plotting a single band. Defaults to None.</span>
<span class="sd">        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">        attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">        tile_format (str, optional): The tile layer format. Can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">        client_args (dict, optional): Additional arguments to pass to the TileClient. Defaults to {}.</span>
<span class="sd">        return_client (bool, optional): If True, the tile client will be returned. Defaults to False.</span>
<span class="sd">        quiet (bool, optional): If True, the error messages will be suppressed. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ipyleaflet.TileLayer | folium.TileLayer: An ipyleaflet.TileLayer or folium.TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>

    <span class="n">check_package</span><span class="p">(</span>
        <span class="s2">&quot;localtileserver&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://github.com/banesullivan/localtileserver&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Handle legacy localtileserver kwargs</span>
    <span class="k">if</span> <span class="s2">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;`cmap` is a deprecated keyword argument for get_local_tile_layer. Please use `colormap`.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;palette&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;`palette` is a deprecated keyword argument for get_local_tile_layer. Please use `colormap`.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;band&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;bands&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;`band` and `bands` are deprecated keyword arguments for get_local_tile_layer. Please use `indexes`.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;projection&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;`projection` is a deprecated keyword argument for get_local_tile_layer and will be ignored.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;style&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;`style` is a deprecated keyword argument for get_local_tile_layer and will be ignored.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;max_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">if</span> <span class="s2">&quot;max_native_zoom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;max_native_zoom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">if</span> <span class="s2">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;palette&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;palette&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;band&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;bands&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bands&quot;</span><span class="p">)</span>

    <span class="c1"># Make it compatible with binder and JupyterHub</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;JUPYTERHUB_SERVICE_PREFIX&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LOCALTILESERVER_CLIENT_PREFIX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;JUPYTERHUB_SERVICE_PREFIX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/proxy/</span><span class="se">{{</span><span class="s2">port</span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">is_studio_lab</span><span class="p">():</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LOCALTILESERVER_CLIENT_PREFIX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;studiolab/default/jupyter/proxy/</span><span class="se">{{</span><span class="s2">port</span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_on_aws</span><span class="p">():</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LOCALTILESERVER_CLIENT_PREFIX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;proxy/</span><span class="si">{port}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="s2">&quot;prefix&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;LOCALTILESERVER_CLIENT_PREFIX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">localtileserver</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">get_leaflet_tile_layer</span><span class="p">,</span>
        <span class="n">get_folium_tile_layer</span><span class="p">,</span>
        <span class="n">TileClient</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># if &quot;show_loading&quot; not in kwargs:</span>
    <span class="c1">#     kwargs[&quot;show_loading&quot;] = False</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">):</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="c1"># else:</span>
            <span class="c1">#     source = os.path.abspath(source)</span>
            <span class="c1"># if not os.path.exists(source):</span>
            <span class="c1">#     raise ValueError(&quot;The source path does not exist.&quot;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">TileClient</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">source</span><span class="p">,</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">DatasetReader</span>
    <span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The source must either be a string or TileClient&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">layer_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="s2">&quot;RemoteTile_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="s2">&quot;LocalTile_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">DatasetReader</span><span class="p">):</span>
        <span class="n">tile_client</span> <span class="o">=</span> <span class="n">TileClient</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span> <span class="o">**</span><span class="n">client_args</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tile_client</span> <span class="o">=</span> <span class="n">source</span>

    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
                <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">get_leaflet_tile_layer</span><span class="p">(</span>
                    <span class="n">tile_client</span><span class="p">,</span>
                    <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                    <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
                    <span class="n">indexes</span><span class="o">=</span><span class="n">indexes</span><span class="p">,</span>
                    <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                    <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
                    <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">get_folium_tile_layer</span><span class="p">(</span>
                    <span class="n">tile_client</span><span class="p">,</span>
                    <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                    <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
                    <span class="n">indexes</span><span class="o">=</span><span class="n">indexes</span><span class="p">,</span>
                    <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                    <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
                    <span class="n">attr</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                    <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
            <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">get_leaflet_tile_layer</span><span class="p">(</span>
                <span class="n">tile_client</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
                <span class="n">indexes</span><span class="o">=</span><span class="n">indexes</span><span class="p">,</span>
                <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
                <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">get_folium_tile_layer</span><span class="p">(</span>
                <span class="n">tile_client</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
                <span class="n">indexes</span><span class="o">=</span><span class="n">indexes</span><span class="p">,</span>
                <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
                <span class="n">attr</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
                <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">return_client</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tile_layer</span><span class="p">,</span> <span class="n">tile_client</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tile_layer</span>

    <span class="c1"># center = tile_client.center()</span>
    <span class="c1"># bounds = tile_client.bounds()  # [ymin, ymax, xmin, xmax]</span>
    <span class="c1"># bounds = (bounds[2], bounds[0], bounds[3], bounds[1])  # [minx, miny, maxx, maxy]</span>

    <span class="c1"># if get_center and get_bounds:</span>
    <span class="c1">#     return tile_layer, center, bounds</span>
    <span class="c1"># elif get_center:</span>
    <span class="c1">#     return tile_layer, center</span>
    <span class="c1"># elif get_bounds:</span>
    <span class="c1">#     return tile_layer, bounds</span>
    <span class="c1"># else:</span>
    <span class="c1">#     return tile_layer</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_nhd_basins" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nhd_basins</span><span class="p">(</span><span class="n">feature_ids</span><span class="p">,</span> <span class="n">fsource</span><span class="o">=</span><span class="s1">&#39;nwissite&#39;</span><span class="p">,</span> <span class="n">split_catchment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">simplified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_nhd_basins" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get NHD basins for a list of station IDs.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>feature_ids</code></td>
        <td><code>str | list</code></td>
        <td><p>Target feature ID(s).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fsource</code></td>
        <td><code>str</code></td>
        <td><p>The name of feature(s) source, defaults to <code>nwissite</code>.
The valid sources are:
* 'comid' for NHDPlus comid.
* 'ca_gages' for Streamgage catalog for CA SB19
* 'gfv11_pois' for USGS Geospatial Fabric V1.1 Points of Interest
* 'huc12pp' for HUC12 Pour Points
* 'nmwdi-st' for New Mexico Water Data Initiative Sites
* 'nwisgw' for NWIS Groundwater Sites
* 'nwissite' for NWIS Surface Water Sites
* 'ref_gage' for geoconnex.us reference gauges
* 'vigil' for Vigil Network Data
* 'wade' for Water Data Exchange 2.0 Sites
* 'WQP' for Water Quality Portal</p></td>
        <td><code>&#39;nwissite&#39;</code></td>
      </tr>
      <tr>
        <td><code>split_catchment</code></td>
        <td><code>bool</code></td>
        <td><p>If True, split basins at their outlet locations</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>simplified</code></td>
        <td><code>bool</code></td>
        <td><p>If True, return a simplified version of basin geometries.
Default to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If pynhd is not installed.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>geopandas.GeoDataFrame</code></td>
      <td><p>NLDI indexed basins in EPSG:4326. If some IDs don't return any features
    a list of missing ID(s) are returned as well.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_nhd_basins</span><span class="p">(</span>
    <span class="n">feature_ids</span><span class="p">,</span>
    <span class="n">fsource</span><span class="o">=</span><span class="s2">&quot;nwissite&quot;</span><span class="p">,</span>
    <span class="n">split_catchment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">simplified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get NHD basins for a list of station IDs.</span>

<span class="sd">    Args:</span>
<span class="sd">        feature_ids (str | list): Target feature ID(s).</span>
<span class="sd">        fsource (str, optional): The name of feature(s) source, defaults to ``nwissite``.</span>
<span class="sd">            The valid sources are:</span>
<span class="sd">            * &#39;comid&#39; for NHDPlus comid.</span>
<span class="sd">            * &#39;ca_gages&#39; for Streamgage catalog for CA SB19</span>
<span class="sd">            * &#39;gfv11_pois&#39; for USGS Geospatial Fabric V1.1 Points of Interest</span>
<span class="sd">            * &#39;huc12pp&#39; for HUC12 Pour Points</span>
<span class="sd">            * &#39;nmwdi-st&#39; for New Mexico Water Data Initiative Sites</span>
<span class="sd">            * &#39;nwisgw&#39; for NWIS Groundwater Sites</span>
<span class="sd">            * &#39;nwissite&#39; for NWIS Surface Water Sites</span>
<span class="sd">            * &#39;ref_gage&#39; for geoconnex.us reference gauges</span>
<span class="sd">            * &#39;vigil&#39; for Vigil Network Data</span>
<span class="sd">            * &#39;wade&#39; for Water Data Exchange 2.0 Sites</span>
<span class="sd">            * &#39;WQP&#39; for Water Quality Portal</span>
<span class="sd">        split_catchment (bool, optional): If True, split basins at their outlet locations</span>
<span class="sd">        simplified (bool, optional): If True, return a simplified version of basin geometries.</span>
<span class="sd">            Default to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If pynhd is not installed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        geopandas.GeoDataFrame: NLDI indexed basins in EPSG:4326. If some IDs don&#39;t return any features</span>
<span class="sd">            a list of missing ID(s) are returned as well.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">pynhd</span> <span class="kn">import</span> <span class="n">NLDI</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;pynhd is not installed. Install it with pip install pynhd&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">NLDI</span><span class="p">()</span><span class="o">.</span><span class="n">get_basins</span><span class="p">(</span>
        <span class="n">feature_ids</span><span class="p">,</span> <span class="n">fsource</span><span class="p">,</span> <span class="n">split_catchment</span><span class="p">,</span> <span class="n">simplified</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_overlap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_overlap</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">out_img1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_img2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.get_overlap" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get overlapping area of two images.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img1</code></td>
        <td><code>str</code></td>
        <td><p>Path to the first image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>img2</code></td>
        <td><code>str</code></td>
        <td><p>Path to the second image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>overlap</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output overlap area in GeoJSON format.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_img1</code></td>
        <td><code>str</code></td>
        <td><p>Path to the cropped image of the first image.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_img2</code></td>
        <td><code>str</code></td>
        <td><p>Path to the cropped image of the second image.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the output images to COG.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the overlap area in GeoJSON format.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_overlap</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">out_img1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_img2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get overlapping area of two images.</span>

<span class="sd">    Args:</span>
<span class="sd">        img1 (str): Path to the first image.</span>
<span class="sd">        img2 (str): Path to the second image.</span>
<span class="sd">        overlap (str): Path to the output overlap area in GeoJSON format.</span>
<span class="sd">        out_img1 (str, optional): Path to the cropped image of the first image.</span>
<span class="sd">        out_img2 (str, optional): Path to the cropped image of the second image.</span>
<span class="sd">        to_cog (bool, optional): Whether to convert the output images to COG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the overlap area in GeoJSON format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span><span class="p">,</span> <span class="n">ogr</span><span class="p">,</span> <span class="n">osr</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="n">extent</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)[</span><span class="s2">&quot;wgs84Extent&quot;</span><span class="p">]</span>
    <span class="n">poly1</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">CreateGeometryFromJson</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">extent</span><span class="p">))</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)[</span><span class="s2">&quot;wgs84Extent&quot;</span><span class="p">]</span>
    <span class="n">poly2</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">CreateGeometryFromJson</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">extent</span><span class="p">))</span>
    <span class="n">intersection</span> <span class="o">=</span> <span class="n">poly1</span><span class="o">.</span><span class="n">Intersection</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
    <span class="n">gg</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OpenEx</span><span class="p">(</span><span class="n">intersection</span><span class="o">.</span><span class="n">ExportToJson</span><span class="p">())</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">VectorTranslate</span><span class="p">(</span>
        <span class="n">overlap</span><span class="p">,</span>
        <span class="n">srcDS</span><span class="o">=</span><span class="n">gg</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">,</span>
        <span class="n">layerCreationOptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;RFC7946=YES&quot;</span><span class="p">,</span> <span class="s2">&quot;WRITE_BBOX=YES&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">img1</span><span class="p">)</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">(</span><span class="n">wkt</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">GetProjection</span><span class="p">())</span>
    <span class="n">epsg</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">GetAttrValue</span><span class="p">(</span><span class="s2">&quot;AUTHORITY&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_img1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clip_image</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">out_img1</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="n">to_cog</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_img2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clip_image</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">out_img2</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="n">to_cog</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">overlap</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_palettable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_palettable</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.get_palettable" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get a list of palettable color palettes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>types</code></td>
        <td><code>list</code></td>
        <td><p>A list of palettable types to return, e.g., types=['matplotlib', 'cartocolors']. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of palettable color palettes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_palettable</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of palettable color palettes.</span>

<span class="sd">    Args:</span>
<span class="sd">        types (list, optional): A list of palettable types to return, e.g., types=[&#39;matplotlib&#39;, &#39;cartocolors&#39;]. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of palettable color palettes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">palettable</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;Please install the palettable package using &#39;pip install palettable&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">types</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">types</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The types must be a list.&quot;</span><span class="p">)</span>

    <span class="n">allowed_palettes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;cartocolors&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmocean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;colorbrewer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cubehelix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightbartlein&quot;</span><span class="p">,</span>
        <span class="s2">&quot;matplotlib&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mycarta&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scientific&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tableau&quot;</span><span class="p">,</span>
        <span class="s2">&quot;wesanderson&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">types</span> <span class="o">=</span> <span class="n">allowed_palettes</span><span class="p">[:]</span>

    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">allowed_palettes</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">types</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The types must be one of the following: &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed_palettes</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">palettes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="s2">&quot;cartocolors&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">cartocolors_diverging</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;cartocolors.diverging.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">cartocolors</span><span class="o">.</span><span class="n">diverging</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">cartocolors_qualitative</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;cartocolors.qualitative.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">cartocolors</span><span class="o">.</span><span class="n">qualitative</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">cartocolors_sequential</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;cartocolors.sequential.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">cartocolors</span><span class="o">.</span><span class="n">sequential</span><span class="p">)[:</span><span class="o">-</span><span class="mi">41</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">palettes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">palettes</span>
            <span class="o">+</span> <span class="n">cartocolors_diverging</span>
            <span class="o">+</span> <span class="n">cartocolors_qualitative</span>
            <span class="o">+</span> <span class="n">cartocolors_sequential</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;cmocean&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">cmocean_diverging</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;cmocean.diverging.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">cmocean</span><span class="o">.</span><span class="n">diverging</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">cmocean_sequential</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;cmocean.sequential.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">cmocean</span><span class="o">.</span><span class="n">sequential</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">cmocean_diverging</span> <span class="o">+</span> <span class="n">cmocean_sequential</span>

    <span class="k">if</span> <span class="s2">&quot;colorbrewer&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">colorbrewer_diverging</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;colorbrewer.diverging.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">colorbrewer</span><span class="o">.</span><span class="n">diverging</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">colorbrewer_qualitative</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;colorbrewer.qualitative.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">colorbrewer</span><span class="o">.</span><span class="n">qualitative</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">colorbrewer_sequential</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;colorbrewer.sequential.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">colorbrewer</span><span class="o">.</span><span class="n">sequential</span><span class="p">)[:</span><span class="o">-</span><span class="mi">41</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">palettes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">palettes</span>
            <span class="o">+</span> <span class="n">colorbrewer_diverging</span>
            <span class="o">+</span> <span class="n">colorbrewer_qualitative</span>
            <span class="o">+</span> <span class="n">colorbrewer_sequential</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;cubehelix&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">cubehelix</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;classic_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cubehelix1_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cubehelix2_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cubehelix3_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jim_special_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;perceptual_rainbow_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;purple_16&quot;</span><span class="p">,</span>
            <span class="s2">&quot;red_16&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">cubehelix</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cubehelix.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cubehelix</span><span class="p">]</span>
        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">cubehelix</span>

    <span class="k">if</span> <span class="s2">&quot;lightbartlein&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">lightbartlein_diverging</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;lightbartlein.diverging.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">lightbartlein</span><span class="o">.</span><span class="n">diverging</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">lightbartlein_sequential</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;lightbartlein.sequential.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">lightbartlein</span><span class="o">.</span><span class="n">sequential</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">lightbartlein_diverging</span> <span class="o">+</span> <span class="n">lightbartlein_sequential</span>

    <span class="k">if</span> <span class="s2">&quot;matplotlib&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">matplotlib_colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;matplotlib.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">matplotlib</span><span class="p">)[:</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">matplotlib_colors</span>

    <span class="k">if</span> <span class="s2">&quot;mycarta&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">mycarta</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;mycarta.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">mycarta</span><span class="p">)[:</span><span class="o">-</span><span class="mi">16</span><span class="p">]]</span>
        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">mycarta</span>

    <span class="k">if</span> <span class="s2">&quot;scientific&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">scientific_diverging</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;scientific.diverging.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">scientific</span><span class="o">.</span><span class="n">diverging</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">scientific_sequential</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;scientific.sequential.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">scientific</span><span class="o">.</span><span class="n">sequential</span><span class="p">)[:</span><span class="o">-</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">scientific_diverging</span> <span class="o">+</span> <span class="n">scientific_sequential</span>

    <span class="k">if</span> <span class="s2">&quot;tableau&quot;</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">tableau</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;tableau.</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">palettable</span><span class="o">.</span><span class="n">tableau</span><span class="p">)[:</span><span class="o">-</span><span class="mi">14</span><span class="p">]]</span>
        <span class="n">palettes</span> <span class="o">=</span> <span class="n">palettes</span> <span class="o">+</span> <span class="n">tableau</span>

    <span class="k">return</span> <span class="n">palettes</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_palette_colors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_palette_colors</span><span class="p">(</span><span class="n">cmap_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hashtag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.get_palette_colors" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get a palette from a matplotlib colormap. See the list of colormaps at https://matplotlib.org/stable/tutorials/colors/colormaps.html.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>cmap_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the matplotlib colormap. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_class</code></td>
        <td><code>int</code></td>
        <td><p>The number of colors. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>hashtag</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return a list of hex colors. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of hex colors.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_palette_colors</span><span class="p">(</span><span class="n">cmap_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hashtag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a palette from a matplotlib colormap. See the list of colormaps at https://matplotlib.org/stable/tutorials/colors/colormaps.html.</span>

<span class="sd">    Args:</span>
<span class="sd">        cmap_name (str, optional): The name of the matplotlib colormap. Defaults to None.</span>
<span class="sd">        n_class (int, optional): The number of colors. Defaults to None.</span>
<span class="sd">        hashtag (bool, optional): Whether to return a list of hex colors. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of hex colors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">))[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">hashtag</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">colors</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_solar_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_solar_data</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">radiusMeters</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;FULL_LAYERS&#39;</span><span class="p">,</span> <span class="n">requiredQuality</span><span class="o">=</span><span class="s1">&#39;HIGH&#39;</span><span class="p">,</span> <span class="n">pixelSizeMeters</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_solar_data" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieve solar data for a specific location from Google's Solar API https://developers.google.com/maps/documentation/solar.
You need to enable Solar API from https://console.cloud.google.com/google/maps-apis/api-list.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lat</code></td>
        <td><code>float</code></td>
        <td><p>Latitude of the location.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>float</code></td>
        <td><p>Longitude of the location.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>radiusMeters</code></td>
        <td><code>int</code></td>
        <td><p>Radius in meters for the data retrieval (default is 50).</p></td>
        <td><code>50</code></td>
      </tr>
      <tr>
        <td><code>view</code></td>
        <td><code>str</code></td>
        <td><p>View type (default is "FULL_LAYERS"). For more options, see https://bit.ly/3LazuBi.</p></td>
        <td><code>&#39;FULL_LAYERS&#39;</code></td>
      </tr>
      <tr>
        <td><code>requiredQuality</code></td>
        <td><code>str</code></td>
        <td><p>Required quality level (default is "HIGH").</p></td>
        <td><code>&#39;HIGH&#39;</code></td>
      </tr>
      <tr>
        <td><code>pixelSizeMeters</code></td>
        <td><code>float</code></td>
        <td><p>Pixel size in meters (default is 0.1).</p></td>
        <td><code>0.1</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>Google API key for authentication (if not provided, checks 'GOOGLE_API_KEY' environment variable).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>header</code></td>
        <td><code>dict</code></td>
        <td><p>Additional HTTP headers to include in the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>Directory where downloaded files will be saved.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>basename</code></td>
        <td><code>str</code></td>
        <td><p>Base name for the downloaded files (default is generated from imagery date).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>If True, suppress progress messages during file downloads (default is False).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>Additional keyword arguments to be passed to the download_file function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, str]</code></td>
      <td><p>A dictionary mapping file names to their corresponding paths.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_solar_data</span><span class="p">(</span>
    <span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">lon</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">radiusMeters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">view</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;FULL_LAYERS&quot;</span><span class="p">,</span>
    <span class="n">requiredQuality</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;HIGH&quot;</span><span class="p">,</span>
    <span class="n">pixelSizeMeters</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">basename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve solar data for a specific location from Google&#39;s Solar API https://developers.google.com/maps/documentation/solar.</span>
<span class="sd">    You need to enable Solar API from https://console.cloud.google.com/google/maps-apis/api-list.</span>

<span class="sd">    Args:</span>
<span class="sd">        lat (float): Latitude of the location.</span>
<span class="sd">        lon (float): Longitude of the location.</span>
<span class="sd">        radiusMeters (int, optional): Radius in meters for the data retrieval (default is 50).</span>
<span class="sd">        view (str, optional): View type (default is &quot;FULL_LAYERS&quot;). For more options, see https://bit.ly/3LazuBi.</span>
<span class="sd">        requiredQuality (str, optional): Required quality level (default is &quot;HIGH&quot;).</span>
<span class="sd">        pixelSizeMeters (float, optional): Pixel size in meters (default is 0.1).</span>
<span class="sd">        api_key (str, optional): Google API key for authentication (if not provided, checks &#39;GOOGLE_API_KEY&#39; environment variable).</span>
<span class="sd">        header (dict, optional): Additional HTTP headers to include in the request.</span>
<span class="sd">        out_dir (str, optional): Directory where downloaded files will be saved.</span>
<span class="sd">        basename (str, optional): Base name for the downloaded files (default is generated from imagery date).</span>
<span class="sd">        quiet (bool, optional): If True, suppress progress messages during file downloads (default is False).</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the download_file function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, str]: A dictionary mapping file names to their corresponding paths.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GOOGLE_API_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;GOOGLE_API_KEY is required to use this function.&quot;</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://solar.googleapis.com/v1/dataLayers:get&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;location.latitude&quot;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span>
        <span class="s2">&quot;location.longitude&quot;</span><span class="p">:</span> <span class="n">lon</span><span class="p">,</span>
        <span class="s2">&quot;radiusMeters&quot;</span><span class="p">:</span> <span class="n">radiusMeters</span><span class="p">,</span>
        <span class="s2">&quot;view&quot;</span><span class="p">:</span> <span class="n">view</span><span class="p">,</span>
        <span class="s2">&quot;requiredQuality&quot;</span><span class="p">:</span> <span class="n">requiredQuality</span><span class="p">,</span>
        <span class="s2">&quot;pixelSizeMeters&quot;</span><span class="p">:</span> <span class="n">pixelSizeMeters</span><span class="p">,</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">solar_data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

    <span class="n">links</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">solar_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;Url&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solar_data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;&amp;key=&quot;</span> <span class="o">+</span> <span class="n">api_key</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">solar_data</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
                <span class="n">links</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">urls</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">links</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">solar_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&amp;key=&quot;</span> <span class="o">+</span> <span class="n">api_key</span>

    <span class="k">if</span> <span class="n">basename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">solar_data</span><span class="p">[</span><span class="s2">&quot;imageryDate&quot;</span><span class="p">]</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="s2">&quot;day&quot;</span><span class="p">]</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">day</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">filenames</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">links</span><span class="p">[</span><span class="n">link</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">links</span><span class="p">[</span><span class="n">link</span><span class="p">]):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Urls&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">.tif&quot;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">filenames</span><span class="p">[</span><span class="n">link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Urls&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Url&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.tif&quot;</span>
            <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">download_file</span><span class="p">(</span><span class="n">links</span><span class="p">[</span><span class="n">link</span><span class="p">],</span> <span class="n">filename</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">filenames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>

    <span class="k">return</span> <span class="n">filenames</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_stac_collections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_stac_collections</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_stac_collections" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieve a list of STAC collections from a URL.
This function is adapted from https://github.com/mykolakozyr/stacdiscovery/blob/a5d1029aec9c428a7ce7ae615621ea8915162824/app.py#L31.
Credits to Mykola Kozyr.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>A URL to a STAC catalog.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to the pystac Client.open() method.
See https://pystac-client.readthedocs.io/en/stable/api.html#pystac_client.Client.open</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of STAC collections.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_stac_collections</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a list of STAC collections from a URL.</span>
<span class="sd">    This function is adapted from https://github.com/mykolakozyr/stacdiscovery/blob/a5d1029aec9c428a7ce7ae615621ea8915162824/app.py#L31.</span>
<span class="sd">    Credits to Mykola Kozyr.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): A URL to a STAC catalog.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the pystac Client.open() method.</span>
<span class="sd">            See https://pystac-client.readthedocs.io/en/stable/api.html#pystac_client.Client.open</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of STAC collections.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pystac_client</span> <span class="kn">import</span> <span class="n">Client</span>

    <span class="c1"># Expensive function. Added cache for it.</span>

    <span class="c1"># Empty list that would be used for a dataframe to collect and visualize info about collections</span>
    <span class="n">root_catalog</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">collections_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Reading collections in the Catalog</span>
    <span class="n">collections</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">root_catalog</span><span class="o">.</span><span class="n">get_collections</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">collections</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="n">collections</span><span class="p">:</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">id</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">title</span>
        <span class="c1"># bbox = collection.extent.spatial.bboxes # not in use for the first release</span>
        <span class="c1"># interval = collection.extent.temporal.intervals # not in use for the first release</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">description</span>

        <span class="c1"># creating a list of lists of values</span>
        <span class="n">collections_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">description</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">collections_list</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_stac_items" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_stac_items</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">intersects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.get_stac_items" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieve a list of STAC items from a URL and a collection.
This function is adapted from https://github.com/mykolakozyr/stacdiscovery/blob/a5d1029aec9c428a7ce7ae615621ea8915162824/app.py#L49.
Credits to Mykola Kozyr.
Available parameters can be found at https://github.com/radiantearth/stac-api-spec/tree/master/item-search</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>A URL to a STAC catalog.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>collection</code></td>
        <td><code>str</code></td>
        <td><p>A STAC collection ID.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>limit</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of results to return (page size). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>tuple</code></td>
        <td><p>Requested bounding box in the format of (minx, miny, maxx, maxy). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>datetime</code></td>
        <td><code>str</code></td>
        <td><p>Single date+time, or a range ('/' separator), formatted to RFC 3339, section 5.6. Use double dots .. for open date ranges.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>intersects</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary representing a GeoJSON Geometry. Searches items by performing intersection between their geometry and provided GeoJSON geometry. All GeoJSON geometry types must be supported.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ids</code></td>
        <td><code>list</code></td>
        <td><p>A list of item ids to return.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>open_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the pystac Client.open() method. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to the Catalog.search() method.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>GeoPandas.GeoDataFraem</code></td>
      <td><p>A GeoDataFrame with the STAC items.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_stac_items</span><span class="p">(</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">collection</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">intersects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">open_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a list of STAC items from a URL and a collection.</span>
<span class="sd">    This function is adapted from https://github.com/mykolakozyr/stacdiscovery/blob/a5d1029aec9c428a7ce7ae615621ea8915162824/app.py#L49.</span>
<span class="sd">    Credits to Mykola Kozyr.</span>
<span class="sd">    Available parameters can be found at https://github.com/radiantearth/stac-api-spec/tree/master/item-search</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): A URL to a STAC catalog.</span>
<span class="sd">        collection (str): A STAC collection ID.</span>
<span class="sd">        limit (int, optional): The maximum number of results to return (page size). Defaults to None.</span>
<span class="sd">        bbox (tuple, optional): Requested bounding box in the format of (minx, miny, maxx, maxy). Defaults to None.</span>
<span class="sd">        datetime (str, optional): Single date+time, or a range (&#39;/&#39; separator), formatted to RFC 3339, section 5.6. Use double dots .. for open date ranges.</span>
<span class="sd">        intersects (dict, optional): A dictionary representing a GeoJSON Geometry. Searches items by performing intersection between their geometry and provided GeoJSON geometry. All GeoJSON geometry types must be supported.</span>
<span class="sd">        ids (list, optional): A list of item ids to return.</span>
<span class="sd">        open_args (dict, optional): A dictionary of arguments to pass to the pystac Client.open() method. Defaults to None.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the Catalog.search() method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoPandas.GeoDataFraem: A GeoDataFrame with the STAC items.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">itertools</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">shape</span>
    <span class="kn">from</span> <span class="nn">pystac_client</span> <span class="kn">import</span> <span class="n">Client</span>

    <span class="c1"># Empty list that would be used for a dataframe to collect and visualize info about collections</span>
    <span class="n">items_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">open_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">open_args</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">root_catalog</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span>
    <span class="k">if</span> <span class="n">bbox</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bbox</span>
    <span class="k">if</span> <span class="n">datetime</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span>
    <span class="k">if</span> <span class="n">intersects</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;intersects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">intersects</span>
    <span class="k">if</span> <span class="n">ids</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ids</span>

    <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">root_catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">collections</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">root_catalog</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">root_catalog</span>

    <span class="n">iterable</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_all_items</span><span class="p">()</span>
    <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># getting first 25000 items. To Do some smarter logic</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">catalog</span> <span class="o">=</span> <span class="n">root_catalog</span><span class="o">.</span><span class="n">get_child</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
            <span class="n">iterable</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_all_items</span><span class="p">()</span>
            <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">_</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ooops, it looks like this collection does not have items.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="c1"># Iterating over items to collect main information</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span>
        <span class="n">geometry</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
        <span class="n">datetime</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">item</span><span class="o">.</span><span class="n">datetime</span>
            <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span>
            <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;end_datetime&quot;</span><span class="p">]</span>
            <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;start_datetime&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">links</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">rel</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
                <span class="n">self_url</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">target</span>
        <span class="n">assets_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">assets</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">assets</span>
        <span class="k">for</span> <span class="n">asset</span> <span class="ow">in</span> <span class="n">assets</span><span class="p">:</span>
            <span class="n">assets_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span>

        <span class="c1"># creating a list of lists of values</span>
        <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">id</span><span class="p">,</span> <span class="n">geometry</span><span class="p">,</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">self_url</span><span class="p">,</span> <span class="n">assets_list</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">items_list</span> <span class="o">=</span> <span class="n">items_list</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
    <span class="n">items_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">items_list</span><span class="p">)</span>
    <span class="n">items_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;self_url&quot;</span><span class="p">,</span> <span class="s2">&quot;assets_list&quot;</span><span class="p">]</span>

    <span class="n">items_gdf</span> <span class="o">=</span> <span class="n">items_df</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
    <span class="n">items_gdf</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">items_gdf</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
        <span class="nb">str</span>
    <span class="p">)</span>  <span class="c1"># specifically for KeplerGL. See https://github.com/keplergl/kepler.gl/issues/602</span>
    <span class="c1"># items_gdf[&quot;assets_list&quot;] = items_gdf[&quot;assets_list&quot;].astype(str) #specifically for KeplerGL. See https://github.com/keplergl/kepler.gl/issues/602</span>
    <span class="n">items_gdf</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">items_gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.get_wms_layers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_wms_layers</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


<a href="#leafmap.common.get_wms_layers" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns a list of WMS layers from a WMS service.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the WMS service.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of WMS layers.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_wms_layers</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a list of WMS layers from a WMS service.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the WMS service.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of WMS layers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">owslib.wms</span> <span class="kn">import</span> <span class="n">WebMapService</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Please install owslib using &#39;pip install owslib&#39;.&quot;</span><span class="p">)</span>

    <span class="n">wms</span> <span class="o">=</span> <span class="n">WebMapService</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wms</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>
    <span class="n">layers</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">layers</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gif_fading" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gif_fading</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.gif_fading" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fade in/out the gif.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input gif file. Can be a directory path or http URL, e.g., "https://i.imgur.com/ZWSZC5z.gif"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>duration</code></td>
        <td><code>float</code></td>
        <td><p>The duration of the fading. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>Raise exception when the input gif does not exist.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception when ffmpeg is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gif_fading</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fade in/out the gif.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input gif file. Can be a directory path or http URL, e.g., &quot;https://i.imgur.com/ZWSZC5z.gif&quot;</span>
<span class="sd">        out_gif (str): The output gif file.</span>
<span class="sd">        duration (float, optional): The duration of the fading. Defaults to 1.</span>
<span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: Raise exception when the input gif does not exist.</span>
<span class="sd">        Exception: Raise exception when ffmpeg is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>

    <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_gif</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span>
        <span class="n">download_from_url</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">in_gif</span> <span class="o">=</span> <span class="n">file_path</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;in_gif must be a gif file.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">in_gif</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The filename cannot contain spaces.&quot;</span><span class="p">)</span>

    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="n">basename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">):</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

    <span class="n">gif_to_png</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

    <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="s2">&quot;*.png&quot;</span><span class="p">)))</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-loop 1 -t </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> -i </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">[1:v][0:v]blend=all_expr=&#39;A*(if(gte(T,3),1,T/3))+B*(1-(if(gte(T,3),1,T/3)))&#39;[v0];&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:v][</span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">:v]blend=all_expr=&#39;A*(if(gte(T,3),1,T/3))+B*(1-(if(gte(T,3),1,T/3)))&#39;[v</span><span class="si">{</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">];&quot;</span>
            <span class="p">)</span>

    <span class="n">last_filter</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">last_filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">last_filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;concat=n=</span><span class="si">{</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">:v=1:a=0[v]&quot; -map &quot;[v]&quot;&#39;</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_filter</span><span class="p">)</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -y -loglevel error </span><span class="si">{</span><span class="n">inputs</span><span class="si">}</span><span class="s2"> -filter_complex </span><span class="si">{</span><span class="n">filters</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">current_dir</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gif_to_mp4" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">)</span></code>


<a href="#leafmap.common.gif_to_mp4" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a gif to mp4.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_mp4</code></td>
        <td><code>str</code></td>
        <td><p>The output mp4 file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gif_to_mp4</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_mp4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a gif to mp4.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input gif file.</span>
<span class="sd">        out_mp4 (str): The output mp4 file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">out_mp4</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.mp4&quot;</span><span class="p">):</span>
        <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_mp4</span> <span class="o">+</span> <span class="s2">&quot;.mp4&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tool</span><span class="p">(</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>

    <span class="k">if</span> <span class="n">width</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">height</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> -vcodec libx264 -crf 25 -pix_fmt yuv420p </span><span class="si">{</span><span class="n">out_mp4</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">+=</span> <span class="n">width</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="n">height</span> <span class="o">+=</span> <span class="n">height</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> -vf scale=</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> -vcodec libx264 -crf 25 -pix_fmt yuv420p </span><span class="si">{</span><span class="n">out_mp4</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create mp4 file.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.gif_to_png" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gif_to_png</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.gif_to_png" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a gif to png.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>The prefix of the output png files. Defaults to None.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>Raise exception when the input gif does not exist.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception when ffmpeg is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gif_to_png</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a gif to png.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input gif file.</span>
<span class="sd">        out_dir (str, optional): The output directory. Defaults to None.</span>
<span class="sd">        prefix (str, optional): The prefix of the output png files. Defaults to None.</span>
<span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: Raise exception when the input gif does not exist.</span>
<span class="sd">        Exception: Raise exception when ffmpeg is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>

    <span class="n">in_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">in_gif</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;in_gif cannot contain spaces.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="n">basename</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;out_dir must be a string.&quot;</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">in_gif</span><span class="si">}</span><span class="s2"> -vsync 0 </span><span class="si">{</span><span class="n">out_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">%d.png&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Images are saved to </span><span class="si">{</span><span class="n">out_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.github_raw_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">github_raw_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


<a href="#leafmap.common.github_raw_url" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the raw URL for a GitHub file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The GitHub URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The raw URL.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">github_raw_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the raw URL for a GitHub file.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The GitHub URL.</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: The raw URL.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;https://github.com/&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;blob&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;github.com&quot;</span><span class="p">,</span> <span class="s2">&quot;raw.githubusercontent.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s2">&quot;blob/&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">url</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.google_buildings_csv_to_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">google_buildings_csv_to_vector</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.google_buildings_csv_to_vector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a CSV file containing Google Buildings data to a GeoJSON vector file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The path to the input CSV file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output GeoJSON file. If not provided, the output file will have the same
name as the input file with the extension changed to '.geojson'.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments that are passed to the <code>to_file</code> method of the GeoDataFrame.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">google_buildings_csv_to_vector</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a CSV file containing Google Buildings data to a GeoJSON vector file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The path to the input CSV file.</span>
<span class="sd">        output (str, optional): The path to the output GeoJSON file. If not provided, the output file will have the same</span>
<span class="sd">            name as the input file with the extension changed to &#39;.geojson&#39;.</span>
<span class="sd">        **kwargs: Additional keyword arguments that are passed to the `to_file` method of the GeoDataFrame.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely</span> <span class="kn">import</span> <span class="n">wkt</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="c1"># Create a geometry column from the &quot;geometry&quot; column in the DataFrame</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wkt</span><span class="o">.</span><span class="n">loads</span><span class="p">)</span>

    <span class="c1"># Convert the pandas DataFrame to a GeoDataFrame</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.geojson&quot;</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.h5_keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h5_keys</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>


<a href="#leafmap.common.h5_keys" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieve the keys (dataset names) within an HDF5 file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The filename of the HDF5 file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>A list of dataset names present in the HDF5 file.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>Raised if h5py is not installed.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">h5_keys</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
<span class="p">[</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">h5_keys</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the keys (dataset names) within an HDF5 file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The filename of the HDF5 file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: A list of dataset names present in the HDF5 file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: Raised if h5py is not installed.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; keys = h5_keys(&#39;data.h5&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(keys)</span>
<span class="sd">        [</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">h5py</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;h5py must be installed to use this function. Please install it with &#39;pip install h5py&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">keys</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.h5_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h5_to_gdf</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;lat_lowestmode&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;lon_lowestmode&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.h5_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Read data from one or multiple HDF5 files and return as a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filenames</code></td>
        <td><code>str or List[str]</code></td>
        <td><p>The filename(s) of the HDF5 file(s).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset</code></td>
        <td><code>str</code></td>
        <td><p>The dataset name within the H5 file(s).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>str</code></td>
        <td><p>The column name representing latitude. Default is 'lat_lowestmode'.</p></td>
        <td><code>&#39;lat_lowestmode&#39;</code></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>str</code></td>
        <td><p>The column name representing longitude. Default is 'lon_lowestmode'.</p></td>
        <td><code>&#39;lon_lowestmode&#39;</code></td>
      </tr>
      <tr>
        <td><code>columns</code></td>
        <td><code>List[str]</code></td>
        <td><p>List of column names to include. If None, all columns will be included. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system code. Default is "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the GeoDataFrame constructor.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>geopandas.GeoDataFrame</code></td>
      <td><p>A GeoDataFrame containing the data from the H5 file(s).</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>Raised if h5py is not installed.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>Raised if the provided filenames argument is not a valid type or if a specified file does not exist.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">gdf</span> <span class="o">=</span> <span class="n">h5_to_gdf</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;dataset1&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
   <span class="n">column1</span>  <span class="n">column2</span>        <span class="n">lat</span>        <span class="n">lon</span>                    <span class="n">geometry</span>
<span class="mi">0</span>        <span class="mi">10</span>       <span class="mi">20</span>  <span class="mf">40.123456</span> <span class="o">-</span><span class="mf">75.987654</span>  <span class="n">POINT</span> <span class="p">(</span><span class="o">-</span><span class="mf">75.987654</span> <span class="mf">40.123456</span><span class="p">)</span>
<span class="mi">1</span>        <span class="mi">15</span>       <span class="mi">25</span>  <span class="mf">40.234567</span> <span class="o">-</span><span class="mf">75.876543</span>  <span class="n">POINT</span> <span class="p">(</span><span class="o">-</span><span class="mf">75.876543</span> <span class="mf">40.234567</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">h5_to_gdf</span><span class="p">(</span>
    <span class="n">filenames</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">lat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lat_lowestmode&quot;</span><span class="p">,</span>
    <span class="n">lon</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lon_lowestmode&quot;</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read data from one or multiple HDF5 files and return as a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        filenames (str or List[str]): The filename(s) of the HDF5 file(s).</span>
<span class="sd">        dataset (str): The dataset name within the H5 file(s).</span>
<span class="sd">        lat (str): The column name representing latitude. Default is &#39;lat_lowestmode&#39;.</span>
<span class="sd">        lon (str): The column name representing longitude. Default is &#39;lon_lowestmode&#39;.</span>
<span class="sd">        columns (List[str], optional): List of column names to include. If None, all columns will be included. Default is None.</span>
<span class="sd">        crs (str, optional): The coordinate reference system code. Default is &quot;EPSG:4326&quot;.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the GeoDataFrame constructor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        geopandas.GeoDataFrame: A GeoDataFrame containing the data from the H5 file(s).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: Raised if h5py is not installed.</span>
<span class="sd">        ValueError: Raised if the provided filenames argument is not a valid type or if a specified file does not exist.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; gdf = h5_to_gdf(&#39;data.h5&#39;, &#39;dataset1&#39;, &#39;lat&#39;, &#39;lon&#39;, columns=[&#39;column1&#39;, &#39;column2&#39;], crs=&#39;EPSG:4326&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(gdf.head())</span>
<span class="sd">           column1  column2        lat        lon                    geometry</span>
<span class="sd">        0        10       20  40.123456 -75.987654  POINT (-75.987654 40.123456)</span>
<span class="sd">        1        15       25  40.234567 -75.876543  POINT (-75.876543 40.234567)</span>
<span class="sd">        ...</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">h5py</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">install_package</span><span class="p">(</span><span class="s2">&quot;h5py&quot;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">h5py</span>

    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">filenames</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filenames</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>
            <span class="n">files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">filenames</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;h5_file must be a string or a list of strings.&quot;</span><span class="p">)</span>

    <span class="n">out_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">h5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> not found in file </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">. Skipping...&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">col_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_val</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">columns</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="n">lat</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="n">lon</span><span class="p">:</span>
                <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">col_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">[:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">col_val</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
        <span class="n">out_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out_df</span><span class="p">,</span> <span class="n">df</span><span class="p">])</span>
        <span class="n">h5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nodata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_df</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="n">out_df</span><span class="p">[</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="n">nodata</span><span class="p">]</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
        <span class="n">out_df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">out_df</span><span class="p">[</span><span class="n">lon</span><span class="p">],</span> <span class="n">out_df</span><span class="p">[</span><span class="n">lat</span><span class="p">]),</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.h5_variables" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h5_variables</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></code>


<a href="#leafmap.common.h5_variables" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieve the variables (column names) within a specific key (dataset) in an H5 file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The filename of the H5 file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>str</code></td>
        <td><p>The key (dataset name) within the H5 file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>A list of variable names (column names) within the specified key.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>Raised if h5py is not installed.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">variables</span> <span class="o">=</span> <span class="n">h5_variables</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;dataset1&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">,</span> <span class="s1">&#39;var3&#39;</span><span class="p">]</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">h5_variables</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the variables (column names) within a specific key (dataset) in an H5 file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The filename of the H5 file.</span>
<span class="sd">        key (str): The key (dataset name) within the H5 file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: A list of variable names (column names) within the specified key.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: Raised if h5py is not installed.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; variables = h5_variables(&#39;data.h5&#39;, &#39;dataset1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(variables)</span>
<span class="sd">        [&#39;var1&#39;, &#39;var2&#39;, &#39;var3&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">h5py</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;h5py must be installed to use this function. Please install it with &#39;pip install h5py&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">cols</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.has_transparency" class="doc doc-heading">
<code class="highlight language-python"><span class="n">has_transparency</span><span class="p">(</span><span class="n">img</span><span class="p">)</span></code>


<a href="#leafmap.common.has_transparency" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Checks whether an image has transparency.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img</code></td>
        <td><code>object</code></td>
        <td><p>a PIL Image object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if it has transparency, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">has_transparency</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether an image has transparency.</span>

<span class="sd">    Args:</span>
<span class="sd">        img (object):  a PIL Image object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if it has transparency, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
        <span class="n">transparent</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">img</span><span class="o">.</span><span class="n">getcolors</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="n">transparent</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">img</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGBA&quot;</span><span class="p">:</span>
        <span class="n">extrema</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">getextrema</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">255</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.hex_to_rgb" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.hex_to_rgb" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts hex color to RGB color.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>value</code></td>
        <td><code>str</code></td>
        <td><p>Hex color code as a string. Defaults to 'FFFFFF'.</p></td>
        <td><code>&#39;FFFFFF&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>RGB color as a tuple.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hex_to_rgb</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FFFFFF&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts hex color to RGB color.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (str, optional): Hex color code as a string. Defaults to &#39;FFFFFF&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: RGB color as a tuple.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
    <span class="n">lv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">lv</span> <span class="o">//</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lv</span><span class="p">,</span> <span class="n">lv</span> <span class="o">//</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.html_to_gradio" class="doc doc-heading">
<code class="highlight language-python"><span class="n">html_to_gradio</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;500px&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.html_to_gradio" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts the map to an HTML string that can be used in Gradio. Removes unsupported elements, such as
    attribution and any code blocks containing functions. See https://github.com/gradio-app/gradio/issues/3190</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>width</code></td>
        <td><code>str</code></td>
        <td><p>The width of the map. Defaults to '100%'.</p></td>
        <td><code>&#39;100%&#39;</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>str</code></td>
        <td><p>The height of the map. Defaults to '500px'.</p></td>
        <td><code>&#39;500px&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The HTML string to use in Gradio.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">html_to_gradio</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;500px&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts the map to an HTML string that can be used in Gradio. Removes unsupported elements, such as</span>
<span class="sd">        attribution and any code blocks containing functions. See https://github.com/gradio-app/gradio/issues/3190</span>

<span class="sd">    Args:</span>
<span class="sd">        width (str, optional): The width of the map. Defaults to &#39;100%&#39;.</span>
<span class="sd">        height (str, optional): The height of the map. Defaults to &#39;500px&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The HTML string to use in Gradio.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">width</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">px&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">height</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">px&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">html</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;html must be a file path or a list of strings&quot;</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">skipped_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">skipped_lines</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;{&quot;attribution&quot;:&#39;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="s2">&quot;on(L.Draw.Event.CREATED, function(e)&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">):</span>
                <span class="n">skipped_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;L.Control.geocoder&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="n">skipped_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;function(e)&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Warning: The folium plotting backend does not support functions in code blocks. Please delete line </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;iframe style=&quot;width: </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">; height: </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot; name=&quot;result&quot; allow=&quot;midi; geolocation; microphone; camera;</span>
<span class="s2">    display-capture; encrypted-media;&quot; sandbox=&quot;allow-modals allow-forms</span>
<span class="s2">    allow-scripts allow-same-origin allow-popups</span>
<span class="s2">    allow-top-navigation-by-user-activation allow-downloads&quot; allowfullscreen=&quot;&quot;</span>
<span class="s2">    allowpaymentrequest=&quot;&quot; frameborder=&quot;0&quot; srcdoc=&#39;</span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&gt;&lt;/iframe&gt;&quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.html_to_streamlit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">html_to_streamlit</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">replace_dict</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.html_to_streamlit" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Renders an HTML file as a Streamlit component.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The filename of the HTML file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the map. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the map. Defaults to 600.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>scrolling</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to allow the map to scroll. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>replace_dict</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of strings to replace in the HTML file. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the filename does not exist.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>streamlit.components</code></td>
      <td><p>components.html object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">html_to_streamlit</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">replace_dict</span><span class="o">=</span><span class="p">{}</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renders an HTML file as a Streamlit component.</span>
<span class="sd">    Args:</span>
<span class="sd">        filename (str): The filename of the HTML file.</span>
<span class="sd">        width (int, optional): Width of the map. Defaults to None.</span>
<span class="sd">        height (int, optional): Height of the map. Defaults to 600.</span>
<span class="sd">        scrolling (bool, optional): Whether to allow the map to scroll. Defaults to False.</span>
<span class="sd">        replace_dict (dict, optional): A dictionary of strings to replace in the HTML file. Defaults to {}.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the filename does not exist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        streamlit.components: components.html object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">streamlit.components.v1</span> <span class="k">as</span> <span class="nn">components</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;filename must exist.&quot;</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="n">html</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">replace_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">components</span><span class="o">.</span><span class="n">html</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="n">scrolling</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_bandcount" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_bandcount</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_bandcount" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the number of bands in an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>The number of bands in the image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_bandcount</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the number of bands in an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The number of bands in the image.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;bands&quot;</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_bounds</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the bounds of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of bounds in the form of [(south, west), (north, east)].</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_bounds</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the bounds of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of bounds in the form of [(south, west), (north, east)].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_center" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_center</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_center" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the center of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of (latitude, longitude).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_center</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the center of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of (latitude, longitude).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_client" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_client</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_client" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get a LocalTileserver TileClient from an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>TileClient</code></td>
      <td><p>A LocalTileserver TileClient.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_client</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a LocalTileserver TileClient from an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TileClient: A LocalTileserver TileClient.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_comparison" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_comparison</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">704</span><span class="p">,</span> <span class="n">show_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">starting_position</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">make_responsive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">in_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_html</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.image_comparison" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a comparison slider for two images. The source code is adapted from
    https://github.com/fcakyon/streamlit-image-comparison. Credits to the GitHub user @fcakyon.
    Users can also use https://juxtapose.knightlab.com to create a comparison slider.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img1</code></td>
        <td><code>str</code></td>
        <td><p>Path to the first image. It can be a local file path, a URL, or a numpy array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>img2</code></td>
        <td><code>str</code></td>
        <td><p>Path to the second image. It can be a local file path, a URL, or a numpy array.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>label1</code></td>
        <td><code>str</code></td>
        <td><p>Label for the first image. Defaults to "1".</p></td>
        <td><code>&#39;1&#39;</code></td>
      </tr>
      <tr>
        <td><code>label2</code></td>
        <td><code>str</code></td>
        <td><p>Label for the second image. Defaults to "2".</p></td>
        <td><code>&#39;2&#39;</code></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the component in pixels. Defaults to 704.</p></td>
        <td><code>704</code></td>
      </tr>
      <tr>
        <td><code>show_labels</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show labels on the images. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>starting_position</code></td>
        <td><code>int</code></td>
        <td><p>Starting position of the slider as a percentage (0-100). Default is 50.</p></td>
        <td><code>50</code></td>
      </tr>
      <tr>
        <td><code>make_responsive</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to enable responsive mode. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>in_memory</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to handle pillow to base64 conversion in memory without saving to local. Default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>out_html</code></td>
        <td><code>str</code></td>
        <td><p>Whether to handle pillow to base64 conversion in memory without saving to local. Default is True.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_comparison</span><span class="p">(</span>
    <span class="n">img1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">img2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">704</span><span class="p">,</span>
    <span class="n">show_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">starting_position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">make_responsive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">in_memory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">out_html</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a comparison slider for two images. The source code is adapted from</span>
<span class="sd">        https://github.com/fcakyon/streamlit-image-comparison. Credits to the GitHub user @fcakyon.</span>
<span class="sd">        Users can also use https://juxtapose.knightlab.com to create a comparison slider.</span>

<span class="sd">    Args:</span>
<span class="sd">        img1 (str): Path to the first image. It can be a local file path, a URL, or a numpy array.</span>
<span class="sd">        img2 (str): Path to the second image. It can be a local file path, a URL, or a numpy array.</span>
<span class="sd">        label1 (str, optional): Label for the first image. Defaults to &quot;1&quot;.</span>
<span class="sd">        label2 (str, optional): Label for the second image. Defaults to &quot;2&quot;.</span>
<span class="sd">        width (int, optional): Width of the component in pixels. Defaults to 704.</span>
<span class="sd">        show_labels (bool, optional): Whether to show labels on the images. Default is True.</span>
<span class="sd">        starting_position (int, optional): Starting position of the slider as a percentage (0-100). Default is 50.</span>
<span class="sd">        make_responsive (bool, optional): Whether to enable responsive mode. Default is True.</span>
<span class="sd">        in_memory (bool, optional): Whether to handle pillow to base64 conversion in memory without saving to local. Default is True.</span>
<span class="sd">        out_html (str, optional): Whether to handle pillow to base64 conversion in memory without saving to local. Default is True.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
    <span class="kn">import</span> <span class="nn">base64</span>
    <span class="kn">import</span> <span class="nn">io</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">uuid</span>
    <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
    <span class="kn">import</span> <span class="nn">requests</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>

    <span class="n">TEMP_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="n">random_string</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">TEMP_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">exif_transpose</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transpose a PIL image accordingly if it has an EXIF Orientation tag.</span>
<span class="sd">        Inplace version of https://github.com/python-pillow/Pillow/blob/master/src/PIL/ImageOps.py exif_transpose()</span>
<span class="sd">        :param image: The image to transpose.</span>
<span class="sd">        :return: An image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exif</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getexif</span><span class="p">()</span>
        <span class="n">orientation</span> <span class="o">=</span> <span class="n">exif</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mh">0x0112</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># default 1</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">2</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">FLIP_LEFT_RIGHT</span><span class="p">,</span>
                <span class="mi">3</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">ROTATE_180</span><span class="p">,</span>
                <span class="mi">4</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">FLIP_TOP_BOTTOM</span><span class="p">,</span>
                <span class="mi">5</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">TRANSPOSE</span><span class="p">,</span>
                <span class="mi">6</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">ROTATE_270</span><span class="p">,</span>
                <span class="mi">7</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">TRANSVERSE</span><span class="p">,</span>
                <span class="mi">8</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">ROTATE_90</span><span class="p">,</span>
            <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">orientation</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">exif</span><span class="p">[</span><span class="mh">0x0112</span><span class="p">]</span>
                <span class="n">image</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;exif&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exif</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">image</span>

    <span class="k">def</span> <span class="nf">read_image_as_pil</span><span class="p">(</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">exif_fix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads an image as PIL.Image.Image.</span>
<span class="sd">        Args:</span>
<span class="sd">            image : Can be image path or url (str), numpy image (np.ndarray) or PIL.Image</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># https://stackoverflow.com/questions/56174099/how-to-load-images-larger-than-max-image-pixels-with-pil</span>
        <span class="n">Image</span><span class="o">.</span><span class="n">MAX_IMAGE_PIXELS</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
            <span class="n">image_pil</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># read image if str image path is provided</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                    <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">raw</span>
                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="n">image</span>
                <span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">exif_fix</span><span class="p">:</span>
                    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">exif_transpose</span><span class="p">(</span><span class="n">image_pil</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># handle large/tiff image reading</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">skimage.io</span>
                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                        <span class="s2">&quot;Please run &#39;pip install -U scikit-image imagecodecs&#39; for large image handling.&quot;</span>
                    <span class="p">)</span>
                <span class="n">image_sk</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_sk</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># b&amp;w</span>
                    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image_sk</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">image_sk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># rgba</span>
                    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image_sk</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">image_sk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># rgb</span>
                    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image_sk</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;image with shape: </span><span class="si">{</span><span class="n">image_sk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not supported.&quot;</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># image in CHW</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;read image with &#39;pillow&#39; using &#39;Image.open()&#39;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">image_pil</span>

    <span class="k">def</span> <span class="nf">pillow_to_base64</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a PIL image to a base64-encoded string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image: PIL.Image.Image</span>
<span class="sd">            The image to be converted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The base64-encoded string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">in_mem_file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">in_mem_file</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;JPEG&quot;</span><span class="p">,</span> <span class="n">subsampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">img_bytes</span> <span class="o">=</span> <span class="n">in_mem_file</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>  <span class="c1"># bytes</span>
        <span class="n">image_str</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">img_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">base64_src</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;data:image/jpg;base64,</span><span class="si">{</span><span class="n">image_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">base64_src</span>

    <span class="k">def</span> <span class="nf">local_file_to_base64</span><span class="p">(</span><span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a local image file to a base64-encoded string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image_path: str</span>
<span class="sd">            The path to the image file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The base64-encoded string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">img_bytes</span> <span class="o">=</span> <span class="n">file_</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">image_str</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">img_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">file_</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">base64_src</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;data:image/jpg;base64,</span><span class="si">{</span><span class="n">image_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">base64_src</span>

    <span class="k">def</span> <span class="nf">pillow_local_file_to_base64</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a Pillow image to a base64 string, using a temporary file on disk.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image : PIL.Image.Image</span>
<span class="sd">            The Pillow image to convert.</span>
<span class="sd">        temp_dir : str</span>
<span class="sd">            The directory to use for the temporary file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A base64-encoded string representing the image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create temporary file path using os.path.join()</span>
        <span class="n">img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span><span class="p">)</span>

        <span class="c1"># Save image to temporary file</span>
        <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">subsampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

        <span class="c1"># Convert temporary file to base64 string</span>
        <span class="n">base64_src</span> <span class="o">=</span> <span class="n">local_file_to_base64</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">base64_src</span>

    <span class="c1"># Prepare images</span>
    <span class="n">img1_pillow</span> <span class="o">=</span> <span class="n">read_image_as_pil</span><span class="p">(</span><span class="n">img1</span><span class="p">)</span>
    <span class="n">img2_pillow</span> <span class="o">=</span> <span class="n">read_image_as_pil</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>

    <span class="n">img_width</span><span class="p">,</span> <span class="n">img_height</span> <span class="o">=</span> <span class="n">img1_pillow</span><span class="o">.</span><span class="n">size</span>
    <span class="n">h_to_w</span> <span class="o">=</span> <span class="n">img_height</span> <span class="o">/</span> <span class="n">img_width</span>
    <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">width</span> <span class="o">*</span> <span class="n">h_to_w</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">in_memory</span><span class="p">:</span>
        <span class="c1"># Convert images to base64 strings</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">pillow_to_base64</span><span class="p">(</span><span class="n">img1_pillow</span><span class="p">)</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="n">pillow_to_base64</span><span class="p">(</span><span class="n">img2_pillow</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Create base64 strings from temporary files</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">TEMP_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file_</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">TEMP_DIR</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file_</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.jpg&quot;</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEMP_DIR</span><span class="p">,</span> <span class="n">file_</span><span class="p">))</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">pillow_local_file_to_base64</span><span class="p">(</span><span class="n">img1_pillow</span><span class="p">,</span> <span class="n">TEMP_DIR</span><span class="p">)</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="n">pillow_local_file_to_base64</span><span class="p">(</span><span class="n">img2_pillow</span><span class="p">,</span> <span class="n">TEMP_DIR</span><span class="p">)</span>

    <span class="c1"># Load CSS and JS</span>
    <span class="n">cdn_path</span> <span class="o">=</span> <span class="s2">&quot;https://cdn.knightlab.com/libs/juxtapose/latest&quot;</span>
    <span class="n">css_block</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;</span><span class="si">{</span><span class="n">cdn_path</span><span class="si">}</span><span class="s1">/css/juxtapose.css&quot;&gt;&#39;</span>
    <span class="n">js_block</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;script src=&quot;</span><span class="si">{</span><span class="n">cdn_path</span><span class="si">}</span><span class="s1">/js/juxtapose.min.js&quot;&gt;&lt;/script&gt;&#39;</span>

    <span class="c1"># write html block</span>
    <span class="n">htmlcode</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;html&gt;</span>
<span class="s2">        &lt;head&gt;</span>
<span class="s2">        &lt;style&gt;body </span><span class="se">{{</span><span class="s2"> margin: unset; </span><span class="se">}}</span><span class="s2">&lt;/style&gt;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">css_block</span><span class="si">}</span>
<span class="s2">        </span><span class="si">{</span><span class="n">js_block</span><span class="si">}</span>
<span class="s2">        &lt;div id=&quot;foo&quot; style=&quot;height: </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">; width: </span><span class="si">{</span><span class="n">width</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;100%&#39;</span><span class="si">}</span><span class="s2">;&quot;&gt;&lt;/div&gt;</span>
<span class="s2">        &lt;script&gt;</span>
<span class="s2">        slider = new juxtapose.JXSlider(&#39;#foo&#39;,</span>
<span class="s2">            [</span>
<span class="s2">                </span><span class="se">{{</span>
<span class="s2">                    src: &#39;</span><span class="si">{</span><span class="n">img1</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                    label: &#39;</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">                </span><span class="se">{{</span>
<span class="s2">                    src: &#39;</span><span class="si">{</span><span class="n">img2</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                    label: &#39;</span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="s2">&#39;,</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            ],</span>
<span class="s2">            </span><span class="se">{{</span>
<span class="s2">                animate: true,</span>
<span class="s2">                showLabels: </span><span class="si">{</span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">show_labels</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                showCredits: true,</span>
<span class="s2">                startingPosition: &quot;</span><span class="si">{</span><span class="n">starting_position</span><span class="si">}</span><span class="s2">%&quot;,</span>
<span class="s2">                makeResponsive: </span><span class="si">{</span><span class="s1">&#39;true&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">make_responsive</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">        &lt;/script&gt;</span>
<span class="s2">        &lt;/head&gt;</span>
<span class="s2">        &lt;/html&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">out_html</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_html</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">htmlcode</span><span class="p">)</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">TEMP_DIR</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">htmlcode</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_filesize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_filesize</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;MB&#39;</span><span class="p">,</span> <span class="n">source_crs</span><span class="o">=</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="s1">&#39;epsg:3857&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.image_filesize" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Calculate the size of an image in a given region and cell size.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>region</code></td>
        <td><code>list</code></td>
        <td><p>A bounding box in the format of [minx, miny, maxx, maxy].</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cellsize</code></td>
        <td><code>float</code></td>
        <td><p>The resolution of the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>int</code></td>
        <td><p>Number of bands. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>dtype</code></td>
        <td><code>str</code></td>
        <td><p>Data type, such as unit8, float32. For more info,
see https://numpy.org/doc/stable/user/basics.types.html. Defaults to 'uint8'.</p></td>
        <td><code>&#39;uint8&#39;</code></td>
      </tr>
      <tr>
        <td><code>unit</code></td>
        <td><code>str</code></td>
        <td><p>The unit of the output. Defaults to 'MB'.</p></td>
        <td><code>&#39;MB&#39;</code></td>
      </tr>
      <tr>
        <td><code>source_crs</code></td>
        <td><code>str</code></td>
        <td><p>The CRS of the region. Defaults to 'epsg:4326'.</p></td>
        <td><code>&#39;epsg:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The destination CRS to calculate the area. Defaults to 'epsg:3857'.</p></td>
        <td><code>&#39;epsg:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use the bounding box of the region to calculate the area. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>The size of the image in a given unit.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_filesize</span><span class="p">(</span>
    <span class="n">region</span><span class="p">,</span>
    <span class="n">cellsize</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
    <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;MB&quot;</span><span class="p">,</span>
    <span class="n">source_crs</span><span class="o">=</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">,</span>
    <span class="n">dst_crs</span><span class="o">=</span><span class="s2">&quot;epsg:3857&quot;</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the size of an image in a given region and cell size.</span>

<span class="sd">    Args:</span>
<span class="sd">        region (list): A bounding box in the format of [minx, miny, maxx, maxy].</span>
<span class="sd">        cellsize (float): The resolution of the image.</span>
<span class="sd">        bands (int, optional): Number of bands. Defaults to 1.</span>
<span class="sd">        dtype (str, optional): Data type, such as unit8, float32. For more info,</span>
<span class="sd">            see https://numpy.org/doc/stable/user/basics.types.html. Defaults to &#39;uint8&#39;.</span>
<span class="sd">        unit (str, optional): The unit of the output. Defaults to &#39;MB&#39;.</span>
<span class="sd">        source_crs (str, optional): The CRS of the region. Defaults to &#39;epsg:4326&#39;.</span>
<span class="sd">        dst_crs (str, optional): The destination CRS to calculate the area. Defaults to &#39;epsg:3857&#39;.</span>
<span class="sd">        bbox (bool, optional): Whether to use the bounding box of the region to calculate the area. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The size of the image in a given unit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="n">bbox</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span><span class="o">.</span><span class="n">total_bounds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span><span class="o">.</span><span class="n">total_bounds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">bbox_to_gdf</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">source_crs</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span>
                <span class="o">.</span><span class="n">total_bounds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input region.&quot;</span><span class="p">)</span>

        <span class="nb">bytes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="nb">int</span><span class="p">((</span><span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">cellsize</span><span class="p">),</span>
                    <span class="nb">int</span><span class="p">((</span><span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">cellsize</span><span class="p">),</span>
                    <span class="n">bands</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="n">bbox_to_gdf</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">source_crs</span><span class="p">)</span>

        <span class="nb">bytes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">vector_area</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">dst_crs</span><span class="p">)</span>
            <span class="o">/</span> <span class="nb">pow</span><span class="p">(</span><span class="n">cellsize</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span>
            <span class="o">*</span> <span class="n">bands</span>
        <span class="p">)</span>

    <span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KB&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span> <span class="o">/</span> <span class="mi">1024</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MB&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GB&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TB&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PB&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_geotransform" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_geotransform</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_geotransform" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the geotransform of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of geotransform values.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_geotransform</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the geotransform of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of geotransform values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;GeoTransform&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_metadata</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_metadata" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the metadata of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of image metadata.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_metadata</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the metadata of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of image metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_min_max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_min_max</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.image_min_max" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Computes the minimum and maximum pixel values of an image.</p>
<p>This function opens an image file using xarray and rasterio, optionally
    selects specific bands, and then computes the minimum and maximum pixel
    values in the image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The path to the image file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>int or list</code></td>
        <td><p>The band or list of bands to select. If
None, all bands are used.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[float, float]</code></td>
      <td><p>The minimum and maximum pixel values in the image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_min_max</span><span class="p">(</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bands</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the minimum and maximum pixel values of an image.</span>

<span class="sd">    This function opens an image file using xarray and rasterio, optionally</span>
<span class="sd">        selects specific bands, and then computes the minimum and maximum pixel</span>
<span class="sd">        values in the image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The path to the image file.</span>
<span class="sd">        bands (int or list, optional): The band or list of bands to select. If</span>
<span class="sd">            None, all bands are used.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[float, float]: The minimum and maximum pixel values in the image.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">rioxarray</span>
    <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;rasterio&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="n">bands</span><span class="p">)</span>

    <span class="n">vmin</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;band_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;band_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_projection" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_projection</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_projection" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the projection of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The projection of the image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_projection</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the projection of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The projection of the image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;Projection&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_resolution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_resolution</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_resolution" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the resolution of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>The resolution of the image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_resolution</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the resolution of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The resolution of the image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()[</span><span class="s2">&quot;GeoTransform&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_set_crs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_set_crs</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">epsg</span><span class="p">)</span></code>


<a href="#leafmap.common.image_set_crs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Define the CRS of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>epsg</code></td>
        <td><code>int</code></td>
        <td><p>The EPSG code of the CRS to set.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_set_crs</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">epsg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Define the CRS of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath</span>
<span class="sd">        epsg (int): The EPSG code of the CRS to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">rasterio.crs</span> <span class="kn">import</span> <span class="n">CRS</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>

    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rds</span><span class="p">:</span>
        <span class="n">rds</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="n">epsg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_size</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_size" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the size (width, height) of an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath or URL.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of (width, height).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_size</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the size (width, height) of an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath or URL.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of (width, height).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_check</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">client</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">image</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">metadata</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sourceSizeX&quot;</span><span class="p">],</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sourceSizeY&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_to_cog" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_to_cog</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dst_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="s1">&#39;deflate&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.image_to_cog" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts an image to a COG file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>A dataset path, URL or rasterio.io.DatasetReader object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dst_path</code></td>
        <td><code>str</code></td>
        <td><p>An output dataset path or or PathLike object. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>profile</code></td>
        <td><code>str</code></td>
        <td><p>COG profile. More at https://cogeotiff.github.io/rio-cogeo/profile. Defaults to "deflate".</p></td>
        <td><code>&#39;deflate&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If rio-cogeo is not installed.</p></td>
      </tr>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the source file could not be found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_to_cog</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dst_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="s2">&quot;deflate&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts an image to a COG file.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): A dataset path, URL or rasterio.io.DatasetReader object.</span>
<span class="sd">        dst_path (str, optional): An output dataset path or or PathLike object. Defaults to None.</span>
<span class="sd">        profile (str, optional): COG profile. More at https://cogeotiff.github.io/rio-cogeo/profile. Defaults to &quot;deflate&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If rio-cogeo is not installed.</span>
<span class="sd">        FileNotFoundError: If the source file could not be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">rio_cogeo.cogeo</span> <span class="kn">import</span> <span class="n">cog_translate</span>
        <span class="kn">from</span> <span class="nn">rio_cogeo.profiles</span> <span class="kn">import</span> <span class="n">cog_profiles</span>

    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;The rio-cogeo package is not installed. Please install it with `pip install rio-cogeo` or `conda install rio-cogeo -c conda-forge`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided input file could not be found.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dst_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">dst_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">source</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_cog.tif&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dst_path</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.tif&quot;</span><span class="p">)</span>

    <span class="n">dst_path</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">dst_path</span><span class="p">)</span>

    <span class="n">dst_profile</span> <span class="o">=</span> <span class="n">cog_profiles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
    <span class="n">cog_translate</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">,</span> <span class="n">dst_profile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.image_to_numpy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_to_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span></code>


<a href="#leafmap.common.image_to_numpy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts an image to a numpy array.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>A dataset path, URL or rasterio.io.DatasetReader object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the provided file could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>np.array</code></td>
      <td><p>A numpy array.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_to_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts an image to a numpy array.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): A dataset path, URL or rasterio.io.DatasetReader object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the provided file could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.array: A numpy array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>

    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>

    <span class="c1"># ... and suppress errors</span>
    <span class="n">gdal</span><span class="o">.</span><span class="n">PushErrorHandler</span><span class="p">(</span><span class="s2">&quot;CPLQuietErrorHandler&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ds</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># read all raster values</span>
        <span class="k">return</span> <span class="n">arr</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.images_to_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">images_to_tiles</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.images_to_tiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a list of images to a dictionary of ipyleaflet.TileLayer objects.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>images</code></td>
        <td><code>str | list</code></td>
        <td><p>The path to a directory of images or a list of image paths.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>names</code></td>
        <td><code>list</code></td>
        <td><p>A list of names for the layers. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional arguments to pass to get_local_tile_layer().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of ipyleaflet.TileLayer objects.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">images_to_tiles</span><span class="p">(</span>
    <span class="n">images</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a list of images to a dictionary of ipyleaflet.TileLayer objects.</span>

<span class="sd">    Args:</span>
<span class="sd">        images (str | list): The path to a directory of images or a list of image paths.</span>
<span class="sd">        names (list, optional): A list of names for the layers. Defaults to None.</span>
<span class="sd">        **kwargs: Additional arguments to pass to get_local_tile_layer().</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of ipyleaflet.TileLayer objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">find_files</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;.tif&quot;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;images must be a list of image paths or a directory&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">image</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;names must have the same length as images&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">image</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">cog_tile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">stac_tile</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tile</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">tiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tile</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.install_package" class="doc doc-heading">
<code class="highlight language-python"><span class="n">install_package</span><span class="p">(</span><span class="n">package</span><span class="p">)</span></code>


<a href="#leafmap.common.install_package" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Install a Python package.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>package</code></td>
        <td><code>str | list</code></td>
        <td><p>The package name or a GitHub URL or a list of package names or GitHub URLs.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">install_package</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Install a Python package.</span>

<span class="sd">    Args:</span>
<span class="sd">        package (str | list): The package name or a GitHub URL or a list of package names or GitHub URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="n">package</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">package</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;https&quot;</span><span class="p">):</span>
            <span class="n">package</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;git+</span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Execute pip install command and show output in real-time</span>
        <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pip install </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>

        <span class="c1"># Print output in real-time</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

        <span class="c1"># Wait for process to complete</span>
        <span class="n">process</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.is_arcpy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_arcpy</span><span class="p">()</span></code>


<a href="#leafmap.common.is_arcpy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check if arcpy is available.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>book</code></td>
      <td><p>True if arcpy is available, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_arcpy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if arcpy is available.</span>

<span class="sd">    Returns:</span>
<span class="sd">        book: True if arcpy is available, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">if</span> <span class="s2">&quot;arcpy&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.is_array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>


<a href="#leafmap.common.is_array" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Test whether x is either a numpy.ndarray or xarray.DataArray</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test whether x is either a numpy.ndarray or xarray.DataArray&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="s2">&quot;xarray&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s2">&quot;xarray&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.is_jupyterlite" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_jupyterlite</span><span class="p">()</span></code>


<a href="#leafmap.common.is_jupyterlite" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check if the current notebook is running on JupyterLite.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>book</code></td>
      <td><p>True if the notebook is running on JupyterLite.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_jupyterlite</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the current notebook is running on JupyterLite.</span>

<span class="sd">    Returns:</span>
<span class="sd">        book: True if the notebook is running on JupyterLite.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">if</span> <span class="s2">&quot;pyodide&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.is_on_aws" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_on_aws</span><span class="p">()</span></code>


<a href="#leafmap.common.is_on_aws" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check if the current notebook is running on AWS.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the notebook is running on AWS.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_on_aws</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the current notebook is running on AWS.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the notebook is running on AWS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">psutil</span>

    <span class="n">on_aws</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">cmdline</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.aws&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;ec2-user&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">on_aws</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">on_aws</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.is_studio_lab" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_studio_lab</span><span class="p">()</span></code>


<a href="#leafmap.common.is_studio_lab" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check if the current notebook is running on Studio Lab.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the notebook is running on Studio Lab.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_studio_lab</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the current notebook is running on Studio Lab.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the notebook is running on Studio Lab.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">psutil</span>

    <span class="n">on_studio_lab</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">cmdline</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;studiolab/bin&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">on_studio_lab</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">on_studio_lab</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.is_tool" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_tool</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>


<a href="#leafmap.common.is_tool" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Check whether <code>name</code> is on PATH and marked as executable.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_tool</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether `name` is on PATH and marked as executable.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.kml_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kml_to_geojson</span><span class="p">(</span><span class="n">in_kml</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.kml_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a KML to GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_kml</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input KML.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_geojson</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output GeoJSON. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The input KML could not be found.</p></td>
      </tr>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>The output must be a GeoJSON.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">kml_to_geojson</span><span class="p">(</span><span class="n">in_kml</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a KML to GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_kml (str): The file path to the input KML.</span>
<span class="sd">        out_geojson (str): The file path to the output GeoJSON. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The input KML could not be found.</span>
<span class="sd">        TypeError: The output must be a GeoJSON.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_kml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_kml</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_kml</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The input KML could not be found.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The output file must be a GeoJSON.&quot;</span><span class="p">)</span>

        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">fiona</span>

    <span class="c1"># import fiona</span>
    <span class="c1"># print(fiona.supported_drivers)</span>
    <span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s2">&quot;KML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rw&quot;</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_kml</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.kml_to_shp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kml_to_shp</span><span class="p">(</span><span class="n">in_kml</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">)</span></code>


<a href="#leafmap.common.kml_to_shp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a KML to shapefile.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_kml</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the input KML.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_shp</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output shapefile.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The input KML could not be found.</p></td>
      </tr>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>The output must be a shapefile.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">kml_to_shp</span><span class="p">(</span><span class="n">in_kml</span><span class="p">,</span> <span class="n">out_shp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a KML to shapefile.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_kml (str): The file path to the input KML.</span>
<span class="sd">        out_shp (str): The file path to the output shapefile.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The input KML could not be found.</span>
<span class="sd">        TypeError: The output must be a shapefile.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_kml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_kml</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_kml</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The input KML could not be found.&quot;</span><span class="p">)</span>

    <span class="n">out_shp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">out_shp</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.shp&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The output must be a shapefile.&quot;</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">fiona</span>

    <span class="c1"># print(fiona.supported_drivers)</span>
    <span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s2">&quot;KML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rw&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_kml</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">out_shp</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.list_palettes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_palettes</span><span class="p">(</span><span class="n">add_extra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lowercase</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.list_palettes" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>List all available colormaps. See a complete lost of colormaps at https://matplotlib.org/stable/tutorials/colors/colormaps.html.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The list of colormap names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">list_palettes</span><span class="p">(</span><span class="n">add_extra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lowercase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all available colormaps. See a complete lost of colormaps at https://matplotlib.org/stable/tutorials/colors/colormaps.html.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of colormap names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">add_extra</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;dem&quot;</span><span class="p">,</span> <span class="s2">&quot;ndvi&quot;</span><span class="p">,</span> <span class="s2">&quot;ndwi&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lowercase</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.lnglat_to_meters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lnglat_to_meters</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">)</span></code>


<a href="#leafmap.common.lnglat_to_meters" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>coordinate conversion between lat/lon in decimal degrees to web mercator</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>longitude</code></td>
        <td><code>float</code></td>
        <td><p>The longitude.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>float</code></td>
        <td><p>The latitude.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of (x, y) in meters.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lnglat_to_meters</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;coordinate conversion between lat/lon in decimal degrees to web mercator</span>

<span class="sd">    Args:</span>
<span class="sd">        longitude (float): The longitude.</span>
<span class="sd">        latitude (float): The latitude.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of (x, y) in meters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="n">origin_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">6378137</span>
    <span class="n">easting</span> <span class="o">=</span> <span class="n">longitude</span> <span class="o">*</span> <span class="n">origin_shift</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="n">northing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">((</span><span class="mi">90</span> <span class="o">+</span> <span class="n">latitude</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">360.0</span><span class="p">))</span> <span class="o">*</span> <span class="n">origin_shift</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">easting</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">easting</span> <span class="o">=</span> <span class="mi">20026376</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">easting</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20026376</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">northing</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">latitude</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">northing</span> <span class="o">=</span> <span class="mi">20048966</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">northing</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20048966</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.local_tile_bands" class="doc doc-heading">
<code class="highlight language-python"><span class="n">local_tile_bands</span><span class="p">(</span><span class="n">source</span><span class="p">)</span></code>


<a href="#leafmap.common.local_tile_bands" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get band names from COG.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | TileClient</code></td>
        <td><p>A local COG file path or TileClient</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of band names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">local_tile_bands</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get band names from COG.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | TileClient): A local COG file path or TileClient</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of band names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_package</span><span class="p">(</span><span class="s2">&quot;localtileserver&quot;</span><span class="p">,</span> <span class="s2">&quot;https://github.com/banesullivan/localtileserver&quot;</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">localtileserver</span> <span class="kn">import</span> <span class="n">TileClient</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">tile_client</span> <span class="o">=</span> <span class="n">TileClient</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">TileClient</span><span class="p">):</span>
        <span class="n">tile_client</span> <span class="o">=</span> <span class="n">source</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;source must be a string or TileClient object.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">band_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.local_tile_pixel_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">local_tile_pixel_value</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">tile_client</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.local_tile_pixel_value" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get pixel value from COG.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>lon</code></td>
        <td><code>float</code></td>
        <td><p>Longitude of the pixel.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>float</code></td>
        <td><p>Latitude of the pixel.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a COG, e.g., 'https://github.com/opengeos/data/releases/download/raster/Libya-2023-07-01.tif'</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bidx</code></td>
        <td><code>str</code></td>
        <td><p>Dataset band indexes (e.g bidx=1, bidx=1&amp;bidx=2&amp;bidx=3). Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz", "planetary-computer", "pc". Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Print status messages. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>PointData</code></td>
      <td><p>rio-tiler point data.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">local_tile_pixel_value</span><span class="p">(</span>
    <span class="n">lon</span><span class="p">,</span>
    <span class="n">lat</span><span class="p">,</span>
    <span class="n">tile_client</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get pixel value from COG.</span>

<span class="sd">    Args:</span>
<span class="sd">        lon (float): Longitude of the pixel.</span>
<span class="sd">        lat (float): Latitude of the pixel.</span>
<span class="sd">        url (str): HTTP URL to a COG, e.g., &#39;https://github.com/opengeos/data/releases/download/raster/Libya-2023-07-01.tif&#39;</span>
<span class="sd">        bidx (str, optional): Dataset band indexes (e.g bidx=1, bidx=1&amp;bidx=2&amp;bidx=3). Defaults to None.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;, &quot;planetary-computer&quot;, &quot;pc&quot;. Defaults to None.</span>
<span class="sd">        verbose (bool, optional): Print status messages. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PointData: rio-tiler point data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">coord_crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.local_tile_vmin_vmax" class="doc doc-heading">
<code class="highlight language-python"><span class="n">local_tile_vmin_vmax</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.local_tile_vmin_vmax" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get vmin and vmax from COG.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | TileClient</code></td>
        <td><p>A local COG file path or TileClient object.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>str | list</code></td>
        <td><p>A list of band names. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If source is not a TileClient object or a local COG file path.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of vmin and vmax.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">local_tile_vmin_vmax</span><span class="p">(</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get vmin and vmax from COG.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | TileClient): A local COG file path or TileClient object.</span>
<span class="sd">        bands (str | list, optional): A list of band names. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If source is not a TileClient object or a local COG file path.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of vmin and vmax.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_package</span><span class="p">(</span><span class="s2">&quot;localtileserver&quot;</span><span class="p">,</span> <span class="s2">&quot;https://github.com/banesullivan/localtileserver&quot;</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">localtileserver</span> <span class="kn">import</span> <span class="n">TileClient</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">tile_client</span> <span class="o">=</span> <span class="n">TileClient</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">TileClient</span><span class="p">):</span>
        <span class="n">tile_client</span> <span class="o">=</span> <span class="n">source</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;source must be a string or TileClient object.&quot;</span><span class="p">)</span>

    <span class="n">bandnames</span> <span class="o">=</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">band_names</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">tile_client</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">statistics</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="n">bands</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="n">bandnames</span>

    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">b</span> <span class="ow">in</span> <span class="n">bandnames</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">):</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">stats</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">stats</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">stats</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bandnames</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">stats</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bandnames</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.make_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_gif</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clean_up</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.make_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates a gif from a list of images.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>images</code></td>
        <td><code>list | str</code></td>
        <td><p>The list of images or input directory to create the gif from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>File path to the output gif.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>The extension of the images. Defaults to 'jpg'.</p></td>
        <td><code>&#39;jpg&#39;</code></td>
      </tr>
      <tr>
        <td><code>fps</code></td>
        <td><code>int</code></td>
        <td><p>The frames per second of the gif. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>The number of times to loop the gif. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the gif to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_gif</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clean_up</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a gif from a list of images.</span>

<span class="sd">    Args:</span>
<span class="sd">        images (list | str): The list of images or input directory to create the gif from.</span>
<span class="sd">        out_gif (str): File path to the output gif.</span>
<span class="sd">        ext (str, optional): The extension of the images. Defaults to &#39;jpg&#39;.</span>
<span class="sd">        fps (int, optional): The frames per second of the gif. Defaults to 10.</span>
<span class="sd">        loop (int, optional): The number of times to loop the gif. Defaults to 0.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the gif to mp4. Defaults to False.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
        <span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No images found in the input directory.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;images must be a list or a path to the image directory.&quot;</span><span class="p">)</span>

    <span class="n">images</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">]</span>
    <span class="n">frame_one</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">frame_one</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">out_gif</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">,</span>
        <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
        <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">),</span>
        <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tool</span><span class="p">(</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_gif</span><span class="p">):</span>
            <span class="n">out_mp4</span> <span class="o">=</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ffmpeg -loglevel error -i </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2"> -vcodec libx264 -crf 25 -pix_fmt yuv420p </span><span class="si">{</span><span class="n">out_mp4</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_mp4</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create mp4 file.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clean_up</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.map_tiles_to_geotiff" class="doc doc-heading">
<code class="highlight language-python"><span class="n">map_tiles_to_geotiff</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;OpenStreetMap&#39;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.map_tiles_to_geotiff" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download map tiles and convert them to a GeoTIFF. The source is adapted from https://github.com/gumblex/tms2geotiff.
    Credits to the GitHub user @gumblex.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output GeoTIFF file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list</code></td>
        <td><p>The bounding box [minx, miny, maxx, maxy] coordinates in EPSG:4326, e.g., [-122.5216, 37.733, -122.3661, 37.8095]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>The map zoom level. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>float</code></td>
        <td><p>The resolution in meters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The tile source. It can be one of the following: "OPENSTREETMAP", "ROADMAP",
"SATELLITE", "TERRAIN", "HYBRID", or an HTTP URL. Defaults to "OpenStreetMap".</p></td>
        <td><code>&#39;OpenStreetMap&#39;</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Convert to Cloud Optimized GeoTIFF. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional arguments to pass to gdal.GetDriverByName("GTiff").Create().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">map_tiles_to_geotiff</span><span class="p">(</span>
    <span class="n">output</span><span class="p">,</span>
    <span class="n">bbox</span><span class="p">,</span>
    <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;OpenStreetMap&quot;</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download map tiles and convert them to a GeoTIFF. The source is adapted from https://github.com/gumblex/tms2geotiff.</span>
<span class="sd">        Credits to the GitHub user @gumblex.</span>

<span class="sd">    Args:</span>
<span class="sd">        output (str): The output GeoTIFF file.</span>
<span class="sd">        bbox (list): The bounding box [minx, miny, maxx, maxy] coordinates in EPSG:4326, e.g., [-122.5216, 37.733, -122.3661, 37.8095]</span>
<span class="sd">        zoom (int, optional): The map zoom level. Defaults to None.</span>
<span class="sd">        resolution (float, optional): The resolution in meters. Defaults to None.</span>
<span class="sd">        source (str, optional): The tile source. It can be one of the following: &quot;OPENSTREETMAP&quot;, &quot;ROADMAP&quot;,</span>
<span class="sd">            &quot;SATELLITE&quot;, &quot;TERRAIN&quot;, &quot;HYBRID&quot;, or an HTTP URL. Defaults to &quot;OpenStreetMap&quot;.</span>
<span class="sd">        crs (str, optional): The coordinate reference system. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        to_cog (bool, optional): Convert to Cloud Optimized GeoTIFF. Defaults to False.</span>
<span class="sd">        quiet (bool, optional): Suppress output. Defaults to False.</span>
<span class="sd">        **kwargs: Additional arguments to pass to gdal.GetDriverByName(&quot;GTiff&quot;).Create().</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">io</span>
    <span class="kn">import</span> <span class="nn">math</span>
    <span class="kn">import</span> <span class="nn">itertools</span>
    <span class="kn">import</span> <span class="nn">concurrent.futures</span>

    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span><span class="p">,</span> <span class="n">osr</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;GDAL is not installed. Install it with pip install GDAL&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">httpx</span>

        <span class="n">SESSION</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">requests</span>

        <span class="n">SESSION</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="n">SESSION</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;*/*&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Accept-Encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;gzip, deflate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">xyz_tiles</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;OPENSTREETMAP&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://tile.openstreetmap.org/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;OpenStreetMap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;OpenStreetMap&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;ROADMAP&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=m&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Maps&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;SATELLITE&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=s&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Satellite&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;TERRAIN&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=p&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Terrain&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;HYBRID&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=y&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Satellite&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">xyz_tiles</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">xyz_tiles</span><span class="p">[</span><span class="n">source</span><span class="o">.</span><span class="n">upper</span><span class="p">()][</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">tiles</span> <span class="o">=</span> <span class="n">basemap_xyz_tiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">tiles</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">url</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;source must be one of &quot;OpenStreetMap&quot;, &quot;ROADMAP&quot;, &quot;SATELLITE&quot;, &quot;TERRAIN&quot;, &quot;HYBRID&quot;, or a URL&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolution_to_zoom_level</span><span class="p">(</span><span class="n">resolution</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert map resolution in meters to zoom level for Web Mercator (EPSG:3857) tiles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Web Mercator tile size in meters at zoom level 0</span>
        <span class="n">initial_resolution</span> <span class="o">=</span> <span class="mf">156543.03392804097</span>

        <span class="c1"># Calculate the zoom level</span>
        <span class="n">zoom_level</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">initial_resolution</span> <span class="o">/</span> <span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoom_level</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">north</span> <span class="o">=</span> <span class="n">bbox</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;bbox must be a list of 4 coordinates in the format of [xmin, ymin, xmax, ymax]&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">zoom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either zoom or resolution must be provided&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zoom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of zoom or resolution can be provided&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zoom</span> <span class="o">=</span> <span class="n">resolution_to_zoom_level</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

    <span class="n">EARTH_EQUATORIAL_RADIUS</span> <span class="o">=</span> <span class="mf">6378137.0</span>

    <span class="n">Image</span><span class="o">.</span><span class="n">MAX_IMAGE_PIXELS</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">gdal</span><span class="o">.</span><span class="n">UseExceptions</span><span class="p">()</span>
    <span class="n">web_mercator</span> <span class="o">=</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">()</span>
    <span class="n">web_mercator</span><span class="o">.</span><span class="n">ImportFromEPSG</span><span class="p">(</span><span class="mi">3857</span><span class="p">)</span>

    <span class="n">WKT_3857</span> <span class="o">=</span> <span class="n">web_mercator</span><span class="o">.</span><span class="n">ExportToWkt</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">from4326_to3857</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">):</span>
        <span class="n">xtile</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span> <span class="o">*</span> <span class="n">EARTH_EQUATORIAL_RADIUS</span>
        <span class="n">ytile</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">45</span> <span class="o">+</span> <span class="n">lat</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)))</span> <span class="o">*</span> <span class="n">EARTH_EQUATORIAL_RADIUS</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">xtile</span><span class="p">,</span> <span class="n">ytile</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">deg2num</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">zoom</span><span class="p">):</span>
        <span class="n">lat_r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">zoom</span>
        <span class="n">xtile</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">ytile</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">lat_r</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_r</span><span class="p">))</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">xtile</span><span class="p">,</span> <span class="n">ytile</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="n">im</span><span class="p">):</span>
        <span class="n">extrema</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">getextrema</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extrema</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extrema</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">extrema</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extrema</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">paste_tile</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">tile</span><span class="p">,</span> <span class="n">corner_xy</span><span class="p">,</span> <span class="n">bbox</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bigim</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">tile</span><span class="p">))</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;RGB&quot;</span> <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGB&quot;</span> <span class="k">else</span> <span class="s2">&quot;RGBA&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">bigim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">base_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">newim</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                <span class="n">mode</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newim</span> <span class="o">=</span> <span class="n">bigim</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corner_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corner_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">xy0</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGB&quot;</span><span class="p">:</span>
            <span class="n">newim</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">xy0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">im</span><span class="p">):</span>
                <span class="n">newim</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">xy0</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newim</span>

    <span class="k">def</span> <span class="nf">finish_picture</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
        <span class="n">xfrac</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yfrac</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">xfrac</span><span class="p">)</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">yfrac</span><span class="p">)</span>
        <span class="n">imgw</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">))</span>
        <span class="n">imgh</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">))</span>
        <span class="n">retim</span> <span class="o">=</span> <span class="n">bigim</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">imgw</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">imgh</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">retim</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGBA&quot;</span> <span class="ow">and</span> <span class="n">retim</span><span class="o">.</span><span class="n">getextrema</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">):</span>
            <span class="n">retim</span> <span class="o">=</span> <span class="n">retim</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
        <span class="n">bigim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">retim</span>

    <span class="k">def</span> <span class="nf">get_tile</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
        <span class="n">retry</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">SESSION</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">retry</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>

    <span class="k">def</span> <span class="nf">draw_tile</span><span class="p">(</span>
        <span class="n">source</span><span class="p">,</span> <span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">,</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">zoom</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">deg2num</span><span class="p">(</span><span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">deg2num</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">])</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x1</span><span class="p">)),</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">y1</span><span class="p">)),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">totalnum</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">corners</span><span class="p">)</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">:</span>
                <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">get_tile</span><span class="p">,</span> <span class="n">source</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>
            <span class="n">bigim</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">base_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">fut</span><span class="p">,</span> <span class="n">corner_xy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">corners</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">bigim</span> <span class="o">=</span> <span class="n">paste_tile</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">fut</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">corner_xy</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded image </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">totalnum</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving GeoTIFF. Please wait...&quot;</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">finish_picture</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">imgbands</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getbands</span><span class="p">())</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="s2">&quot;GTiff&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;options&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;COMPRESS=DEFLATE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PREDICTOR=2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ZLEVEL=9&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TILED=YES&quot;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">gtiff</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">imgbands</span><span class="p">,</span>
            <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Byte</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">xp0</span><span class="p">,</span> <span class="n">yp0</span> <span class="o">=</span> <span class="n">from4326_to3857</span><span class="p">(</span><span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">)</span>
        <span class="n">xp1</span><span class="p">,</span> <span class="n">yp1</span> <span class="o">=</span> <span class="n">from4326_to3857</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">)</span>
        <span class="n">pwidth</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xp1</span> <span class="o">-</span> <span class="n">xp0</span><span class="p">)</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pheight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yp1</span> <span class="o">-</span> <span class="n">yp0</span><span class="p">)</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">gtiff</span><span class="o">.</span><span class="n">SetGeoTransform</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">xp0</span><span class="p">,</span> <span class="n">xp1</span><span class="p">),</span> <span class="n">pwidth</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">yp0</span><span class="p">,</span> <span class="n">yp1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">pheight</span><span class="p">))</span>
        <span class="n">gtiff</span><span class="o">.</span><span class="n">SetProjection</span><span class="p">(</span><span class="n">WKT_3857</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imgbands</span><span class="p">):</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">band</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;u8&quot;</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">band</span> <span class="o">=</span> <span class="n">gtiff</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="n">band</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">band</span><span class="o">.</span><span class="n">WriteArray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">gtiff</span><span class="o">.</span><span class="n">FlushCache</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image saved to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">draw_tile</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">north</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">zoom</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">crs</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;EPSG:3857&quot;</span><span class="p">:</span>
            <span class="n">reproject</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="n">to_cog</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">to_cog</span><span class="p">:</span>
            <span class="n">image_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.mbtiles_to_pmtiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mbtiles_to_pmtiles</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">max_zoom</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span></code>


<a href="#leafmap.common.mbtiles_to_pmtiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts mbtiles to pmtiles using the pmtiles package.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the input .mbtiles file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output .pmtiles file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_zoom</code></td>
        <td><code>int</code></td>
        <td><p>Maximum zoom level for the conversion. Defaults to 99.</p></td>
        <td><code>99</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>The function returns None either upon successful completion or when the pmtiles package is not installed.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mbtiles_to_pmtiles</span><span class="p">(</span>
    <span class="n">input_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_zoom</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">99</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts mbtiles to pmtiles using the pmtiles package.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (str): Path to the input .mbtiles file.</span>
<span class="sd">        output_file (str): Path to the output .pmtiles file.</span>
<span class="sd">        max_zoom (int): Maximum zoom level for the conversion. Defaults to 99.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: The function returns None either upon successful completion or when the pmtiles package is not installed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Any exception raised by pmtiles.convert.mbtiles_to_pmtiles will be propagated up.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pmtiles.convert</span> <span class="k">as</span> <span class="nn">convert</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;pmtiles is not installed. Please install it using `pip install pmtiles`.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">convert</span><span class="o">.</span><span class="n">mbtiles_to_pmtiles</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">maxzoom</span><span class="o">=</span><span class="n">max_zoom</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.merge_gifs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_gifs</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">)</span></code>


<a href="#leafmap.common.merge_gifs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Merge multiple gifs into one.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gifs</code></td>
        <td><code>str | list</code></td>
        <td><p>The input gifs as a list or a directory path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Raise exception when gifsicle is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">merge_gifs</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge multiple gifs into one.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gifs (str | list): The input gifs as a list or a directory path.</span>
<span class="sd">        out_gif (str): The output gif.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception:  Raise exception when gifsicle is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">):</span>
            <span class="n">in_gifs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="s2">&quot;*.gif&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;in_gifs must be a list.&quot;</span><span class="p">)</span>

        <span class="n">in_gifs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">in_gifs</span><span class="p">)</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;gifsicle </span><span class="si">{</span><span class="n">in_gifs</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;gifsicle is not installed. Run &#39;sudo apt-get install -y gifsicle&#39; to install it.&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.merge_rasters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_rasters</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">input_pattern</span><span class="o">=</span><span class="s1">&#39;*.tif&#39;</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;GTiff&#39;</span><span class="p">,</span> <span class="n">output_nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;COMPRESS=DEFLATE&#39;</span><span class="p">])</span></code>


<a href="#leafmap.common.merge_rasters" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Merge a directory of rasters into a single raster.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_dir</code></td>
        <td><code>str</code></td>
        <td><p>The path to the input directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output raster.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>input_pattern</code></td>
        <td><code>str</code></td>
        <td><p>The pattern to match the input files. Defaults to "*.tif".</p></td>
        <td><code>&#39;*.tif&#39;</code></td>
      </tr>
      <tr>
        <td><code>output_format</code></td>
        <td><code>str</code></td>
        <td><p>The output format. Defaults to "GTiff".</p></td>
        <td><code>&#39;GTiff&#39;</code></td>
      </tr>
      <tr>
        <td><code>output_nodata</code></td>
        <td><code>float</code></td>
        <td><p>The output nodata value. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>output_options</code></td>
        <td><code>list</code></td>
        <td><p>A list of output options. Defaults to ["COMPRESS=DEFLATE"].</p></td>
        <td><code>[&#39;COMPRESS=DEFLATE&#39;]</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>Raised if GDAL is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">merge_rasters</span><span class="p">(</span>
    <span class="n">input_dir</span><span class="p">,</span>
    <span class="n">output</span><span class="p">,</span>
    <span class="n">input_pattern</span><span class="o">=</span><span class="s2">&quot;*.tif&quot;</span><span class="p">,</span>
    <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
    <span class="n">output_nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output_options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;COMPRESS=DEFLATE&quot;</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge a directory of rasters into a single raster.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_dir (str): The path to the input directory.</span>
<span class="sd">        output (str): The path to the output raster.</span>
<span class="sd">        input_pattern (str, optional): The pattern to match the input files. Defaults to &quot;*.tif&quot;.</span>
<span class="sd">        output_format (str, optional): The output format. Defaults to &quot;GTiff&quot;.</span>
<span class="sd">        output_nodata (float, optional): The output nodata value. Defaults to None.</span>
<span class="sd">        output_options (list, optional): A list of output options. Defaults to [&quot;COMPRESS=DEFLATE&quot;].</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: Raised if GDAL is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">glob</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;GDAL is required to use this function. Install it with `conda install gdal -c conda-forge`&quot;</span>
        <span class="p">)</span>
    <span class="c1"># Get a list of all the input files</span>
    <span class="n">input_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">input_pattern</span><span class="p">))</span>

    <span class="c1"># Merge the input files into a single output file</span>
    <span class="n">gdal</span><span class="o">.</span><span class="n">Warp</span><span class="p">(</span>
        <span class="n">output</span><span class="p">,</span>
        <span class="n">input_files</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
        <span class="n">dstNodata</span><span class="o">=</span><span class="n">output_nodata</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">output_options</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.merge_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge_vector</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;geojson&#39;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_gdf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.merge_vector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Merge vector files into a single GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>files</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>A string or a list of file paths to be merged.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The file path to save the merged GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>Optional. The coordinate reference system (CRS) of the output GeoDataFrame.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>Optional. The file extension of the input files. Default is 'geojson'.</p></td>
        <td><code>&#39;geojson&#39;</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, search for files recursively in subdirectories. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, suppresses progress messages. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>return_gdf</code></td>
        <td><code>bool</code></td>
        <td><p>Optional. If True, returns the merged GeoDataFrame. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the <code>gpd.read_file</code> function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>If <code>return_gdf</code> is True, returns the merged GeoDataFrame. Otherwise, returns None.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>If <code>files</code> is not a list of file paths.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">merge_vector</span><span class="p">(</span>
    <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_gdf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge vector files into a single GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        files: A string or a list of file paths to be merged.</span>
<span class="sd">        output: The file path to save the merged GeoDataFrame.</span>
<span class="sd">        crs: Optional. The coordinate reference system (CRS) of the output GeoDataFrame.</span>
<span class="sd">        ext: Optional. The file extension of the input files. Default is &#39;geojson&#39;.</span>
<span class="sd">        recursive: Optional. If True, search for files recursively in subdirectories. Default is False.</span>
<span class="sd">        quiet: Optional. If True, suppresses progress messages. Default is False.</span>
<span class="sd">        return_gdf: Optional. If True, returns the merged GeoDataFrame. Default is False.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the `gpd.read_file` function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If `return_gdf` is True, returns the merged GeoDataFrame. Otherwise, returns None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `files` is not a list of file paths.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">find_files</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;files must be a list of file paths&quot;</span><span class="p">)</span>

    <span class="n">gdfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reading </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span>
        <span class="n">gdfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merging GeoDataFrames ...&quot;</span><span class="p">)</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gdfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving merged file to </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>
    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved merged file to </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_gdf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.meters_to_lnglat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">meters_to_lnglat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


<a href="#leafmap.common.meters_to_lnglat" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>coordinate conversion between web mercator to lat/lon in decimal degrees</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>float</code></td>
        <td><p>The x coordinate.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>float</code></td>
        <td><p>The y coordinate.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>A tuple of (longitude, latitude) in decimal degrees.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">meters_to_lnglat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;coordinate conversion between web mercator to lat/lon in decimal degrees</span>

<span class="sd">    Args:</span>
<span class="sd">        x (float): The x coordinate.</span>
<span class="sd">        y (float): The y coordinate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of (longitude, latitude) in decimal degrees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="n">origin_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">6378137</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">origin_shift</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span>
    <span class="n">latitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">origin_shift</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span>
    <span class="n">latitude</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">latitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.mosaic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mosaic</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;tif&#39;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">merge_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.mosaic" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Mosaics a list of images into a single image. Inspired by https://bit.ly/3A6roDK.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>images</code></td>
        <td><code>str | list</code></td>
        <td><p>An input directory containing images or a list of images.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output image filepath.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>The file extension of the images. Defaults to 'tif'.</p></td>
        <td><code>&#39;tif&#39;</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to recursively search for images in the input directory. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>merge_args</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of arguments to pass to the rasterio.merge function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the output image to a Cloud Optimized GeoTIFF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mosaic</span><span class="p">(</span>
    <span class="n">images</span><span class="p">,</span>
    <span class="n">output</span><span class="p">,</span>
    <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span>
    <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">merge_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mosaics a list of images into a single image. Inspired by https://bit.ly/3A6roDK.</span>

<span class="sd">    Args:</span>
<span class="sd">        images (str | list): An input directory containing images or a list of images.</span>
<span class="sd">        output (str): The output image filepath.</span>
<span class="sd">        ext (str, optional): The file extension of the images. Defaults to &#39;tif&#39;.</span>
<span class="sd">        recursive (bool, optional): Whether to recursively search for images in the input directory. Defaults to True.</span>
<span class="sd">        merge_args (dict, optional): A dictionary of arguments to pass to the rasterio.merge function. Defaults to {}.</span>
<span class="sd">        to_cog (bool, optional): Whether to convert the output image to a Cloud Optimized GeoTIFF. Defaults to True.</span>
<span class="sd">        verbose (bool, optional): Whether to print progress. Defaults to True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">rasterio.merge</span> <span class="kn">import</span> <span class="n">merge</span>
    <span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
    <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">raster_files</span> <span class="o">=</span> <span class="n">find_files</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">ext</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">raster_files</span> <span class="o">=</span> <span class="n">images</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;images must be a list of raster files.&quot;</span><span class="p">)</span>

    <span class="n">raster_to_mosiac</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raster_files</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reading </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">raster_files</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">raster_to_mosiac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merging rasters...&quot;</span><span class="p">)</span>
    <span class="n">arr</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">raster_to_mosiac</span><span class="p">,</span> <span class="o">**</span><span class="n">merge_args</span><span class="p">)</span>

    <span class="n">output_meta</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">output_meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
            <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="n">transform</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">output_meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">to_cog</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converting to COG...&quot;</span><span class="p">)</span>
        <span class="n">image_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved mosaic to </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.mosaic_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mosaic_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.mosaic_bounds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the bounding box of a MosaicJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a MosaicJSON.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of values representing [left, bottom, right, top]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mosaic_bounds</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the bounding box of a MosaicJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): HTTP URL to a MosaicJSON.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of values representing [left, bottom, right, top]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">titiler_endpoint</span> <span class="o">=</span> <span class="n">check_titiler_endpoint</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url must be a string and start with http.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">titiler_endpoint</span><span class="si">}</span><span class="s2">/mosaicjson/bounds&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;titiler_endpoint must be a string.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.mosaic_info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mosaic_info</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.mosaic_info" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the info of a MosaicJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a MosaicJSON.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary containing bounds, center, minzoom, maxzoom, and name as keys.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mosaic_info</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the info of a MosaicJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): HTTP URL to a MosaicJSON.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing bounds, center, minzoom, maxzoom, and name as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">titiler_endpoint</span> <span class="o">=</span> <span class="n">check_titiler_endpoint</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url must be a string and start with http.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">titiler_endpoint</span><span class="si">}</span><span class="s2">/mosaicjson/info&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;titiler_endpoint must be a string.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.mosaic_info_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mosaic_info_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.mosaic_info_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the info of a MosaicJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a MosaicJSON.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary representing a dict of GeoJSON.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mosaic_info_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the info of a MosaicJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): HTTP URL to a MosaicJSON.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary representing a dict of GeoJSON.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">titiler_endpoint</span> <span class="o">=</span> <span class="n">check_titiler_endpoint</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url must be a string and start with http.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">titiler_endpoint</span><span class="si">}</span><span class="s2">/mosaicjson/info.geojson&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;titiler_endpoint must be a string.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.mosaic_tile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mosaic_tile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.mosaic_tile" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Get the tile URL from a MosaicJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>HTTP URL to a MosaicJSON.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>titiler_endpoint</code></td>
        <td><code>str</code></td>
        <td><p>Titiler endpoint, e.g., "https://titiler.xyz". Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The tile URL.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mosaic_tile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the tile URL from a MosaicJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): HTTP URL to a MosaicJSON.</span>
<span class="sd">        titiler_endpoint (str, optional): Titiler endpoint, e.g., &quot;https://titiler.xyz&quot;. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The tile URL.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">titiler_endpoint</span> <span class="o">=</span> <span class="n">check_titiler_endpoint</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url must be a string and start with http.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">titiler_endpoint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">titiler_endpoint</span><span class="si">}</span><span class="s2">/mosaicjson/tilejson.json&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;titiler_endpoint must be a string.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;tiles&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.nasa_data_download" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nasa_data_download</span><span class="p">(</span><span class="n">granules</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">provider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></code>


<a href="#leafmap.common.nasa_data_download" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Downloads NASA Earthdata granules.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>granules</code></td>
        <td><code>List[dict]</code></td>
        <td><p>The granules to download.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The output directory where the granules will be downloaded. Defaults to None (current directory).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>provider</code></td>
        <td><code>str</code></td>
        <td><p>The provider of the granules.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>threads</code></td>
        <td><code>int</code></td>
        <td><p>The number of threads to use for downloading. Defaults to 8.</p></td>
        <td><code>8</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nasa_data_download</span><span class="p">(</span>
    <span class="n">granules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
    <span class="n">out_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">provider</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads NASA Earthdata granules.</span>

<span class="sd">    Args:</span>
<span class="sd">        granules (List[dict]): The granules to download.</span>
<span class="sd">        out_dir (str, optional): The output directory where the granules will be downloaded. Defaults to None (current directory).</span>
<span class="sd">        provider (str, optional): The provider of the granules.</span>
<span class="sd">        threads (int, optional): The number of threads to use for downloading. Defaults to 8.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">earthaccess</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">earthaccess</span><span class="o">.</span><span class="n">download</span><span class="p">(</span>
        <span class="n">granules</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">provider</span><span class="o">=</span><span class="n">provider</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.nasa_data_granules_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nasa_data_granules_to_gdf</span><span class="p">(</span><span class="n">granules</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.nasa_data_granules_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts granules data to a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>granules</code></td>
        <td><code>List[dict]</code></td>
        <td><p>A list of granules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system (CRS) of the GeoDataFrame. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to save the GeoDataFrame as a file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments for the gpd.GeoDataFrame.to_file() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>gpd.GeoDataFrame</code></td>
      <td><p>The resulting GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nasa_data_granules_to_gdf</span><span class="p">(</span>
    <span class="n">granules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts granules data to a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        granules (List[dict]): A list of granules.</span>
<span class="sd">        crs (str, optional): The coordinate reference system (CRS) of the GeoDataFrame. Defaults to &quot;EPSG:4326&quot;.</span>
<span class="sd">        output (str, optional): The output file path to save the GeoDataFrame as a file. Defaults to None.</span>
<span class="sd">        **kwargs: Additional keyword arguments for the gpd.GeoDataFrame.to_file() function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpd.GeoDataFrame: The resulting GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">box</span><span class="p">,</span> <span class="n">Polygon</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">granules</span><span class="p">])</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Version&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_bbox</span><span class="p">(</span><span class="n">rectangles</span><span class="p">):</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">rectangle</span><span class="p">[</span><span class="s2">&quot;WestBoundingCoordinate&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">rectangle</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">)</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">rectangle</span><span class="p">[</span><span class="s2">&quot;SouthBoundingCoordinate&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">rectangle</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">)</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rectangle</span><span class="p">[</span><span class="s2">&quot;EastBoundingCoordinate&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">rectangle</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">)</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rectangle</span><span class="p">[</span><span class="s2">&quot;NorthBoundingCoordinate&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">rectangle</span> <span class="ow">in</span> <span class="n">rectangles</span><span class="p">)</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bbox</span>

    <span class="k">def</span> <span class="nf">get_polygon</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
        <span class="c1"># Extract the points from the dictionary</span>
        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="s2">&quot;Longitude&quot;</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="s2">&quot;Latitude&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;Boundary&quot;</span><span class="p">][</span><span class="s2">&quot;Points&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="c1"># Create a Polygon</span>
        <span class="n">polygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">polygon</span>

    <span class="k">if</span> <span class="s2">&quot;BoundingRectangles&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;BoundingRectangles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_bbox</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
    <span class="k">elif</span> <span class="s2">&quot;GPolygons&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;GPolygons&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_polygon</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gdf</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">gdf</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.nasa_data_login" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nasa_data_login</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.nasa_data_login" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Logs in to NASA Earthdata.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>strategy</code></td>
        <td><code>str</code></td>
        <td><p>The authentication method.
   "all": (default) try all methods until one works
    "interactive": enter username and password.
    "netrc": retrieve username and password from ~/.netrc.
    "environment": retrieve username and password from $EARTHDATA_USERNAME and $EARTHDATA_PASSWORD.
persist (bool, optional): Whether to persist credentials in a .netrc file. Defaults to False.</p></td>
        <td><code>&#39;all&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments for the earthaccess.login() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nasa_data_login</span><span class="p">(</span><span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">persist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Logs in to NASA Earthdata.</span>

<span class="sd">    Args:</span>
<span class="sd">        strategy (str, optional): The authentication method.</span>
<span class="sd">               &quot;all&quot;: (default) try all methods until one works</span>
<span class="sd">                &quot;interactive&quot;: enter username and password.</span>
<span class="sd">                &quot;netrc&quot;: retrieve username and password from ~/.netrc.</span>
<span class="sd">                &quot;environment&quot;: retrieve username and password from $EARTHDATA_USERNAME and $EARTHDATA_PASSWORD.</span>
<span class="sd">           persist (bool, optional): Whether to persist credentials in a .netrc file. Defaults to False.</span>
<span class="sd">        **kwargs: Additional keyword arguments for the earthaccess.login() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">earthaccess</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">install_package</span><span class="p">(</span><span class="s2">&quot;earthaccess&quot;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">earthaccess</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">earthaccess</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="n">persist</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Please login to Earthdata first. Register at https://urs.earthdata.nasa.gov&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.nasa_data_search" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nasa_data_search</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">short_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temporal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">daac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">provider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">return_gdf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.nasa_data_search" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Searches for NASA Earthdata granules.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>count</code></td>
        <td><code>int</code></td>
        <td><p>The number of granules to retrieve. Defaults to -1 (retrieve all).</p></td>
        <td><code>-1</code></td>
      </tr>
      <tr>
        <td><code>short_name</code></td>
        <td><code>str</code></td>
        <td><p>The short name of the dataset.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>List[float]</code></td>
        <td><p>The bounding box coordinates [xmin, ymin, xmax, ymax].</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>temporal</code></td>
        <td><code>str</code></td>
        <td><p>The temporal extent of the data.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>version</code></td>
        <td><code>str</code></td>
        <td><p>The version of the dataset.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>doi</code></td>
        <td><code>str</code></td>
        <td><p>The Digital Object Identifier (DOI) of the dataset.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>daac</code></td>
        <td><code>str</code></td>
        <td><p>The Distributed Active Archive Center (DAAC) of the dataset.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>provider</code></td>
        <td><code>str</code></td>
        <td><p>The provider of the dataset.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to save the GeoDataFrame as a file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system (CRS) of the GeoDataFrame. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>return_gdf</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the GeoDataFrame in addition to the granules. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments for the earthaccess.search_data() function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[List[dict], tuple]</code></td>
      <td><p>The retrieved granules. If return_gdf is True, also returns the resulting GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nasa_data_search</span><span class="p">(</span>
    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">short_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bbox</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">temporal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">doi</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">daac</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">provider</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
    <span class="n">return_gdf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for NASA Earthdata granules.</span>

<span class="sd">    Args:</span>
<span class="sd">        count (int, optional): The number of granules to retrieve. Defaults to -1 (retrieve all).</span>
<span class="sd">        short_name (str, optional): The short name of the dataset.</span>
<span class="sd">        bbox (List[float], optional): The bounding box coordinates [xmin, ymin, xmax, ymax].</span>
<span class="sd">        temporal (str, optional): The temporal extent of the data.</span>
<span class="sd">        version (str, optional): The version of the dataset.</span>
<span class="sd">        doi (str, optional): The Digital Object Identifier (DOI) of the dataset.</span>
<span class="sd">        daac (str, optional): The Distributed Active Archive Center (DAAC) of the dataset.</span>
<span class="sd">        provider (str, optional): The provider of the dataset.</span>
<span class="sd">        output (str, optional): The output file path to save the GeoDataFrame as a file.</span>
<span class="sd">        crs (str, optional): The coordinate reference system (CRS) of the GeoDataFrame. Defaults to &quot;EPSG:4326&quot;.</span>
<span class="sd">        return_gdf (bool, optional): Whether to return the GeoDataFrame in addition to the granules. Defaults to False.</span>
<span class="sd">        **kwargs: Additional keyword arguments for the earthaccess.search_data() function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[List[dict], tuple]: The retrieved granules. If return_gdf is True, also returns the resulting GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">earthaccess</span>

    <span class="k">if</span> <span class="n">short_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;short_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">short_name</span>
    <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bounding_box&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bbox</span>
    <span class="k">if</span> <span class="n">temporal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;temporal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temporal</span>
    <span class="k">if</span> <span class="n">version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>
    <span class="k">if</span> <span class="n">doi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;doi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">doi</span>
    <span class="k">if</span> <span class="n">daac</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;daac&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daac</span>
    <span class="k">if</span> <span class="n">provider</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;provider&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">provider</span>

    <span class="n">granules</span> <span class="o">=</span> <span class="n">earthaccess</span><span class="o">.</span><span class="n">search_data</span><span class="p">(</span>
        <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nasa_data_granules_to_gdf</span><span class="p">(</span><span class="n">granules</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_gdf</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">nasa_data_granules_to_gdf</span><span class="p">(</span><span class="n">granules</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">granules</span><span class="p">,</span> <span class="n">gdf</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">granules</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.nasa_datasets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nasa_datasets</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_short_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.nasa_datasets" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Searches for NASA datasets based on a keyword in a DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>keyword</code></td>
        <td><code>str</code></td>
        <td><p>The keyword to search for. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>The DataFrame to search in. If None, it will download the NASA dataset CSV from GitHub. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_short_name</code></td>
        <td><code>bool</code></td>
        <td><p>If True, only returns the list of short names of the matched datasets. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[pd.DataFrame, List[str]]</code></td>
      <td><p>Filtered DataFrame if return_short_name is False, otherwise a list of short names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">nasa_datasets</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_short_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Searches for NASA datasets based on a keyword in a DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        keyword (str, optional): The keyword to search for. Defaults to None.</span>
<span class="sd">        df (pd.DataFrame, optional): The DataFrame to search in. If None, it will download the NASA dataset CSV from GitHub. Defaults to None.</span>
<span class="sd">        return_short_name (bool, optional): If True, only returns the list of short names of the matched datasets. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[pd.DataFrame, List[str]]: Filtered DataFrame if return_short_name is False, otherwise a list of short names.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/NASA-Earth-Data/raw/main/nasa_earth_data.tsv&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">keyword</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Convert keyword and DataFrame values to lowercase</span>
        <span class="n">keyword_lower</span> <span class="o">=</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">df_lower</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

        <span class="c1"># Use boolean indexing to filter the DataFrame</span>
        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
            <span class="n">df_lower</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">keyword_lower</span> <span class="ow">in</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_short_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;ShortName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filtered_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_short_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ShortName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.netcdf_tile_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">netcdf_tile_layer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">,</span> <span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;NetCDF layer&#39;</span><span class="p">,</span> <span class="n">return_client</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.netcdf_tile_layer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generate an ipyleaflet/folium TileLayer from a netCDF file.
    If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer),
    try adding to following two lines to the beginning of the notebook if the raster does not render properly.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>import os
os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = f&#39;{os.environ[&#39;JUPYTERHUB_SERVICE_PREFIX&#39;].lstrip(&#39;/&#39;)}/proxy/{{port}}&#39;
</code></pre></div></td></tr></table></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>File path or HTTP URL to the netCDF file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>variables</code></td>
        <td><code>int</code></td>
        <td><p>The variable/band names to extract data from the netCDF file. Defaults to None. If None, all variables will be extracted.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>str</code></td>
        <td><p>The port to use for the server. Defaults to "default".</p></td>
        <td><code>&#39;default&#39;</code></td>
      </tr>
      <tr>
        <td><code>colormap</code></td>
        <td><code>str</code></td>
        <td><p>The name of the colormap from <code>matplotlib</code> to use when plotting a single band. See https://matplotlib.org/stable/gallery/color/colormap_reference.html. Default is greyscale.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to use when colormapping the colormap when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to use when colormapping the colormap when plotting a single band. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>The value from the band to use to interpret as not valid data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>debug</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the server will be started in debug mode. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>projection</code></td>
        <td><code>str</code></td>
        <td><p>The projection of the GeoTIFF. Defaults to "EPSG:3857".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The tile layer format. Can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
      <tr>
        <td><code>layer_name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to "NetCDF layer".</p></td>
        <td><code>&#39;NetCDF layer&#39;</code></td>
      </tr>
      <tr>
        <td><code>return_client</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the tile client will be returned. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>shift_lon</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>str</code></td>
        <td><p>Name of the latitude variable. Defaults to 'lat'.</p></td>
        <td><code>&#39;lat&#39;</code></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>str</code></td>
        <td><p>Name of the longitude variable. Defaults to 'lon'.</p></td>
        <td><code>&#39;lon&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ipyleaflet.TileLayer | folium.TileLayer</code></td>
      <td><p>An ipyleaflet.TileLayer or folium.TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">netcdf_tile_layer</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">attribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
    <span class="n">layer_name</span><span class="o">=</span><span class="s2">&quot;NetCDF layer&quot;</span><span class="p">,</span>
    <span class="n">return_client</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">lat</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
    <span class="n">lon</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an ipyleaflet/folium TileLayer from a netCDF file.</span>
<span class="sd">        If you are using this function in JupyterHub on a remote server (e.g., Binder, Microsoft Planetary Computer),</span>
<span class="sd">        try adding to following two lines to the beginning of the notebook if the raster does not render properly.</span>

<span class="sd">        import os</span>
<span class="sd">        os.environ[&#39;LOCALTILESERVER_CLIENT_PREFIX&#39;] = f&#39;{os.environ[&#39;JUPYTERHUB_SERVICE_PREFIX&#39;].lstrip(&#39;/&#39;)}/proxy/{{port}}&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): File path or HTTP URL to the netCDF file.</span>
<span class="sd">        variables (int, optional): The variable/band names to extract data from the netCDF file. Defaults to None. If None, all variables will be extracted.</span>
<span class="sd">        port (str, optional): The port to use for the server. Defaults to &quot;default&quot;.</span>
<span class="sd">        colormap (str, optional): The name of the colormap from `matplotlib` to use when plotting a single band. See https://matplotlib.org/stable/gallery/color/colormap_reference.html. Default is greyscale.</span>
<span class="sd">        vmin (float, optional): The minimum value to use when colormapping the colormap when plotting a single band. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to use when colormapping the colormap when plotting a single band. Defaults to None.</span>
<span class="sd">        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.</span>
<span class="sd">        debug (bool, optional): If True, the server will be started in debug mode. Defaults to False.</span>
<span class="sd">        projection (str, optional): The projection of the GeoTIFF. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        attribution (str, optional): Attribution for the source raster. This defaults to a message about it being a local file.. Defaults to None.</span>
<span class="sd">        tile_format (str, optional): The tile layer format. Can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>
<span class="sd">        layer_name (str, optional): The layer name to use. Defaults to &quot;NetCDF layer&quot;.</span>
<span class="sd">        return_client (bool, optional): If True, the tile client will be returned. Defaults to False.</span>
<span class="sd">        shift_lon (bool, optional): Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</span>
<span class="sd">        lat (str, optional): Name of the latitude variable. Defaults to &#39;lat&#39;.</span>
<span class="sd">        lon (str, optional): Name of the longitude variable. Defaults to &#39;lon&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ipyleaflet.TileLayer | folium.TileLayer: An ipyleaflet.TileLayer or folium.TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">check_package</span><span class="p">(</span>
        <span class="s2">&quot;localtileserver&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://github.com/banesullivan/localtileserver&quot;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">)</span>

    <span class="n">xds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">shift_lon</span><span class="p">:</span>
        <span class="n">xds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">lon</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">xds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">lon</span><span class="p">]</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">-</span> <span class="mi">180</span>
        <span class="n">xds</span> <span class="o">=</span> <span class="n">xds</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">xds</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>

    <span class="n">allowed_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">variables</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_vars</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s2"> is not a subset of </span><span class="si">{</span><span class="n">allowed_vars</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">variables</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only 3 variables can be plotted at a time.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">allowed_vars</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s2"> must be a subset of </span><span class="si">{</span><span class="n">allowed_vars</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">xds</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">to_raster</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">allowed_vars</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">band_idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">allowed_vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>

    <span class="n">tile_layer</span> <span class="o">=</span> <span class="n">get_local_tile_layer</span><span class="p">(</span>
        <span class="n">output</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
        <span class="n">indexes</span><span class="o">=</span><span class="n">band_idx</span><span class="p">,</span>
        <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
        <span class="n">attribution</span><span class="o">=</span><span class="n">attribution</span><span class="p">,</span>
        <span class="n">tile_format</span><span class="o">=</span><span class="n">tile_format</span><span class="p">,</span>
        <span class="n">layer_name</span><span class="o">=</span><span class="n">layer_name</span><span class="p">,</span>
        <span class="n">return_client</span><span class="o">=</span><span class="n">return_client</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">tile_layer</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.netcdf_to_tif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">netcdf_to_tif</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">lev</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span> <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;epsg:4326&#39;</span><span class="p">,</span> <span class="n">return_vars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.netcdf_to_tif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a netcdf file to a GeoTIFF file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>Path to the netcdf file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output GeoTIFF file. Defaults to None. If None, the output file will be the same as the input file with the extension changed to .tif.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>variables</code></td>
        <td><code>str | list</code></td>
        <td><p>Name of the variable or a list of variables to extract. Defaults to None. If None, all variables will be extracted.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>shift_lon</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td><code>str</code></td>
        <td><p>Name of the latitude variable. Defaults to 'lat'.</p></td>
        <td><code>&#39;lat&#39;</code></td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td><code>str</code></td>
        <td><p>Name of the longitude variable. Defaults to 'lon'.</p></td>
        <td><code>&#39;lon&#39;</code></td>
      </tr>
      <tr>
        <td><code>lev</code></td>
        <td><code>str</code></td>
        <td><p>Name of the level variable. Defaults to 'lev'.</p></td>
        <td><code>&#39;lev&#39;</code></td>
      </tr>
      <tr>
        <td><code>level_index</code></td>
        <td><code>int</code></td>
        <td><p>Index of the level dimension. Defaults to 0'.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>time</code></td>
        <td><code>int</code></td>
        <td><p>Index of the time dimension. Defaults to 0'.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. Defaults to 'epsg:4326'.</p></td>
        <td><code>&#39;epsg:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>return_vars</code></td>
        <td><code>bool</code></td>
        <td><p>Flag to return all variables. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the xarray or rioxarray package is not installed.</p></td>
      </tr>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the netcdf file is not found.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the variable is not found in the netcdf file.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">netcdf_to_tif</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">shift_lon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">lat</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
    <span class="n">lon</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
    <span class="n">lev</span><span class="o">=</span><span class="s2">&quot;lev&quot;</span><span class="p">,</span>
    <span class="n">level_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">,</span>
    <span class="n">return_vars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a netcdf file to a GeoTIFF file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): Path to the netcdf file.</span>
<span class="sd">        output (str, optional): Path to the output GeoTIFF file. Defaults to None. If None, the output file will be the same as the input file with the extension changed to .tif.</span>
<span class="sd">        variables (str | list, optional): Name of the variable or a list of variables to extract. Defaults to None. If None, all variables will be extracted.</span>
<span class="sd">        shift_lon (bool, optional): Flag to shift longitude values from [0, 360] to the range [-180, 180]. Defaults to True.</span>
<span class="sd">        lat (str, optional): Name of the latitude variable. Defaults to &#39;lat&#39;.</span>
<span class="sd">        lon (str, optional): Name of the longitude variable. Defaults to &#39;lon&#39;.</span>
<span class="sd">        lev (str, optional): Name of the level variable. Defaults to &#39;lev&#39;.</span>
<span class="sd">        level_index (int, optional): Index of the level dimension. Defaults to 0&#39;.</span>
<span class="sd">        time (int, optional): Index of the time dimension. Defaults to 0&#39;.</span>
<span class="sd">        crs (str, optional): The coordinate reference system. Defaults to &#39;epsg:4326&#39;.</span>
<span class="sd">        return_vars (bool, optional): Flag to return all variables. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the xarray or rioxarray package is not installed.</span>
<span class="sd">        FileNotFoundError: If the netcdf file is not found.</span>
<span class="sd">        ValueError: If the variable is not found in the netcdf file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;.nc4&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;The output file must be a netCDF with extension .nc or .nc4.&quot;</span>
            <span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="s2">&quot;.tif&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="n">xds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xds</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="n">xds</span> <span class="o">=</span> <span class="n">xds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lev</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="n">xds</span> <span class="o">=</span> <span class="n">xds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lev</span><span class="o">=</span><span class="n">level_index</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">shift_lon</span><span class="p">:</span>
        <span class="n">xds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">lon</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">xds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">lon</span><span class="p">]</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">-</span> <span class="mi">180</span>
        <span class="n">xds</span> <span class="o">=</span> <span class="n">xds</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">xds</span><span class="p">[</span><span class="n">lon</span><span class="p">])</span>

    <span class="n">allowed_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">variables</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_vars</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s2"> is not a valid variable.&quot;</span><span class="p">)</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">variables</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">allowed_vars</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s2"> must be a subset of </span><span class="si">{</span><span class="n">allowed_vars</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xds</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">to_raster</span><span class="p">(</span>
            <span class="n">output</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xds</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span>
            <span class="n">crs</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">to_raster</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_vars</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output</span><span class="p">,</span> <span class="n">allowed_vars</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.numpy_to_cog" class="doc doc-heading">
<code class="highlight language-python"><span class="n">numpy_to_cog</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="n">out_cog</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coord_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.numpy_to_cog" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a numpy array to a COG file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>np_array</code></td>
        <td><code>np.array</code></td>
        <td><p>A numpy array representing an image or an HTTP URL to an image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_cog</code></td>
        <td><code>str</code></td>
        <td><p>The output COG file path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bounds</code></td>
        <td><code>tuple</code></td>
        <td><p>The bounds of the image in the format of (minx, miny, maxx, maxy). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>profile</code></td>
        <td><code>str | dict</code></td>
        <td><p>File path to an existing COG file or a dictionary representing the profile. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dtype</code></td>
        <td><code>str</code></td>
        <td><p>The data type of the output COG file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system of the output COG file. Defaults to "epsg:4326".</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>coord_crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system of bbox coordinates. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">numpy_to_cog</span><span class="p">(</span>
    <span class="n">np_array</span><span class="p">,</span>
    <span class="n">out_cog</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">profile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">coord_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a numpy array to a COG file.</span>

<span class="sd">    Args:</span>
<span class="sd">        np_array (np.array): A numpy array representing an image or an HTTP URL to an image.</span>
<span class="sd">        out_cog (str): The output COG file path.</span>
<span class="sd">        bounds (tuple, optional): The bounds of the image in the format of (minx, miny, maxx, maxy). Defaults to None.</span>
<span class="sd">        profile (str | dict, optional): File path to an existing COG file or a dictionary representing the profile. Defaults to None.</span>
<span class="sd">        dtype (str, optional): The data type of the output COG file. Defaults to None.</span>
<span class="sd">        dst_crs (str, optional): The coordinate reference system of the output COG file. Defaults to &quot;epsg:4326&quot;.</span>
<span class="sd">        coord_crs (str, optional): The coordinate reference system of bbox coordinates. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="kn">from</span> <span class="nn">rasterio.io</span> <span class="kn">import</span> <span class="n">MemoryFile</span>
    <span class="kn">from</span> <span class="nn">rasterio.transform</span> <span class="kn">import</span> <span class="n">from_bounds</span>

    <span class="kn">from</span> <span class="nn">rio_cogeo.cogeo</span> <span class="kn">import</span> <span class="n">cog_translate</span>
    <span class="kn">from</span> <span class="nn">rio_cogeo.profiles</span> <span class="kn">import</span> <span class="n">cog_profiles</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ds</span><span class="p">:</span>
            <span class="n">np_array</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The input array must be a numpy array.&quot;</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_cog</span><span class="p">)</span>
    <span class="n">check_dir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">profile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">profile</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">profile</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided file could not be found.&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span> <span class="k">as</span> <span class="n">ds</span><span class="p">:</span>
                <span class="n">dst_crs</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">crs</span>
                <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">bounds</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">Profile</span><span class="p">):</span>
            <span class="n">profile</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided profile must be a file path or a dictionary.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;warning: bounds is not set. Using the default bounds (-180.0, -85.0511, 180.0, 85.0511)&quot;</span>
        <span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">85.0511287798066</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">85.0511287798066</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided bounds must be a tuple of length 4.&quot;</span><span class="p">)</span>

    <span class="c1"># Rasterio uses numpy array of shape of `(bands, height, width)`</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">nbands</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">nbands</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input array must be a 2D or 3D numpy array.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">coord_crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dst_crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">transform_bbox_coords</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">coord_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">)</span>

    <span class="n">src_transform</span> <span class="o">=</span> <span class="n">from_bounds</span><span class="p">(</span><span class="o">*</span><span class="n">bounds</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np_array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dst_crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dst_crs</span> <span class="o">=</span> <span class="s2">&quot;epsg:4326&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">src_profile</span> <span class="o">=</span> <span class="n">profile</span>
        <span class="n">src_profile</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbands</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">src_profile</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
            <span class="n">count</span><span class="o">=</span><span class="n">nbands</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="n">dst_crs</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">src_transform</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="n">MemoryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">memfile</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">memfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">**</span><span class="n">src_profile</span><span class="p">)</span> <span class="k">as</span> <span class="n">mem</span><span class="p">:</span>
            <span class="c1"># Populate the input file with numpy array</span>
            <span class="n">mem</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>

            <span class="n">dst_profile</span> <span class="o">=</span> <span class="n">cog_profiles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deflate&quot;</span><span class="p">)</span>
            <span class="n">cog_translate</span><span class="p">(</span>
                <span class="n">mem</span><span class="p">,</span>
                <span class="n">out_cog</span><span class="p">,</span>
                <span class="n">dst_profile</span><span class="p">,</span>
                <span class="n">in_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.numpy_to_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">numpy_to_image</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resize_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.numpy_to_image" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a numpy array to an image in the specified format, such as JPG, PNG, TIFF, etc.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>np_array</code></td>
        <td><code>np.ndarray</code></td>
        <td><p>A numpy array or a path to a raster file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The output filename.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>transpose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to transpose the array from (bands, rows, cols) to (rows, cols, bands). Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>bands</code></td>
        <td><code>int | list</code></td>
        <td><p>The band(s) to use, starting from 0. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">numpy_to_image</span><span class="p">(</span>
    <span class="n">np_array</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">transpose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bands</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resize_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a numpy array to an image in the specified format, such as JPG, PNG, TIFF, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        np_array (np.ndarray): A numpy array or a path to a raster file.</span>
<span class="sd">        filename (str): The output filename.</span>
<span class="sd">        transpose (bool, optional): Whether to transpose the array from (bands, rows, cols) to (rows, cols, bands). Defaults to True.</span>
<span class="sd">        bands (int | list, optional): The band(s) to use, starting from 0. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">np_array</span> <span class="o">=</span> <span class="n">image_to_numpy</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided input must be a numpy array.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np_array</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="ow">or</span> <span class="n">np_array</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">:</span>
        <span class="c1"># Convert the array to uint8</span>
        <span class="c1"># np_array = (np_array * 255).astype(np.uint8)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="p">(</span><span class="n">np_array</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">np_array</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The array is already uint8</span>
        <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span>

    <span class="k">if</span> <span class="n">np_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">np_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">transpose</span><span class="p">:</span>
            <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">np_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">bands</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">bands</span><span class="p">]</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided input must be a 2D or 3D numpy array.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">resize</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="s2">&quot;The scikit-image package is not installed. Please install it with `pip install scikit-image` </span><span class="se">\</span>
<span class="s2">                  or `conda install scikit-image -c conda-forge`.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">resize_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">resize_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;preserve_range&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">resize_args</span><span class="p">:</span>
            <span class="n">resize_args</span><span class="p">[</span><span class="s2">&quot;preserve_range&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">np_array</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">np_array</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">**</span><span class="n">resize_args</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>

    <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.open_image_from_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">open_image_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


<a href="#leafmap.common.open_image_from_url" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Loads an image from the specified URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>URL of the image.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>Image object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">open_image_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads an image from the specified URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): URL of the image.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: Image object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

    <span class="c1"># from urllib.parse import urlparse</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">img</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.overlay_images" class="doc doc-heading">
<code class="highlight language-python"><span class="n">overlay_images</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span> <span class="n">image2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;TkAgg&#39;</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">show_args1</span><span class="o">=</span><span class="p">{},</span> <span class="n">show_args2</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.overlay_images" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Overlays two images using a slider to control the opacity of the top image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image1</code></td>
        <td><code>str | np.ndarray</code></td>
        <td><p>The first input image at the bottom represented as a NumPy array or the path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>image2</code></td>
        <td><code>_type_</code></td>
        <td><p>The second input image on top represented as a NumPy array or the path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>alpha</code></td>
        <td><code>float</code></td>
        <td><p>The alpha value of the top image. Defaults to 0.5.</p></td>
        <td><code>0.5</code></td>
      </tr>
      <tr>
        <td><code>backend</code></td>
        <td><code>str</code></td>
        <td><p>The backend of the matplotlib plot. Defaults to "TkAgg".</p></td>
        <td><code>&#39;TkAgg&#39;</code></td>
      </tr>
      <tr>
        <td><code>height_ratios</code></td>
        <td><code>list</code></td>
        <td><p>The height ratios of the two subplots. Defaults to [10, 1].</p></td>
        <td><code>[10, 1]</code></td>
      </tr>
      <tr>
        <td><code>show_args1</code></td>
        <td><code>dict</code></td>
        <td><p>The keyword arguments to pass to the imshow() function for the first image. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>show_args2</code></td>
        <td><code>dict</code></td>
        <td><p>The keyword arguments to pass to the imshow() function for the second image. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">overlay_images</span><span class="p">(</span>
    <span class="n">image1</span><span class="p">,</span>
    <span class="n">image2</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">,</span>
    <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">show_args1</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">show_args2</span><span class="o">=</span><span class="p">{},</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overlays two images using a slider to control the opacity of the top image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image1 (str | np.ndarray): The first input image at the bottom represented as a NumPy array or the path to the image.</span>
<span class="sd">        image2 (_type_): The second input image on top represented as a NumPy array or the path to the image.</span>
<span class="sd">        alpha (float, optional): The alpha value of the top image. Defaults to 0.5.</span>
<span class="sd">        backend (str, optional): The backend of the matplotlib plot. Defaults to &quot;TkAgg&quot;.</span>
<span class="sd">        height_ratios (list, optional): The height ratios of the two subplots. Defaults to [10, 1].</span>
<span class="sd">        show_args1 (dict, optional): The keyword arguments to pass to the imshow() function for the first image. Defaults to {}.</span>
<span class="sd">        show_args2 (dict, optional): The keyword arguments to pass to the imshow() function for the second image. Defaults to {}.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">matplotlib.widgets</span> <span class="k">as</span> <span class="nn">mpwidgets</span>

    <span class="k">if</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;inline&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The TkAgg backend is not supported in Google Colab. The overlay_images function will not work on Colab.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">image1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">image1</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">image1</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input path </span><span class="si">{</span><span class="n">image1</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">image2</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">image2</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">image2</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input path </span><span class="si">{</span><span class="n">image2</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="c1"># Load the two images</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image2</span><span class="p">)</span>

    <span class="c1"># Create the plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;height_ratios&quot;</span><span class="p">:</span> <span class="n">height_ratios</span><span class="p">})</span>
    <span class="n">img0</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">show_args1</span><span class="p">)</span>
    <span class="n">img1</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">show_args2</span><span class="p">)</span>

    <span class="c1"># Define the update function</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">img1</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="c1"># Create the slider</span>
    <span class="n">slider0</span> <span class="o">=</span> <span class="n">mpwidgets</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valinit</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">slider0</span><span class="o">.</span><span class="n">on_changed</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>

    <span class="c1"># Display the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.pandas_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pandas_to_geojson</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">geometry_type</span><span class="o">=</span><span class="s1">&#39;Point&#39;</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.pandas_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a DataFrame to a GeoJSON format.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>The input DataFrame containing the data.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>coordinates</code></td>
        <td><code>list</code></td>
        <td><p>A list of two column names representing the
longitude and latitude coordinates.</p></td>
        <td><code>[&#39;lng&#39;, &#39;lat&#39;]</code></td>
      </tr>
      <tr>
        <td><code>geometry_type</code></td>
        <td><code>str</code></td>
        <td><p>The type of geometry for the GeoJSON features
(e.g., "Point", "LineString", "Polygon").</p></td>
        <td><code>&#39;Point&#39;</code></td>
      </tr>
      <tr>
        <td><code>properties</code></td>
        <td><code>list</code></td>
        <td><p>A list of column names to include in the properties
of each GeoJSON feature. If None, all columns except the coordinate
columns are included.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The file path to save the GeoJSON output. If None,
the GeoJSON is not saved to a file.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary representing the GeoJSON object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pandas_to_geojson</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lng&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">],</span>
    <span class="n">geometry_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
    <span class="n">properties</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a DataFrame to a GeoJSON format.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The input DataFrame containing the data.</span>
<span class="sd">        coordinates (list): A list of two column names representing the</span>
<span class="sd">            longitude and latitude coordinates.</span>
<span class="sd">        geometry_type (str): The type of geometry for the GeoJSON features</span>
<span class="sd">            (e.g., &quot;Point&quot;, &quot;LineString&quot;, &quot;Polygon&quot;).</span>
<span class="sd">        properties (list): A list of column names to include in the properties</span>
<span class="sd">            of each GeoJSON feature. If None, all columns except the coordinate</span>
<span class="sd">            columns are included.</span>
<span class="sd">        output (str, optional): The file path to save the GeoJSON output. If None,</span>
<span class="sd">            the GeoJSON is not saved to a file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary representing the GeoJSON object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input file must be a CSV or JSON file.&quot;</span><span class="p">)</span>

    <span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">if</span> <span class="n">properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">geometry_type</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[]},</span>
        <span class="p">}</span>
        <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">coordinates</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span>

        <span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">geojson</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_biannual_tiles_tropical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_biannual_tiles_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_biannual_tiles_tropical" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet  bi-annual imagery TileLayer based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_biannual_tiles_tropical</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet  bi-annual imagery TileLayer based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">planet_biannual_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">link</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;20&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Planet_&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">15</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                <span class="n">tiles</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">tiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tile</span>

    <span class="k">return</span> <span class="n">tiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_biannual_tropical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_biannual_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_biannual_tropical" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet bi-annual imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the API key could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of tile URLs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_biannual_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet bi-annual imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the API key could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tile URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Planet API Key must be provided.&quot;</span><span class="p">)</span>

    <span class="n">dates</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;2015-12_2016-05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2016-06_2016-11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2016-12_2017-05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2017-06_2017-11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2017-12_2018-05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2018-06_2018-11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2018-12_2019-05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2019-06_2019-11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2019-12_2020-05&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2020-06_2020-08&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">link</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;https://tiles.planet.com/basemaps/v1/planet-tiles/planet_medres_normalized_analytic_&quot;</span>
    <span class="n">subfix</span> <span class="o">=</span> <span class="s2">&quot;_mosaic/gmap/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png?api_key=&quot;</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">d</span><span class="si">}{</span><span class="n">subfix</span><span class="si">}{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">link</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">link</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_by_month" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_by_month</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_by_month" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Gets Planet global mosaic tile url by month. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>year</code></td>
        <td><code>int</code></td>
        <td><p>The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</p></td>
        <td><code>2016</code></td>
      </tr>
      <tr>
        <td><code>month</code></td>
        <td><code>int</code></td>
        <td><p>The month of Planet global mosaic, must be 1-12. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The Planet API key is not provided.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The year is invalid.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The month is invalid.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The month is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>A Planet global mosaic tile url.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_by_month</span><span class="p">(</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
    <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets Planet global mosaic tile url by month. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">        month (int, optional): The month of Planet global mosaic, must be 1-12. Defaults to 1.</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The Planet API key is not provided.</span>
<span class="sd">        ValueError: The year is invalid.</span>
<span class="sd">        ValueError: The month is invalid.</span>
<span class="sd">        ValueError: The month is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A Planet global mosaic tile url.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Planet API Key must be provided.&quot;</span><span class="p">)</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">year_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">))</span>
    <span class="n">month_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m&quot;</span><span class="p">))</span>
    <span class="c1"># quarter_now = (month_now - 1) // 3 + 1</span>

    <span class="k">if</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="n">year_now</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Year must be between 2016 and </span><span class="si">{</span><span class="n">year_now</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="n">year_now</span> <span class="ow">and</span> <span class="n">month</span> <span class="o">&gt;=</span> <span class="n">month_now</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Month must be less than </span><span class="si">{</span><span class="n">month_now</span><span class="si">}</span><span class="s2"> for year </span><span class="si">{</span><span class="n">year_now</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">month</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">month</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Month must be between 1 and 12.&quot;</span><span class="p">)</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;https://tiles.planet.com/basemaps/v1/planet-tiles/global_monthly_&quot;</span>
    <span class="n">subfix</span> <span class="o">=</span> <span class="s2">&quot;_mosaic/gmap/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png?api_key=&quot;</span>

    <span class="n">m_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">m_str</span><span class="si">}{</span><span class="n">subfix</span><span class="si">}{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">url</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_by_quarter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_by_quarter</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_by_quarter" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Gets Planet global mosaic tile url by quarter. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>year</code></td>
        <td><code>int</code></td>
        <td><p>The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</p></td>
        <td><code>2016</code></td>
      </tr>
      <tr>
        <td><code>quarter</code></td>
        <td><code>int</code></td>
        <td><p>The quarter of Planet global mosaic, must be 1-4. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The Planet API key is not provided.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The year is invalid.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The quarter is invalid.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The quarter is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>A Planet global mosaic tile url.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_by_quarter</span><span class="p">(</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
    <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets Planet global mosaic tile url by quarter. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">        quarter (int, optional): The quarter of Planet global mosaic, must be 1-4. Defaults to 1.</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The Planet API key is not provided.</span>
<span class="sd">        ValueError: The year is invalid.</span>
<span class="sd">        ValueError: The quarter is invalid.</span>
<span class="sd">        ValueError: The quarter is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A Planet global mosaic tile url.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Planet API Key must be provided.&quot;</span><span class="p">)</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">year_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">))</span>
    <span class="n">month_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m&quot;</span><span class="p">))</span>
    <span class="n">quarter_now</span> <span class="o">=</span> <span class="p">(</span><span class="n">month_now</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="n">year_now</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Year must be between 2016 and </span><span class="si">{</span><span class="n">year_now</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="n">year_now</span> <span class="ow">and</span> <span class="n">quarter</span> <span class="o">&gt;=</span> <span class="n">quarter_now</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quarter must be less than </span><span class="si">{</span><span class="n">quarter_now</span><span class="si">}</span><span class="s2"> for year </span><span class="si">{</span><span class="n">year_now</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">quarter</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">quarter</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Quarter must be between 1 and 4.&quot;</span><span class="p">)</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;https://tiles.planet.com/basemaps/v1/planet-tiles/global_quarterly_&quot;</span>
    <span class="n">subfix</span> <span class="o">=</span> <span class="s2">&quot;_mosaic/gmap/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png?api_key=&quot;</span>

    <span class="n">m_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;q&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">quarter</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">m_str</span><span class="si">}{</span><span class="n">subfix</span><span class="si">}{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">url</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_catalog" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_catalog</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_catalog" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet bi-annual and monthly imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of tile URLs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_catalog</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet bi-annual and monthly imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tile URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quarterly</span> <span class="o">=</span> <span class="n">planet_quarterly</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="n">monthly</span> <span class="o">=</span> <span class="n">planet_monthly</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quarterly</span> <span class="o">+</span> <span class="n">monthly</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_catalog_tropical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_catalog_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_catalog_tropical" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet bi-annual and monthly imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of tile URLs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_catalog_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet bi-annual and monthly imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tile URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">biannual</span> <span class="o">=</span> <span class="n">planet_biannual_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="n">monthly</span> <span class="o">=</span> <span class="n">planet_monthly_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">biannual</span> <span class="o">+</span> <span class="n">monthly</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_monthly" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_monthly</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_monthly" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet monthly imagery URLs based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the API key could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of tile URLs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_monthly</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet monthly imagery URLs based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the API key could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tile URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Planet API Key must be provided.&quot;</span><span class="p">)</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">year_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">))</span>
    <span class="n">month_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m&quot;</span><span class="p">))</span>

    <span class="n">link</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;https://tiles.planet.com/basemaps/v1/planet-tiles/global_monthly_&quot;</span>
    <span class="n">subfix</span> <span class="o">=</span> <span class="s2">&quot;_mosaic/gmap/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png?api_key=&quot;</span>

    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="n">year_now</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="n">m_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="n">year_now</span> <span class="ow">and</span> <span class="n">month</span> <span class="o">&gt;=</span> <span class="n">month_now</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">m_str</span><span class="si">}{</span><span class="n">subfix</span><span class="si">}{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">link</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">link</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_monthly_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_monthly_tiles</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_monthly_tiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet monthly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_monthly_tiles</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet monthly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">planet_monthly</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">link</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;20&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Planet_&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                <span class="n">tiles</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">tiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tile</span>

    <span class="k">return</span> <span class="n">tiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_monthly_tiles_tropical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_monthly_tiles_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_monthly_tiles_tropical" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet  monthly imagery TileLayer based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_monthly_tiles_tropical</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet  monthly imagery TileLayer based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">planet_monthly_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">link</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;20&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Planet_&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                <span class="n">tiles</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">tiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tile</span>

    <span class="k">return</span> <span class="n">tiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_monthly_tropical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_monthly_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_monthly_tropical" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet monthly imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the API key could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of tile URLs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_monthly_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet monthly imagery URLs based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the API key could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tile URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Planet API Key must be provided.&quot;</span><span class="p">)</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">year_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">))</span>
    <span class="n">month_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m&quot;</span><span class="p">))</span>

    <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;https://tiles.planet.com/basemaps/v1/planet-tiles/planet_medres_normalized_analytic_&quot;</span>
    <span class="n">subfix</span> <span class="o">=</span> <span class="s2">&quot;_mosaic/gmap/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png?api_key=&quot;</span>

    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="n">year_now</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="n">m_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">2020</span> <span class="ow">and</span> <span class="n">month</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="n">year_now</span> <span class="ow">and</span> <span class="n">month</span> <span class="o">&gt;=</span> <span class="n">month_now</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">m_str</span><span class="si">}{</span><span class="n">subfix</span><span class="si">}{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">links</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_quarterly" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_quarterly</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_quarterly" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet quarterly imagery URLs based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the API key could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of tile URLs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_quarterly</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet quarterly imagery URLs based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the API key could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tile URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

    <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Planet API Key must be provided.&quot;</span><span class="p">)</span>

    <span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">year_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">))</span>
    <span class="n">month_now</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m&quot;</span><span class="p">))</span>
    <span class="n">quarter_now</span> <span class="o">=</span> <span class="p">(</span><span class="n">month_now</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">link</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;https://tiles.planet.com/basemaps/v1/planet-tiles/global_quarterly_&quot;</span>
    <span class="n">subfix</span> <span class="o">=</span> <span class="s2">&quot;_mosaic/gmap/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png?api_key=&quot;</span>

    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="n">year_now</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">quarter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">m_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;q&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">quarter</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="n">year_now</span> <span class="ow">and</span> <span class="n">quarter</span> <span class="o">&gt;=</span> <span class="n">quarter_now</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">m_str</span><span class="si">}{</span><span class="n">subfix</span><span class="si">}{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">link</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">link</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_quarterly_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_quarterly_tiles</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_quarterly_tiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet  quarterly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_quarterly_tiles</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet  quarterly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="n">tiles</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">planet_quarterly</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;20&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Planet_&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tile</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
                <span class="n">tiles</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">tiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tile</span>

    <span class="k">return</span> <span class="n">tiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_tile_by_month" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_tile_by_month</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_tile_by_month" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet monthly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>year</code></td>
        <td><code>int</code></td>
        <td><p>The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</p></td>
        <td><code>2016</code></td>
      </tr>
      <tr>
        <td><code>month</code></td>
        <td><code>int</code></td>
        <td><p>The month of Planet global mosaic, must be 1-12. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_tile_by_month</span><span class="p">(</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
    <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
    <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet monthly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">        month (int, optional): The month of Planet global mosaic, must be 1-12. Defaults to 1.</span>
<span class="sd">        name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">planet_by_month</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Planet_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
        <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tile</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
            <span class="n">tiles</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">tile</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_tile_by_quarter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_tile_by_quarter</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_tile_by_quarter" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet quarterly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>year</code></td>
        <td><code>int</code></td>
        <td><p>The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</p></td>
        <td><code>2016</code></td>
      </tr>
      <tr>
        <td><code>quarter</code></td>
        <td><code>int</code></td>
        <td><p>The quarter of Planet global mosaic, must be 1-4. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The layer name to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_tile_by_quarter</span><span class="p">(</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span>
    <span class="n">quarter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span>
    <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet quarterly imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int, optional): The year of Planet global mosaic, must be &gt;=2016. Defaults to 2016.</span>
<span class="sd">        quarter (int, optional): The quarter of Planet global mosaic, must be 1-4. Defaults to 1.</span>
<span class="sd">        name (str, optional): The layer name to use. Defaults to None.</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">,</span> <span class="s2">&quot;folium&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tile format must be either ipyleaflet or folium.&quot;</span><span class="p">)</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">planet_by_quarter</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">quarter</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Planet_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_q&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">quarter</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tile_format</span> <span class="o">==</span> <span class="s2">&quot;ipyleaflet&quot;</span><span class="p">:</span>
        <span class="n">tile</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tile</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">TileLayer</span><span class="p">(</span>
            <span class="n">tiles</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">tile</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_tiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_tiles</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_tiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_tiles</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet imagery TileLayer based on an API key. To get a Planet API key, see https://developers.planet.com/quickstart/apis/</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">quarterly</span> <span class="o">=</span> <span class="n">planet_quarterly_tiles</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">,</span> <span class="n">tile_format</span><span class="p">)</span>
    <span class="n">monthly</span> <span class="o">=</span> <span class="n">planet_monthly_tiles</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">,</span> <span class="n">tile_format</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">quarterly</span><span class="p">:</span>
        <span class="n">catalog</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">quarterly</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">monthly</span><span class="p">:</span>
        <span class="n">catalog</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">catalog</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.planet_tiles_tropical" class="doc doc-heading">
<code class="highlight language-python"><span class="n">planet_tiles_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s1">&#39;PLANET_API_KEY&#39;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s1">&#39;ipyleaflet&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.planet_tiles_tropical" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates Planet  monthly imagery TileLayer based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>str</code></td>
        <td><p>The Planet API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>token_name</code></td>
        <td><code>str</code></td>
        <td><p>The environment variable name of the API key. Defaults to "PLANET_API_KEY".</p></td>
        <td><code>&#39;PLANET_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>tile_format</code></td>
        <td><code>str</code></td>
        <td><p>The TileLayer format, can be either ipyleaflet or folium. Defaults to "ipyleaflet".</p></td>
        <td><code>&#39;ipyleaflet&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the tile layer format is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary of TileLayer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">planet_tiles_tropical</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_name</span><span class="o">=</span><span class="s2">&quot;PLANET_API_KEY&quot;</span><span class="p">,</span> <span class="n">tile_format</span><span class="o">=</span><span class="s2">&quot;ipyleaflet&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Planet  monthly imagery TileLayer based on an API key. See https://assets.planet.com/docs/NICFI_UserGuidesFAQ.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (str, optional): The Planet API key. Defaults to None.</span>
<span class="sd">        token_name (str, optional): The environment variable name of the API key. Defaults to &quot;PLANET_API_KEY&quot;.</span>
<span class="sd">        tile_format (str, optional): The TileLayer format, can be either ipyleaflet or folium. Defaults to &quot;ipyleaflet&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the tile layer format is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary of TileLayer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">biannul</span> <span class="o">=</span> <span class="n">planet_biannual_tiles_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">,</span> <span class="n">tile_format</span><span class="p">)</span>
    <span class="n">monthly</span> <span class="o">=</span> <span class="n">planet_monthly_tiles_tropical</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">token_name</span><span class="p">,</span> <span class="n">tile_format</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">biannul</span><span class="p">:</span>
        <span class="n">catalog</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">biannul</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">monthly</span><span class="p">:</span>
        <span class="n">catalog</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">catalog</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.plot_raster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_raster</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.plot_raster" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Plot a raster image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str | xarray.DataArray </code></td>
        <td><p>The input raster image, can be a file path, HTTP URL, or xarray.DataArray.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>int</code></td>
        <td><p>The band index, starting from zero. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The matplotlib colormap to use. Defaults to "terrain".</p></td>
        <td><code>&#39;terrain&#39;</code></td>
      </tr>
      <tr>
        <td><code>proj</code></td>
        <td><code>str</code></td>
        <td><p>The EPSG projection code. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>The figure size as a tuple, such as (10, 8). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>open_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>The keyword arguments to pass to rioxarray.open_rasterio. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to xarray.DataArray.plot().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_raster</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">proj</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">open_kwargs</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot a raster image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str | xarray.DataArray ): The input raster image, can be a file path, HTTP URL, or xarray.DataArray.</span>
<span class="sd">        band (int, optional): The band index, starting from zero. Defaults to None.</span>
<span class="sd">        cmap (str, optional): The matplotlib colormap to use. Defaults to &quot;terrain&quot;.</span>
<span class="sd">        proj (str, optional): The EPSG projection code. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        figsize (tuple, optional): The figure size as a tuple, such as (10, 8). Defaults to None.</span>
<span class="sd">        open_kwargs (dict, optional): The keyword arguments to pass to rioxarray.open_rasterio. Defaults to {}.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to xarray.DataArray.plot().</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pvxarray</span>
        <span class="kn">import</span> <span class="nn">rioxarray</span>
        <span class="kn">import</span> <span class="nn">xarray</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;pyxarray and rioxarray are required for plotting. Please install them using &#39;pip install rioxarray pyvista-xarray&#39;.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">open_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;image must be a string or xarray.Dataset.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">band</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">)]</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">figsize</span>
    <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.plot_raster_3d" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_raster_3d</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">mesh_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.plot_raster_3d" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Plot a raster image in 3D.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str | xarray.DataArray</code></td>
        <td><p>The input raster image, can be a file path, HTTP URL, or xarray.DataArray.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>band</code></td>
        <td><code>int</code></td>
        <td><p>The band index, starting from zero. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The matplotlib colormap to use. Defaults to "terrain".</p></td>
        <td><code>&#39;terrain&#39;</code></td>
      </tr>
      <tr>
        <td><code>factor</code></td>
        <td><code>float</code></td>
        <td><p>The scaling factor for the raster. Defaults to 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>proj</code></td>
        <td><code>str</code></td>
        <td><p>The EPSG projection code. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>background</code></td>
        <td><code>str</code></td>
        <td><p>The background color. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>str</code></td>
        <td><p>The x coordinate. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>str</code></td>
        <td><p>The y coordinate. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>z</code></td>
        <td><code>str</code></td>
        <td><p>The z coordinate. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>order</code></td>
        <td><code>str</code></td>
        <td><p>The order of the coordinates. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>component</code></td>
        <td><code>str</code></td>
        <td><p>The component of the coordinates. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>open_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>The keyword arguments to pass to rioxarray.open_rasterio. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>mesh_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>The keyword arguments to pass to pyvista.mesh.warp_by_scalar(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to xarray.DataArray.plot().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_raster_3d</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">proj</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">component</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">open_kwargs</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">mesh_kwargs</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot a raster image in 3D.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str | xarray.DataArray): The input raster image, can be a file path, HTTP URL, or xarray.DataArray.</span>
<span class="sd">        band (int, optional): The band index, starting from zero. Defaults to None.</span>
<span class="sd">        cmap (str, optional): The matplotlib colormap to use. Defaults to &quot;terrain&quot;.</span>
<span class="sd">        factor (float, optional): The scaling factor for the raster. Defaults to 1.0.</span>
<span class="sd">        proj (str, optional): The EPSG projection code. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        background (str, optional): The background color. Defaults to None.</span>
<span class="sd">        x (str, optional): The x coordinate. Defaults to None.</span>
<span class="sd">        y (str, optional): The y coordinate. Defaults to None.</span>
<span class="sd">        z (str, optional): The z coordinate. Defaults to None.</span>
<span class="sd">        order (str, optional): The order of the coordinates. Defaults to None.</span>
<span class="sd">        component (str, optional): The component of the coordinates. Defaults to None.</span>
<span class="sd">        open_kwargs (dict, optional): The keyword arguments to pass to rioxarray.open_rasterio. Defaults to {}.</span>
<span class="sd">        mesh_kwargs (dict, optional): The keyword arguments to pass to pyvista.mesh.warp_by_scalar(). Defaults to {}.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to xarray.DataArray.plot().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This function is not supported in Google Colab.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pvxarray</span>
        <span class="kn">import</span> <span class="nn">pyvista</span>
        <span class="kn">import</span> <span class="nn">rioxarray</span>
        <span class="kn">import</span> <span class="nn">xarray</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;pyxarray and rioxarray are required for plotting. Please install them using &#39;pip install rioxarray pyvista-xarray&#39;.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">pyvista</span><span class="o">.</span><span class="n">global_theme</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">background</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">open_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">image</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;image must be a string or xarray.Dataset.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">band</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">)]</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>
    <span class="n">mesh_kwargs</span><span class="p">[</span><span class="s2">&quot;factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">factor</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmap</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;lon&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;lon&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;lat&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;lat&quot;</span>
    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;z&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="s2">&quot;z&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;elevation&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="s2">&quot;elevation&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;band&quot;</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="s2">&quot;band&quot;</span>

    <span class="c1"># Grab the mesh object for use with PyVista</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">pyvista</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>

    <span class="c1"># Warp top and plot in 3D</span>
    <span class="n">mesh</span><span class="o">.</span><span class="n">warp_by_scalar</span><span class="p">(</span><span class="o">**</span><span class="n">mesh_kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.pmtiles_header" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pmtiles_header</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span></code>


<a href="#leafmap.common.pmtiles_header" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetch the header information from a local or remote .pmtiles file.</p>
<p>This function retrieves the header from a PMTiles file, either local or hosted remotely.
It deserializes the header and calculates the center and bounds of the tiles from the
given metadata in the header.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the .pmtiles file, or its URL if the file is hosted remotely.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary containing the header information, including center and bounds.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the pmtiles library is not installed.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the input file is not a .pmtiles file or if it does not exist.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">header</span> <span class="o">=</span> <span class="n">pmtiles_header</span><span class="p">(</span><span class="s2">&quot;https://example.com/path/to/tiles.pmtiles&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">])</span>
<span class="p">[</span><span class="mf">52.5200</span><span class="p">,</span> <span class="mf">13.4050</span><span class="p">]</span>
</code></pre></div>
      <div class="admonition note">
<p class="admonition-title">Note</p>
<p>If fetching a remote PMTiles file, this function only downloads the first 127 bytes
of the file to retrieve the header.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pmtiles_header</span><span class="p">(</span><span class="n">input_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch the header information from a local or remote .pmtiles file.</span>

<span class="sd">    This function retrieves the header from a PMTiles file, either local or hosted remotely.</span>
<span class="sd">    It deserializes the header and calculates the center and bounds of the tiles from the</span>
<span class="sd">    given metadata in the header.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (str): Path to the .pmtiles file, or its URL if the file is hosted remotely.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the header information, including center and bounds.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the pmtiles library is not installed.</span>
<span class="sd">        ValueError: If the input file is not a .pmtiles file or if it does not exist.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; header = pmtiles_header(&quot;https://example.com/path/to/tiles.pmtiles&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(header[&quot;center&quot;])</span>
<span class="sd">        [52.5200, 13.4050]</span>

<span class="sd">    Note:</span>
<span class="sd">        If fetching a remote PMTiles file, this function only downloads the first 127 bytes</span>
<span class="sd">        of the file to retrieve the header.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">requests</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">pmtiles.reader</span> <span class="kn">import</span> <span class="n">Reader</span><span class="p">,</span> <span class="n">MmapSource</span>
        <span class="kn">from</span> <span class="nn">pmtiles.tile</span> <span class="kn">import</span> <span class="n">deserialize_header</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;pmtiles is not installed. Please install it using `pip install pmtiles`.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pmtiles&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input file must be a .pmtiles file.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">input_file</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="c1"># Fetch only the first 127 bytes</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Range&quot;</span><span class="p">:</span> <span class="s2">&quot;bytes=0-127&quot;</span><span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">deserialize_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">input_file</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input file </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="n">MmapSource</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="p">()</span>

    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;center_lat_e7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">,</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;center_lon_e7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">]</span>
    <span class="n">header</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;min_lon_e7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">,</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;min_lat_e7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">,</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;max_lon_e7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">,</span>
        <span class="n">header</span><span class="p">[</span><span class="s2">&quot;max_lat_e7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">header</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.pmtiles_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pmtiles_metadata</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span></code>


<a href="#leafmap.common.pmtiles_metadata" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Fetch the metadata from a local or remote .pmtiles file.</p>
<p>This function retrieves metadata from a PMTiles file, whether it's local or hosted remotely.
If it's remote, the function fetches the header to determine the range of bytes to download
for obtaining the metadata. It then reads the metadata and extracts the layer names.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_file</code></td>
        <td><code>str</code></td>
        <td><p>Path to the .pmtiles file, or its URL if the file is hosted remotely.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary containing the metadata information, including layer names.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the pmtiles library is not installed.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the input file is not a .pmtiles file or if it does not exist.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">pmtiles_metadata</span><span class="p">(</span><span class="s2">&quot;https://example.com/path/to/tiles.pmtiles&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;layer_names&quot;</span><span class="p">])</span>
<span class="p">[</span><span class="s1">&#39;buildings&#39;</span><span class="p">,</span> <span class="s1">&#39;roads&#39;</span><span class="p">]</span>
</code></pre></div>
      <div class="admonition note">
<p class="admonition-title">Note</p>
<p>If fetching a remote PMTiles file, this function may perform multiple requests to minimize
the amount of data downloaded.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pmtiles_metadata</span><span class="p">(</span><span class="n">input_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch the metadata from a local or remote .pmtiles file.</span>

<span class="sd">    This function retrieves metadata from a PMTiles file, whether it&#39;s local or hosted remotely.</span>
<span class="sd">    If it&#39;s remote, the function fetches the header to determine the range of bytes to download</span>
<span class="sd">    for obtaining the metadata. It then reads the metadata and extracts the layer names.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (str): Path to the .pmtiles file, or its URL if the file is hosted remotely.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the metadata information, including layer names.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the pmtiles library is not installed.</span>
<span class="sd">        ValueError: If the input file is not a .pmtiles file or if it does not exist.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; metadata = pmtiles_metadata(&quot;https://example.com/path/to/tiles.pmtiles&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(metadata[&quot;layer_names&quot;])</span>
<span class="sd">        [&#39;buildings&#39;, &#39;roads&#39;]</span>

<span class="sd">    Note:</span>
<span class="sd">        If fetching a remote PMTiles file, this function may perform multiple requests to minimize</span>
<span class="sd">        the amount of data downloaded.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">import</span> <span class="nn">requests</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">pmtiles.reader</span> <span class="kn">import</span> <span class="n">Reader</span><span class="p">,</span> <span class="n">MmapSource</span><span class="p">,</span> <span class="n">MemorySource</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;pmtiles is not installed. Please install it using `pip install pmtiles`.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># ignore uri parameters when checking file suffix</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pmtiles&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input file must be a .pmtiles file.&quot;</span><span class="p">)</span>

    <span class="n">header</span> <span class="o">=</span> <span class="n">pmtiles_header</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
    <span class="n">metadata_offset</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;metadata_offset&quot;</span><span class="p">]</span>
    <span class="n">metadata_length</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;metadata_length&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">input_file</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Range&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bytes=0-</span><span class="si">{</span><span class="n">metadata_offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">metadata_length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">MemorySource</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="n">MmapSource</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">metadata</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;json&quot;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
                <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;vector_layers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">])[</span>
                    <span class="s2">&quot;vector_layers&quot;</span>
                <span class="p">]</span>

    <span class="n">vector_layers</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;vector_layers&quot;</span><span class="p">]</span>
    <span class="n">layer_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">vector_layers</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;tilestats&quot;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
        <span class="n">geometries</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;tilestats&quot;</span><span class="p">][</span><span class="s2">&quot;layers&quot;</span><span class="p">]]</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;geometries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geometries</span>

    <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;layer_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_names</span>
    <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span>
    <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">metadata</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.pmtiles_style" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pmtiles_style</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Set3&#39;</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">circle_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;PMTiles&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.pmtiles_style" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a Mapbox style JSON for rendering PMTiles data.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the PMTiles file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layers</code></td>
        <td><code>str or list[str]</code></td>
        <td><p>The layers to include in the style. If None, all layers will be included.
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The color map to use for styling the layers. Defaults to "Set3".</p></td>
        <td><code>&#39;Set3&#39;</code></td>
      </tr>
      <tr>
        <td><code>n_class</code></td>
        <td><code>int</code></td>
        <td><p>The number of classes to use for styling. If None, the number of classes will be
determined automatically based on the color map. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>opacity</code></td>
        <td><code>float</code></td>
        <td><p>The fill opacity for polygon layers. Defaults to 0.5.</p></td>
        <td><code>0.5</code></td>
      </tr>
      <tr>
        <td><code>circle_radius</code></td>
        <td><code>int</code></td>
        <td><p>The circle radius for point layers. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>line_width</code></td>
        <td><code>int</code></td>
        <td><p>The line width for line layers. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>attribution</code></td>
        <td><code>str</code></td>
        <td><p>The attribution text for the data source. Defaults to "PMTiles".</p></td>
        <td><code>&#39;PMTiles&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>The Mapbox style JSON.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the layers argument is not a string or a list.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If a layer specified in the layers argument does not exist in the PMTiles file.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pmtiles_style</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">layers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Set3&quot;</span><span class="p">,</span>
    <span class="n">n_class</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">circle_radius</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">line_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">attribution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;PMTiles&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Mapbox style JSON for rendering PMTiles data.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the PMTiles file.</span>
<span class="sd">        layers (str or list[str], optional): The layers to include in the style. If None, all layers will be included.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        cmap (str, optional): The color map to use for styling the layers. Defaults to &quot;Set3&quot;.</span>
<span class="sd">        n_class (int, optional): The number of classes to use for styling. If None, the number of classes will be</span>
<span class="sd">            determined automatically based on the color map. Defaults to None.</span>
<span class="sd">        opacity (float, optional): The fill opacity for polygon layers. Defaults to 0.5.</span>
<span class="sd">        circle_radius (int, optional): The circle radius for point layers. Defaults to 5.</span>
<span class="sd">        line_width (int, optional): The line width for line layers. Defaults to 1.</span>
<span class="sd">        attribution (str, optional): The attribution text for the data source. Defaults to &quot;PMTiles&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The Mapbox style JSON.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the layers argument is not a string or a list.</span>
<span class="sd">        ValueError: If a layer specified in the layers argument does not exist in the PMTiles file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s2">&quot;Set3&quot;</span><span class="p">:</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;#8dd3c7&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#ffffb3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#bebada&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#fb8072&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#80b1d3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#fdb462&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#b3de69&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#fccde5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#d9d9d9&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#bc80bd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#ccebc5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#ffed6f&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">cmap</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.colormaps</span> <span class="kn">import</span> <span class="n">get_palette</span>

        <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">get_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)]</span>

    <span class="n">n_class</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="n">pmtiles_metadata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">layer_names</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;layer_names&quot;</span><span class="p">]</span>

    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;vector&quot;</span><span class="p">,</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;pmtiles://&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">,</span>
                <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="n">attribution</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">layers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="n">layer_names</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">layers</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">layer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layer_names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Layer </span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s2"> does not exist in the PMTiles file.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The layers argument must be a string or a list.&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">layer_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">):</span>
        <span class="n">layer_point</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">_point&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="n">layer_name</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;circle-color&quot;</span><span class="p">:</span> <span class="n">palette</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">n_class</span><span class="p">],</span>
                <span class="s2">&quot;circle-radius&quot;</span><span class="p">:</span> <span class="n">circle_radius</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;geometry-type&quot;</span><span class="p">],</span> <span class="s2">&quot;Point&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">layer_stroke</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">_stroke&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="n">layer_name</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="n">palette</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">n_class</span><span class="p">],</span>
                <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="n">line_width</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;geometry-type&quot;</span><span class="p">],</span> <span class="s2">&quot;LineString&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">layer_fill</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">_fill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="n">layer_name</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="n">palette</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">n_class</span><span class="p">],</span>
                <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="n">opacity</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;geometry-type&quot;</span><span class="p">],</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">style</span><span class="p">[</span><span class="s2">&quot;layers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">layer_point</span><span class="p">,</span> <span class="n">layer_stroke</span><span class="p">,</span> <span class="n">layer_fill</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">style</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.png_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">png_to_gif</span><span class="p">(</span><span class="n">in_dir</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#leafmap.common.png_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a list of png images to gif.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_dir</code></td>
        <td><code>str</code></td>
        <td><p>The input directory containing png images.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to the gif.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fps</code></td>
        <td><code>int</code></td>
        <td><p>Frames per second. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>bool</code></td>
        <td><p>controls how many times the animation repeats. 1 means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>No png images could be found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">png_to_gif</span><span class="p">(</span><span class="n">in_dir</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a list of png images to gif.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_dir (str): The input directory containing png images.</span>
<span class="sd">        out_gif (str): The output file path to the gif.</span>
<span class="sd">        fps (int, optional): Frames per second. Defaults to 10.</span>
<span class="sd">        loop (bool, optional): controls how many times the animation repeats. 1 means that the animation will play once and then stop (displaying the last frame). A value of 0 means that the animation will repeat forever. Defaults to 0.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: No png images could be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">glob</span>

    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The out_gif must be a gif file.&quot;</span><span class="p">)</span>

    <span class="n">out_gif</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="c1"># Create the frames</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">imgs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">in_dir</span><span class="p">,</span> <span class="s2">&quot;*.png&quot;</span><span class="p">)))</span>
    <span class="n">imgs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No png could be found in </span><span class="si">{</span><span class="n">in_dir</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">imgs</span><span class="p">:</span>
        <span class="n">new_frame</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_frame</span><span class="p">)</span>

    <span class="c1"># Save into a GIF file that loops forever</span>
    <span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">out_gif</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;GIF&quot;</span><span class="p">,</span>
        <span class="n">append_images</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">save_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">,</span>
        <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.points_from_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">points_from_xy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.points_from_xy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a GeoPandas GeoDataFrame from a csv or Pandas DataFrame containing x, y, z values.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>str | pd.DataFrame</code></td>
        <td><p>A csv or Pandas DataFrame containing x, y, z values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>x</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the x values. Defaults to "longitude".</p></td>
        <td><code>&#39;longitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the y values. Defaults to "latitude".</p></td>
        <td><code>&#39;latitude&#39;</code></td>
      </tr>
      <tr>
        <td><code>z</code></td>
        <td><code>str</code></td>
        <td><p>The column name for the z values. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str | int</code></td>
        <td><p>The coordinate reference system for the GeoDataFrame. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>geopandas.GeoDataFrame</code></td>
      <td><p>A GeoPandas GeoDataFrame containing x, y, z values.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">points_from_xy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a GeoPandas GeoDataFrame from a csv or Pandas DataFrame containing x, y, z values.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (str | pd.DataFrame): A csv or Pandas DataFrame containing x, y, z values.</span>
<span class="sd">        x (str, optional): The column name for the x values. Defaults to &quot;longitude&quot;.</span>
<span class="sd">        y (str, optional): The column name for the y values. Defaults to &quot;latitude&quot;.</span>
<span class="sd">        z (str, optional): The column name for the z values. Defaults to None.</span>
<span class="sd">        crs (str | int, optional): The coordinate reference system for the GeoDataFrame. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        geopandas.GeoDataFrame: A GeoPandas GeoDataFrame containing x, y, z values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;epsg:4326&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The specified input csv does not exist.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The data must be a pandas DataFrame or a csv file path.&quot;</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.random_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_string</span><span class="p">(</span><span class="n">string_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>


<a href="#leafmap.common.random_string" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Generates a random string of fixed length.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>string_length</code></td>
        <td><code>int</code></td>
        <td><p>Fixed length. Defaults to 3.</p></td>
        <td><code>3</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>A random string</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">random_string</span><span class="p">(</span><span class="n">string_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a random string of fixed length.</span>

<span class="sd">    Args:</span>
<span class="sd">        string_length (int, optional): Fixed length. Defaults to 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A random string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="kn">import</span> <span class="nn">string</span>

    <span class="c1"># random.seed(1001)</span>
    <span class="n">letters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">string_length</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.raster_to_vector" class="doc doc-heading">
<code class="highlight language-python"><span class="n">raster_to_vector</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">simplify_tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.raster_to_vector" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Vectorize a raster dataset.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the tiff file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the vector file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>simplify_tolerance</code></td>
        <td><code>float</code></td>
        <td><p>The maximum allowed geometry displacement.
The higher this value, the smaller the number of vertices in the resulting geometry.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">raster_to_vector</span><span class="p">(</span>
    <span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">simplify_tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vectorize a raster dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the tiff file.</span>
<span class="sd">        output (str): The path to the vector file.</span>
<span class="sd">        simplify_tolerance (float, optional): The maximum allowed geometry displacement.</span>
<span class="sd">            The higher this value, the smaller the number of vertices in the resulting geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="kn">import</span> <span class="nn">shapely</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="n">features</span>

    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">open_args</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
        <span class="n">band</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">band</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">shapes</span><span class="p">(</span><span class="n">band</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">src</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">fc</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">shape</span><span class="p">),</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">}}</span>
        <span class="k">for</span> <span class="n">shape</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">shapes</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">simplify_tolerance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fc</span><span class="p">:</span>
            <span class="n">i</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">tolerance</span><span class="o">=</span><span class="n">simplify_tolerance</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">src</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dst_crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_file_from_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_file_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.read_file_from_url" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Reads a file from a URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>The return type, can either be string or list. Defaults to "list".</p></td>
        <td><code>&#39;list&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the file. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>The return type must be either list or string.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str | list</code></td>
      <td><p>The contents of the file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_file_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads a file from a URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the file.</span>
<span class="sd">        return_type (str, optional): The return type, can either be string or list. Defaults to &quot;list&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of the file. Defaults to &quot;utf-8&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The return type must be either list or string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str | list: The contents of the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The return type must be either list or string.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_lidar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_lidar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.read_lidar" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Read a LAS file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>A local file path or HTTP URL to a LAS file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>LasData</code></td>
      <td><p>The LasData object return by laspy.read.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_lidar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a LAS file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): A local file path or HTTP URL to a LAS file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LasData: The LasData object return by laspy.read.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">laspy</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The laspy package is required for this function. Use `pip install laspy[lazrs,laszip]` to install it.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.las&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.laz&quot;</span><span class="p">))</span>
    <span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">github_raw_url</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">laspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_netcdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_netcdf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.read_netcdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Read a netcdf file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>File path or HTTP URL to the netcdf file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If the xarray or rioxarray package is not installed.</p></td>
      </tr>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the netcdf file is not found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>xarray.Dataset</code></td>
      <td><p>The netcdf file as an xarray dataset.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_netcdf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a netcdf file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): File path or HTTP URL to the netcdf file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If the xarray or rioxarray package is not installed.</span>
<span class="sd">        FileNotFoundError: If the netcdf file is not found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        xarray.Dataset: The netcdf file as an xarray dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">xds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xds</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_parquet" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_parquet</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sql</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;gdf&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.read_parquet" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Read Parquet data from a source and return a GeoDataFrame or DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the Parquet file or directory containing Parquet files.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>geometry</code></td>
        <td><code>str</code></td>
        <td><p>The name of the geometry column. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>columns</code></td>
        <td><code>str or list</code></td>
        <td><p>The columns to select. Defaults to None (select all columns).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exclude</code></td>
        <td><code>str or list</code></td>
        <td><p>The columns to exclude from the selection. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>db</code></td>
        <td><code>str</code></td>
        <td><p>The DuckDB database path or alias. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>table_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the table in the DuckDB database. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sql</code></td>
        <td><code>str</code></td>
        <td><p>The SQL query to execute. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>limit</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of rows to return. Defaults to None (return all rows).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>src_crs</code></td>
        <td><code>str</code></td>
        <td><p>The source CRS (Coordinate Reference System) of the geometries. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The target CRS to reproject the geometries. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_type</code></td>
        <td><code>str</code></td>
        <td><p>The type of object to return:
- 'gdf': GeoDataFrame (default)
- 'df': DataFrame
- 'numpy': NumPy array
- 'arrow': Arrow Table
- 'polars': Polars DataFrame</p></td>
        <td><code>&#39;gdf&#39;</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments that are passed to the DuckDB connection.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[gpd.GeoDataFrame, pd.DataFrame, np.ndarray]</code></td>
      <td><p>The loaded data.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the columns or exclude arguments are not of the correct type.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_parquet</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sql</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">src_crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dst_crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gdf&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read Parquet data from a source and return a GeoDataFrame or DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the Parquet file or directory containing Parquet files.</span>
<span class="sd">        geometry (str, optional): The name of the geometry column. Defaults to None.</span>
<span class="sd">        columns (str or list, optional): The columns to select. Defaults to None (select all columns).</span>
<span class="sd">        exclude (str or list, optional): The columns to exclude from the selection. Defaults to None.</span>
<span class="sd">        db (str, optional): The DuckDB database path or alias. Defaults to None.</span>
<span class="sd">        table_name (str, optional): The name of the table in the DuckDB database. Defaults to None.</span>
<span class="sd">        sql (str, optional): The SQL query to execute. Defaults to None.</span>
<span class="sd">        limit (int, optional): The maximum number of rows to return. Defaults to None (return all rows).</span>
<span class="sd">        src_crs (str, optional): The source CRS (Coordinate Reference System) of the geometries. Defaults to None.</span>
<span class="sd">        dst_crs (str, optional): The target CRS to reproject the geometries. Defaults to None.</span>
<span class="sd">        return_type (str, optional): The type of object to return:</span>
<span class="sd">            - &#39;gdf&#39;: GeoDataFrame (default)</span>
<span class="sd">            - &#39;df&#39;: DataFrame</span>
<span class="sd">            - &#39;numpy&#39;: NumPy array</span>
<span class="sd">            - &#39;arrow&#39;: Arrow Table</span>
<span class="sd">            - &#39;polars&#39;: Polars DataFrame</span>
<span class="sd">        **kwargs: Additional keyword arguments that are passed to the DuckDB connection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[gpd.GeoDataFrame, pd.DataFrame, np.ndarray]: The loaded data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the columns or exclude arguments are not of the correct type.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">duckdb</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="n">con</span><span class="o">.</span><span class="n">install_extension</span><span class="p">(</span><span class="s2">&quot;httpfs&quot;</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;httpfs&quot;</span><span class="p">)</span>

    <span class="n">con</span><span class="o">.</span><span class="n">install_extension</span><span class="p">(</span><span class="s2">&quot;spatial&quot;</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;spatial&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;columns must be a list or a string.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exclude</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;exclude_columns must be a list or a string.&quot;</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">columns</span><span class="si">}</span><span class="s2"> EXCLUDE </span><span class="si">{</span><span class="n">exclude</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;df&quot;</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">,</span> <span class="s2">&quot;arrow&quot;</span><span class="p">,</span> <span class="s2">&quot;polars&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">sql</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">columns</span><span class="si">}</span><span class="s2"> FROM &#39;</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; LIMIT </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;df&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;numpy&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">fetchnumpy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;arrow&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">arrow</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;polars&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">pl</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CREATE OR REPLACE TABLE </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2"> AS FROM result&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;gdf&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">geometry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">geometry</span> <span class="o">=</span> <span class="s2">&quot;geometry&quot;</span>
        <span class="k">if</span> <span class="n">sql</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if src_crs is not None and dst_crs is not None:</span>
            <span class="c1">#     geom_sql = f&quot;ST_AsText(ST_Transform(ST_GeomFromWKB({geometry}), &#39;{src_crs}&#39;, &#39;{dst_crs}&#39;, true)) AS {geometry}&quot;</span>
            <span class="c1"># else:</span>
            <span class="n">geom_sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ST_AsText(ST_GeomFromWKB(</span><span class="si">{</span><span class="n">geometry</span><span class="si">}</span><span class="s2">)) AS </span><span class="si">{</span><span class="n">geometry</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">columns</span><span class="si">}</span><span class="s2"> EXCLUDE </span><span class="si">{</span><span class="n">geometry</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">geom_sql</span><span class="si">}</span><span class="s2"> FROM &#39;</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; LIMIT </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CREATE OR REPLACE TABLE </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2"> AS FROM df&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">df_to_gdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="n">dst_crs</span><span class="p">)</span>

    <span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_postgis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">geom_col</span><span class="o">=</span><span class="s1">&#39;geom&#39;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.read_postgis" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Reads data from a PostGIS database and returns a GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>sql</code></td>
        <td><code>str</code></td>
        <td><p>SQL query to execute in selecting entries from database, or name of the table to read from the database.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>con</code></td>
        <td><code>sqlalchemy.engine.Engine</code></td>
        <td><p>Active connection to the database to query.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>geom_col</code></td>
        <td><code>str</code></td>
        <td><p>Column name to convert to shapely geometries. Defaults to "geom".</p></td>
        <td><code>&#39;geom&#39;</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str | dict</code></td>
        <td><p>CRS to use for the returned GeoDataFrame; if not set, tries to determine CRS from the SRID associated with the first geometry in the database, and assigns that to all geometries. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>[type]</code></td>
      <td><p>[description]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">geom_col</span><span class="o">=</span><span class="s2">&quot;geom&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads data from a PostGIS database and returns a GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        sql (str): SQL query to execute in selecting entries from database, or name of the table to read from the database.</span>
<span class="sd">        con (sqlalchemy.engine.Engine): Active connection to the database to query.</span>
<span class="sd">        geom_col (str, optional): Column name to convert to shapely geometries. Defaults to &quot;geom&quot;.</span>
<span class="sd">        crs (str | dict, optional): CRS to use for the returned GeoDataFrame; if not set, tries to determine CRS from the SRID associated with the first geometry in the database, and assigns that to all geometries. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [type]: [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">geom_col</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_raster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_raster</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">coord_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">request_payer</span><span class="o">=</span><span class="s1">&#39;bucket-owner&#39;</span><span class="p">,</span> <span class="n">env_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.read_raster" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Read a raster from S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The path to the raster on S3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>window</code></td>
        <td><code>tuple</code></td>
        <td><p>The window (col_off, row_off, width, height) to read. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>return_array</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return a numpy array. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>coord_crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate CRS of the input coordinates. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>request_payer</code></td>
        <td><code>str</code></td>
        <td><p>Specifies who pays for the download from S3.
Can be "bucket-owner" or "requester". Defaults to "bucket-owner".</p></td>
        <td><code>&#39;bucket-owner&#39;</code></td>
      </tr>
      <tr>
        <td><code>env_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to rasterio.Env(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>open_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to rasterio.open(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>np.ndarray</code></td>
      <td><p>The raster as a numpy array.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_raster</span><span class="p">(</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">coord_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">request_payer</span><span class="o">=</span><span class="s2">&quot;bucket-owner&quot;</span><span class="p">,</span>
    <span class="n">env_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a raster from S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The path to the raster on S3.</span>
<span class="sd">        window (tuple, optional): The window (col_off, row_off, width, height) to read. Defaults to None.</span>
<span class="sd">        return_array (bool, optional): Whether to return a numpy array. Defaults to True.</span>
<span class="sd">        coord_crs (str, optional): The coordinate CRS of the input coordinates. Defaults to None.</span>
<span class="sd">        request_payer (str, optional): Specifies who pays for the download from S3.</span>
<span class="sd">            Can be &quot;bucket-owner&quot; or &quot;requester&quot;. Defaults to &quot;bucket-owner&quot;.</span>
<span class="sd">        env_args (dict, optional): Additional arguments to pass to rasterio.Env(). Defaults to {}.</span>
<span class="sd">        open_args (dict, optional): Additional arguments to pass to rasterio.open(). Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The raster as a numpy array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>
    <span class="kn">from</span> <span class="nn">rasterio.windows</span> <span class="kn">import</span> <span class="n">Window</span>

    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="n">AWS_REQUEST_PAYER</span><span class="o">=</span><span class="n">request_payer</span><span class="p">,</span> <span class="o">**</span><span class="n">env_args</span><span class="p">):</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">open_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_array</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">src</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">window</span> <span class="o">=</span> <span class="n">Window</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">coords</span> <span class="o">=</span> <span class="n">coords_to_xy</span><span class="p">(</span>
                        <span class="n">source</span><span class="p">,</span>
                        <span class="n">window</span><span class="p">,</span>
                        <span class="n">coord_crs</span><span class="p">,</span>
                        <span class="n">env_args</span><span class="o">=</span><span class="n">env_args</span><span class="p">,</span>
                        <span class="n">open_args</span><span class="o">=</span><span class="n">open_args</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">window</span> <span class="o">=</span> <span class="n">xy_to_window</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
                <span class="n">window</span> <span class="o">=</span> <span class="n">Window</span><span class="p">(</span><span class="o">*</span><span class="n">window</span><span class="p">)</span>

            <span class="n">array</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">array</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.read_rasters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_rasters</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coord_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">request_payer</span><span class="o">=</span><span class="s1">&#39;bucket-owner&#39;</span><span class="p">,</span> <span class="n">env_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.read_rasters" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Read a raster from S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>sources</code></td>
        <td><code>str</code></td>
        <td><p>The list of paths to the raster files.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>window</code></td>
        <td><code>tuple</code></td>
        <td><p>The window (col_off, row_off, width, height) to read. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>coord_crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate CRS of the input coordinates. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>request_payer</code></td>
        <td><code>str</code></td>
        <td><p>Specifies who pays for the download from S3.
Can be "bucket-owner" or "requester". Defaults to "bucket-owner".</p></td>
        <td><code>&#39;bucket-owner&#39;</code></td>
      </tr>
      <tr>
        <td><code>env_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to rasterio.Env(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>open_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to rasterio.open(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>np.ndarray</code></td>
      <td><p>The raster as a numpy array.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_rasters</span><span class="p">(</span>
    <span class="n">sources</span><span class="p">,</span>
    <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">coord_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">request_payer</span><span class="o">=</span><span class="s2">&quot;bucket-owner&quot;</span><span class="p">,</span>
    <span class="n">env_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read a raster from S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        sources (str): The list of paths to the raster files.</span>
<span class="sd">        window (tuple, optional): The window (col_off, row_off, width, height) to read. Defaults to None.</span>
<span class="sd">        coord_crs (str, optional): The coordinate CRS of the input coordinates. Defaults to None.</span>
<span class="sd">        request_payer (str, optional): Specifies who pays for the download from S3.</span>
<span class="sd">            Can be &quot;bucket-owner&quot; or &quot;requester&quot;. Defaults to &quot;bucket-owner&quot;.</span>
<span class="sd">        env_args (dict, optional): Additional arguments to pass to rasterio.Env(). Defaults to {}.</span>
<span class="sd">        open_args (dict, optional): Additional arguments to pass to rasterio.open(). Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The raster as a numpy array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">sources</span><span class="p">]</span>

    <span class="n">array_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">read_raster</span><span class="p">(</span>
            <span class="n">source</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="n">coord_crs</span><span class="p">,</span>
            <span class="n">request_payer</span><span class="p">,</span>
            <span class="n">env_args</span><span class="p">,</span>
            <span class="n">open_args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">array_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">array_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.reduce_gif_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reduce_gif_size</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.reduce_gif_size" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Reduces a GIF image using ffmpeg.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The input file path to the GIF image.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to the GIF image. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">reduce_gif_size</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduces a GIF image using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The input file path to the GIF image.</span>
<span class="sd">        out_gif (str, optional): The output file path to the GIF image. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">ffmpeg</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer. Skip reducing gif size.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tool</span><span class="p">(</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ffmpeg is not installed on your computer. Skip reducing gif size.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_gif</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The input gif file does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">out_gif</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_gif</span> <span class="o">=</span> <span class="n">in_gif</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">in_gif</span> <span class="o">==</span> <span class="n">out_gif</span><span class="p">:</span>
        <span class="n">tmp_gif</span> <span class="o">=</span> <span class="n">in_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;_tmp.gif&quot;</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">in_gif</span><span class="p">,</span> <span class="n">tmp_gif</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">tmp_gif</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">in_gif</span><span class="p">,</span> <span class="n">loglevel</span><span class="o">=</span><span class="s2">&quot;quiet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">overwrite_output</span><span class="p">()</span>
        <span class="n">ffmpeg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmp_gif</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">loglevel</span><span class="o">=</span><span class="s2">&quot;quiet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">overwrite_output</span><span class="p">()</span>
        <span class="n">ffmpeg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.regularize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regularize</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.regularize" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Regularize a polygon GeoDataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | gpd.GeoDataFrame</code></td>
        <td><p>The input file path or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output file path. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>gpd.GeoDataFrame</code></td>
      <td><p>The output GeoDataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">regularize</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Regularize a polygon GeoDataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | gpd.GeoDataFrame): The input file path or a GeoDataFrame.</span>
<span class="sd">        output (str, optional): The output file path. Defaults to None.</span>


<span class="sd">    Returns:</span>
<span class="sd">        gpd.GeoDataFrame: The output GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">source</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input source must be a GeoDataFrame or a file path.&quot;</span><span class="p">)</span>

    <span class="n">polygons</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">geom</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">minimum_rotated_rectangle</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">polygons</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.replace_hyphens_in_keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_hyphens_in_keys</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>


<a href="#leafmap.common.replace_hyphens_in_keys" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Recursively replaces hyphens with underscores in dictionary keys.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>d</code></td>
        <td><code>Union[Dict, List, Any]</code></td>
        <td><p>The input dictionary, list or any other data type.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[Dict, List, Any]</code></td>
      <td><p>The modified dictionary or list with keys having hyphens replaced with underscores,
or the original input if it's not a dictionary or list.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">replace_hyphens_in_keys</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively replaces hyphens with underscores in dictionary keys.</span>

<span class="sd">    Args:</span>
<span class="sd">        d (Union[Dict, List, Any]): The input dictionary, list or any other data type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[Dict, List, Any]: The modified dictionary or list with keys having hyphens replaced with underscores,</span>
<span class="sd">        or the original input if it&#39;s not a dictionary or list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">):</span> <span class="n">replace_hyphens_in_keys</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">replace_hyphens_in_keys</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">d</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.replace_top_level_hyphens" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_top_level_hyphens</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>


<a href="#leafmap.common.replace_top_level_hyphens" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Replaces hyphens with underscores in top-level dictionary keys.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>d</code></td>
        <td><code>Union[Dict, Any]</code></td>
        <td><p>The input dictionary or any other data type.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[Dict, Any]</code></td>
      <td><p>The modified dictionary with top-level keys having hyphens replaced with underscores,
or the original input if it's not a dictionary.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">replace_top_level_hyphens</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces hyphens with underscores in top-level dictionary keys.</span>

<span class="sd">    Args:</span>
<span class="sd">        d (Union[Dict, Any]): The input dictionary or any other data type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[Dict, Any]: The modified dictionary with top-level keys having hyphens replaced with underscores,</span>
<span class="sd">        or the original input if it&#39;s not a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">d</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.reproject" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reproject</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">resampling</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.reproject" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Reprojects an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>image</code></td>
        <td><code>str</code></td>
        <td><p>The input image filepath.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output image filepath.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The destination CRS. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>resampling</code></td>
        <td><code>Resampling</code></td>
        <td><p>The resampling method. Defaults to "nearest".</p></td>
        <td><code>&#39;nearest&#39;</code></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the output image to a Cloud Optimized GeoTIFF. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to rasterio.open.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">reproject</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">resampling</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reprojects an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        image (str): The input image filepath.</span>
<span class="sd">        output (str): The output image filepath.</span>
<span class="sd">        dst_crs (str, optional): The destination CRS. Defaults to &quot;EPSG:4326&quot;.</span>
<span class="sd">        resampling (Resampling, optional): The resampling method. Defaults to &quot;nearest&quot;.</span>
<span class="sd">        to_cog (bool, optional): Whether to convert the output image to a Cloud Optimized GeoTIFF. Defaults to True.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to rasterio.open.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
    <span class="kn">from</span> <span class="nn">rasterio.warp</span> <span class="kn">import</span> <span class="n">calculate_default_transform</span><span class="p">,</span> <span class="n">reproject</span><span class="p">,</span> <span class="n">Resampling</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resampling</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">resampling</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">Resampling</span><span class="p">,</span> <span class="n">resampling</span><span class="p">)</span>

    <span class="n">image</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
        <span class="n">transform</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">calculate_default_transform</span><span class="p">(</span>
            <span class="n">src</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="o">*</span><span class="n">src</span><span class="o">.</span><span class="n">bounds</span>
        <span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="n">dst_crs</span><span class="p">,</span>
                <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="n">transform</span><span class="p">,</span>
                <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
                <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">reproject</span><span class="p">(</span>
                    <span class="n">source</span><span class="o">=</span><span class="n">rio</span><span class="o">.</span><span class="n">band</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                    <span class="n">destination</span><span class="o">=</span><span class="n">rio</span><span class="o">.</span><span class="n">band</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                    <span class="n">src_transform</span><span class="o">=</span><span class="n">src</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
                    <span class="n">src_crs</span><span class="o">=</span><span class="n">src</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                    <span class="n">dst_transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
                    <span class="n">dst_crs</span><span class="o">=</span><span class="n">dst_crs</span><span class="p">,</span>
                    <span class="n">resampling</span><span class="o">=</span><span class="n">resampling</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">to_cog</span><span class="p">:</span>
        <span class="n">image_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.rgb_to_hex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rgb_to_hex</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span></code>


<a href="#leafmap.common.rgb_to_hex" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts RGB to hex color. In RGB color R stands for Red, G stands for Green, and B stands for Blue, and it ranges from the decimal value of 0  255.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>rgb</code></td>
        <td><code>tuple</code></td>
        <td><p>RGB color code as a tuple of (red, green, blue). Defaults to (255, 255, 255).</p></td>
        <td><code>(255, 255, 255)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>hex color code</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rgb_to_hex</span><span class="p">(</span><span class="n">rgb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts RGB to hex color. In RGB color R stands for Red, G stands for Green, and B stands for Blue, and it ranges from the decimal value of 0  255.</span>

<span class="sd">    Args:</span>
<span class="sd">        rgb (tuple, optional): RGB color code as a tuple of (red, green, blue). Defaults to (255, 255, 255).</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: hex color code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%02x%02x%02x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">rgb</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.s3_download_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_download_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bucket</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.s3_download_file" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download a file from S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The full path to the file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>The name of the bucket. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>str</code></td>
        <td><p>The key of the file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>outfile</code></td>
        <td><code>str</code></td>
        <td><p>The name of the output file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If boto3 is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">s3_download_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bucket</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file from S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str, optional): The full path to the file. Defaults to None.</span>
<span class="sd">        bucket (str, optional): The name of the bucket. Defaults to None.</span>
<span class="sd">        key (str, optional): The key of the file. Defaults to None.</span>
<span class="sd">        outfile (str, optional): The name of the output file. Defaults to None.</span>
<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If boto3 is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">boto3</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;boto3 is not installed. Install it with pip install boto3&quot;</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])</span>

    <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outfile</span><span class="p">):</span>
        <span class="n">client</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File already exists: </span><span class="si">{</span><span class="n">outfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.s3_download_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_download_files</span><span class="p">(</span><span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bucket</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.s3_download_files" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download multiple files from S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filenames</code></td>
        <td><code>list</code></td>
        <td><p>A list of filenames. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>The name of the bucket. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>keys</code></td>
        <td><code>list</code></td>
        <td><p>A list of keys. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>outdir</code></td>
        <td><code>str</code></td>
        <td><p>The name of the output directory. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If neither filenames or keys are provided.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">s3_download_files</span><span class="p">(</span>
    <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bucket</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download multiple files from S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        filenames (list, optional): A list of filenames. Defaults to None.</span>
<span class="sd">        bucket (str, optional): The name of the bucket. Defaults to None.</span>
<span class="sd">        keys (list, optional): A list of keys. Defaults to None.</span>
<span class="sd">        outdir (str, optional): The name of the output directory. Defaults to None.</span>
<span class="sd">        quiet (bool, optional): Suppress output. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If neither filenames or keys are provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">filenames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
                <span class="n">bucket</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])</span>
                <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">filenames</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either filenames or keys must be provided&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outdir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">outfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">s3_download_file</span><span class="p">(</span><span class="n">bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.s3_get_object" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_get_object</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1048576</span><span class="p">,</span> <span class="n">request_payer</span><span class="o">=</span><span class="s1">&#39;bucket-owner&#39;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">client_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.s3_get_object" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download a file from S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>The name of the bucket.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>key</code></td>
        <td><p>The key of the file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The name of the output file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>chunk_size</code></td>
        <td><code>int</code></td>
        <td><p>The chunk size in bytes. Defaults to 1024 * 1024.</p></td>
        <td><code>1048576</code></td>
      </tr>
      <tr>
        <td><code>request_payer</code></td>
        <td><code>str</code></td>
        <td><p>Specifies who pays for the download from S3.</p></td>
        <td><code>&#39;bucket-owner&#39;</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress output. Defaults to False.
Can be "bucket-owner" or "requester". Defaults to "bucket-owner".</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>client_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to boto3.client(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional arguments to pass to boto3.client().get_object().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">s3_get_object</span><span class="p">(</span>
    <span class="n">bucket</span><span class="p">,</span>
    <span class="n">key</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">request_payer</span><span class="o">=</span><span class="s2">&quot;bucket-owner&quot;</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">client_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file from S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket (str): The name of the bucket.</span>
<span class="sd">        key (key): The key of the file.</span>
<span class="sd">        output (str, optional): The name of the output file. Defaults to None.</span>
<span class="sd">        chunk_size (int, optional): The chunk size in bytes. Defaults to 1024 * 1024.</span>
<span class="sd">        request_payer (str, optional): Specifies who pays for the download from S3.</span>
<span class="sd">        quiet (bool, optional): Suppress output. Defaults to False.</span>
<span class="sd">            Can be &quot;bucket-owner&quot; or &quot;requester&quot;. Defaults to &quot;bucket-owner&quot;.</span>
<span class="sd">        client_args (dict, optional): Additional arguments to pass to boto3.client(). Defaults to {}.</span>
<span class="sd">        **kwargs: Additional arguments to pass to boto3.client().get_object().</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">boto3</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;boto3 is not installed. Install it with pip install boto3&quot;</span><span class="p">)</span>

    <span class="c1"># Set up the S3 client</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">client_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="c1"># Set up the progress bar</span>
    <span class="k">def</span> <span class="nf">progress_callback</span><span class="p">(</span><span class="n">bytes_amount</span><span class="p">):</span>
        <span class="c1"># This function will be called by the StreamingBody object</span>
        <span class="c1"># to report the number of bytes downloaded so far</span>
        <span class="n">total_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;ContentLength&quot;</span><span class="p">])</span>
        <span class="n">progress_percent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bytes_amount</span> <span class="o">/</span> <span class="n">total_size</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Downloading: </span><span class="si">{</span><span class="n">progress_percent</span><span class="si">}</span><span class="s2">% complete.&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># Download the file</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span>
        <span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">RequestPayer</span><span class="o">=</span><span class="n">request_payer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>

    <span class="c1"># Save the file to disk</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Use the StreamingBody object to read the file in chunks</span>
        <span class="c1"># and track the download progress</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span>
        <span class="n">downloaded_bytes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">body</span><span class="o">.</span><span class="n">iter_chunks</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            <span class="n">downloaded_bytes</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            <span class="n">progress_callback</span><span class="p">(</span><span class="n">downloaded_bytes</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.s3_get_objects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_get_objects</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1048576</span><span class="p">,</span> <span class="n">request_payer</span><span class="o">=</span><span class="s1">&#39;bucket-owner&#39;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">client_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.s3_get_objects" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download multiple files from S3.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>The name of the bucket.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>keys</code></td>
        <td><code>list</code></td>
        <td><p>A list of keys. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The name of the output directory. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>Limits the response to keys that begin with the specified prefix. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>limit</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of keys returned in the response body.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>Filter by file extension. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>chunk_size</code></td>
        <td><code>int</code></td>
        <td><p>The chunk size in bytes. Defaults to 1024 * 1024.</p></td>
        <td><code>1048576</code></td>
      </tr>
      <tr>
        <td><code>request_payer</code></td>
        <td><code>str</code></td>
        <td><p>Specifies who pays for the download from S3.
Can be "bucket-owner" or "requester". Defaults to "bucket-owner".</p></td>
        <td><code>&#39;bucket-owner&#39;</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress output. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>client_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to boto3.client(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional arguments to pass to boto3.client().get_object().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">s3_get_objects</span><span class="p">(</span>
    <span class="n">bucket</span><span class="p">,</span>
    <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">request_payer</span><span class="o">=</span><span class="s2">&quot;bucket-owner&quot;</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">client_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download multiple files from S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket (str): The name of the bucket.</span>
<span class="sd">        keys (list, optional): A list of keys. Defaults to None.</span>
<span class="sd">        out_dir (str, optional): The name of the output directory. Defaults to None.</span>
<span class="sd">        prefix (str, optional): Limits the response to keys that begin with the specified prefix. Defaults to None.</span>
<span class="sd">        limit (int, optional): The maximum number of keys returned in the response body.</span>
<span class="sd">        ext (str, optional): Filter by file extension. Defaults to None.</span>
<span class="sd">        chunk_size (int, optional): The chunk size in bytes. Defaults to 1024 * 1024.</span>
<span class="sd">        request_payer (str, optional): Specifies who pays for the download from S3.</span>
<span class="sd">            Can be &quot;bucket-owner&quot; or &quot;requester&quot;. Defaults to &quot;bucket-owner&quot;.</span>
<span class="sd">        quiet (bool, optional): Suppress output. Defaults to True.</span>
<span class="sd">        client_args (dict, optional): Additional arguments to pass to boto3.client(). Defaults to {}.</span>
<span class="sd">        **kwargs: Additional arguments to pass to boto3.client().get_object().</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">boto3</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;boto3 is not installed. Install it with pip install boto3&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fullpath</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">s3_list_objects</span><span class="p">(</span>
            <span class="n">bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">fullpath</span><span class="p">,</span> <span class="n">request_payer</span><span class="p">,</span> <span class="n">client_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">s3_get_object</span><span class="p">(</span>
            <span class="n">bucket</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">,</span> <span class="n">request_payer</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="n">client_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.s3_list_objects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">s3_list_objects</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fullpath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">request_payer</span><span class="o">=</span><span class="s1">&#39;bucket-owner&#39;</span><span class="p">,</span> <span class="n">client_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.s3_list_objects" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>List objects in a S3 bucket</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bucket</code></td>
        <td><code>str</code></td>
        <td><p>The name of the bucket.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>Limits the response to keys that begin with the specified prefix. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>limit</code></td>
        <td><code>init</code></td>
        <td><p>The maximum number of keys returned in the response body.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ext</code></td>
        <td><code>str</code></td>
        <td><p>Filter by file extension. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fullpath</code></td>
        <td><code>bool</code></td>
        <td><p>Return full path. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>request_payer</code></td>
        <td><code>str</code></td>
        <td><p>Specifies who pays for the download from S3.
Can be "bucket-owner" or "requester". Defaults to "bucket-owner".</p></td>
        <td><code>&#39;bucket-owner&#39;</code></td>
      </tr>
      <tr>
        <td><code>client_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to boto3.client(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>List of objects.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">s3_list_objects</span><span class="p">(</span>
    <span class="n">bucket</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fullpath</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">request_payer</span><span class="o">=</span><span class="s2">&quot;bucket-owner&quot;</span><span class="p">,</span>
    <span class="n">client_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List objects in a S3 bucket</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket (str): The name of the bucket.</span>
<span class="sd">        prefix (str, optional): Limits the response to keys that begin with the specified prefix. Defaults to None.</span>
<span class="sd">        limit (init, optional): The maximum number of keys returned in the response body.</span>
<span class="sd">        ext (str, optional): Filter by file extension. Defaults to None.</span>
<span class="sd">        fullpath (bool, optional): Return full path. Defaults to True.</span>
<span class="sd">        request_payer (str, optional): Specifies who pays for the download from S3.</span>
<span class="sd">            Can be &quot;bucket-owner&quot; or &quot;requester&quot;. Defaults to &quot;bucket-owner&quot;.</span>
<span class="sd">        client_args (dict, optional): Additional arguments to pass to boto3.client(). Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">boto3</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;boto3 is not installed. Install it with pip install boto3&quot;</span><span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">client_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;Prefix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;RequestPayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request_payer</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">limit</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;MaxKeys&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_objects_v2</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;Contents&quot;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">paginator</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_objects_v2&quot;</span><span class="p">)</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Contents&quot;</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">fullpath</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">bucket</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;Key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.save_colorbar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_colorbar</span><span class="p">(</span><span class="n">out_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label_weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">tick_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.save_colorbar" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a standalone colorbar and save it as an image.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>out_fig</code></td>
        <td><code>str</code></td>
        <td><p>Path to the output image.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>float</code></td>
        <td><p>Width of the colorbar in inches. Default is 4.0.</p></td>
        <td><code>4.0</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>float</code></td>
        <td><p>Height of the colorbar in inches. Default is 0.3.</p></td>
        <td><code>0.3</code></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>Minimum value of the colorbar. Default is 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>Maximum value of the colorbar. Default is 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>palette</code></td>
        <td><code>list</code></td>
        <td><p>List of colors to use for the colorbar. It can also be a cmap name, such as ndvi, ndwi, dem, coolwarm. Default is None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vis_params</code></td>
        <td><code>dict</code></td>
        <td><p>Visualization parameters as a dictionary. See https://developers.google.com/earth-engine/guides/image_visualization for options.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>Matplotlib colormap. Defaults to "gray". See https://matplotlib.org/3.3.4/tutorials/colors/colormaps.html#sphx-glr-tutorials-colors-colormaps-py for options.</p></td>
        <td><code>&#39;gray&#39;</code></td>
      </tr>
      <tr>
        <td><code>discrete</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to create a discrete colorbar. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>label</code></td>
        <td><code>str</code></td>
        <td><p>Label for the colorbar. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>label_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar label. Defaults to 12.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>label_weight</code></td>
        <td><code>str</code></td>
        <td><p>Font weight for the colorbar label, can be "normal", "bold", etc. Defaults to "normal".</p></td>
        <td><code>&#39;normal&#39;</code></td>
      </tr>
      <tr>
        <td><code>tick_size</code></td>
        <td><code>int</code></td>
        <td><p>Font size for the colorbar tick labels. Defaults to 10.</p></td>
        <td><code>8</code></td>
      </tr>
      <tr>
        <td><code>bg_color</code></td>
        <td><code>str</code></td>
        <td><p>Background color for the colorbar. Defaults to "white".</p></td>
        <td><code>&#39;white&#39;</code></td>
      </tr>
      <tr>
        <td><code>orientation</code></td>
        <td><code>str</code></td>
        <td><p>Orientation of the colorbar, such as "vertical" and "horizontal". Defaults to "horizontal".</p></td>
        <td><code>&#39;horizontal&#39;</code></td>
      </tr>
      <tr>
        <td><code>dpi</code></td>
        <td><code>float | str</code></td>
        <td><p>The resolution in dots per inch.  If 'figure', use the figure's dpi value. Defaults to "figure".</p></td>
        <td><code>&#39;figure&#39;</code></td>
      </tr>
      <tr>
        <td><code>transparent</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to make the background transparent. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>show_colorbar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show the colorbar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Other keyword arguments to pass to matplotlib.pyplot.savefig().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path to the output image.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_colorbar</span><span class="p">(</span>
    <span class="n">out_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vis_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
    <span class="n">discrete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">label_weight</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">tick_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span>
    <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a standalone colorbar and save it as an image.</span>

<span class="sd">    Args:</span>
<span class="sd">        out_fig (str): Path to the output image.</span>
<span class="sd">        width (float): Width of the colorbar in inches. Default is 4.0.</span>
<span class="sd">        height (float): Height of the colorbar in inches. Default is 0.3.</span>
<span class="sd">        vmin (float): Minimum value of the colorbar. Default is 0.</span>
<span class="sd">        vmax (float): Maximum value of the colorbar. Default is 1.0.</span>
<span class="sd">        palette (list): List of colors to use for the colorbar. It can also be a cmap name, such as ndvi, ndwi, dem, coolwarm. Default is None.</span>
<span class="sd">        vis_params (dict): Visualization parameters as a dictionary. See https://developers.google.com/earth-engine/guides/image_visualization for options.</span>
<span class="sd">        cmap (str, optional): Matplotlib colormap. Defaults to &quot;gray&quot;. See https://matplotlib.org/3.3.4/tutorials/colors/colormaps.html#sphx-glr-tutorials-colors-colormaps-py for options.</span>
<span class="sd">        discrete (bool, optional): Whether to create a discrete colorbar. Defaults to False.</span>
<span class="sd">        label (str, optional): Label for the colorbar. Defaults to None.</span>
<span class="sd">        label_size (int, optional): Font size for the colorbar label. Defaults to 12.</span>
<span class="sd">        label_weight (str, optional): Font weight for the colorbar label, can be &quot;normal&quot;, &quot;bold&quot;, etc. Defaults to &quot;normal&quot;.</span>
<span class="sd">        tick_size (int, optional): Font size for the colorbar tick labels. Defaults to 10.</span>
<span class="sd">        bg_color (str, optional): Background color for the colorbar. Defaults to &quot;white&quot;.</span>
<span class="sd">        orientation (str, optional): Orientation of the colorbar, such as &quot;vertical&quot; and &quot;horizontal&quot;. Defaults to &quot;horizontal&quot;.</span>
<span class="sd">        dpi (float | str, optional): The resolution in dots per inch.  If &#39;figure&#39;, use the figure&#39;s dpi value. Defaults to &quot;figure&quot;.</span>
<span class="sd">        transparent (bool, optional): Whether to make the background transparent. Defaults to False.</span>
<span class="sd">        show_colorbar (bool, optional): Whether to show the colorbar. Defaults to True.</span>
<span class="sd">        **kwargs: Other keyword arguments to pass to matplotlib.pyplot.savefig().</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the output image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">.colormaps</span> <span class="kn">import</span> <span class="n">palettes</span><span class="p">,</span> <span class="n">get_palette</span>

    <span class="k">if</span> <span class="n">out_fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out_fig</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_fig</span> <span class="o">=</span> <span class="n">check_file_path</span><span class="p">(</span><span class="n">out_fig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">vis_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vis_params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The vis_params must be a dictionary.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">palette</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">palette</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ndvi&quot;</span><span class="p">,</span> <span class="s2">&quot;ndwi&quot;</span><span class="p">,</span> <span class="s2">&quot;dem&quot;</span><span class="p">]:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">palettes</span><span class="p">[</span><span class="n">palette</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">palette</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">palettes</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">get_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
        <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">palette</span>

    <span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">orientation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="s2">&quot;vertical&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The orientation must be either horizontal or vertical.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;opacity&quot;</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;opacity&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided opacity value must be type scalar.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="s2">&quot;palette&quot;</span> <span class="ow">in</span> <span class="n">vis_params</span><span class="p">:</span>
        <span class="n">hexcodes</span> <span class="o">=</span> <span class="n">to_hex_colors</span><span class="p">(</span><span class="n">vis_params</span><span class="p">[</span><span class="s2">&quot;palette&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">discrete</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">hexcodes</span><span class="p">)</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
                <span class="s2">&quot;custom&quot;</span><span class="p">,</span> <span class="n">hexcodes</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">256</span>
            <span class="p">)</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="n">cmap</span><span class="p">]</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;cmap keyword or &quot;palette&quot; key in vis_params must be provided.&#39;</span>
        <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">label_size</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">label_weight</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">tick_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">transparent</span><span class="p">:</span>
        <span class="n">bg_color</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">bg_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bg_color</span>
    <span class="k">if</span> <span class="s2">&quot;bbox_inches&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bbox_inches&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">out_fig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">show_colorbar</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out_fig</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.save_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file_ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.save_data" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Save data in the memory to a file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>object</code></td>
        <td><p>The data to be saved.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_ext</code></td>
        <td><code>str</code></td>
        <td><p>The file extension of the file.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>file_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the file to be saved. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path of the file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file_ext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save data in the memory to a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (object): The data to be saved.</span>
<span class="sd">        file_ext (str): The file extension of the file.</span>
<span class="sd">        file_name (str, optional): The name of the file to be saved. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path of the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">tempfile</span>
    <span class="kn">import</span> <span class="nn">uuid</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file_ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">):</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">file_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
                <span class="n">file_ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">file_ext</span>

        <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">file_ext</span><span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="n">file_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_id</span><span class="si">}{</span><span class="n">file_ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">file_path</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.screen_capture" class="doc doc-heading">
<code class="highlight language-python"><span class="n">screen_capture</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#leafmap.common.screen_capture" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Takes a full screenshot of the selected monitor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>outfile</code></td>
        <td><code>str</code></td>
        <td><p>The output file path to the screenshot.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>monitor</code></td>
        <td><code>int</code></td>
        <td><p>The monitor to take the screenshot. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">screen_capture</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes a full screenshot of the selected monitor.</span>

<span class="sd">    Args:</span>
<span class="sd">        outfile (str): The output file path to the screenshot.</span>
<span class="sd">        monitor (int, optional): The monitor to take the screenshot. Defaults to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">mss</span> <span class="kn">import</span> <span class="n">mss</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Please install mss using &#39;pip install mss&#39;&quot;</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">monitor</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The monitor number must be an integer.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">mss</span><span class="p">()</span> <span class="k">as</span> <span class="n">sct</span><span class="p">:</span>
            <span class="n">sct</span><span class="o">.</span><span class="n">shot</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">outfile</span><span class="p">,</span> <span class="n">mon</span><span class="o">=</span><span class="n">monitor</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">outfile</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.search_qms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_qms</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">list_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.search_qms" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Search for QMS tile providers from Quick Map Services.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>keyword</code></td>
        <td><code>str</code></td>
        <td><p>The keyword to search for.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>limit</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of results to return. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>list_only</code></td>
        <td><code>bool</code></td>
        <td><p>If True, only the list of services will be returned. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>add_prefix</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the prefix "qms." will be added to the service name. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of QMS tile providers.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">search_qms</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">list_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search for QMS tile providers from Quick Map Services.</span>

<span class="sd">    Args:</span>
<span class="sd">        keyword (str): The keyword to search for.</span>
<span class="sd">        limit (int, optional): The maximum number of results to return. Defaults to 10.</span>
<span class="sd">        list_only (bool, optional): If True, only the list of services will be returned. Defaults to True.</span>
<span class="sd">        add_prefix (bool, optional): If True, the prefix &quot;qms.&quot; will be added to the service name. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of QMS tile providers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">QMS_API</span> <span class="o">=</span> <span class="s2">&quot;https://qms.nextgis.com/api/v1/geoservices&quot;</span>
    <span class="n">services</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">QMS_API</span><span class="si">}</span><span class="s2">/?search=</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s2">&amp;type=tms&amp;epsg=3857&amp;limit=</span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">services</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">services</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]:</span>
        <span class="n">providers</span> <span class="o">=</span> <span class="n">services</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">list_only</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">add_prefix</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;qms.&quot;</span> <span class="o">+</span> <span class="n">provider</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">provider</span> <span class="ow">in</span> <span class="n">providers</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">provider</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">provider</span> <span class="ow">in</span> <span class="n">providers</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">providers</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.search_xyz_services" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_xyz_services</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">list_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.search_xyz_services" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Search for XYZ tile providers from xyzservices.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>keyword</code></td>
        <td><code>str</code></td>
        <td><p>The keyword to search for.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the xyz tile. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>list_only</code></td>
        <td><code>bool</code></td>
        <td><p>If True, only the list of services will be returned. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>add_prefix</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the prefix "xyz." will be added to the service name. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of XYZ tile providers.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">search_xyz_services</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">list_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search for XYZ tile providers from xyzservices.</span>

<span class="sd">    Args:</span>
<span class="sd">        keyword (str): The keyword to search for.</span>
<span class="sd">        name (str, optional): The name of the xyz tile. Defaults to None.</span>
<span class="sd">        list_only (bool, optional): If True, only the list of services will be returned. Defaults to True.</span>
<span class="sd">        add_prefix (bool, optional): If True, the prefix &quot;xyz.&quot; will be added to the service name. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of XYZ tile providers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">xyzservices.providers</span> <span class="k">as</span> <span class="nn">xyz</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">providers</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="n">keyword</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">providers</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">list_only</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">add_prefix</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;xyz.&quot;</span> <span class="o">+</span> <span class="n">provider</span> <span class="k">for</span> <span class="n">provider</span> <span class="ow">in</span> <span class="n">providers</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">provider</span> <span class="k">for</span> <span class="n">provider</span> <span class="ow">in</span> <span class="n">providers</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">providers</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.select_largest" class="doc doc-heading">
<code class="highlight language-python"><span class="n">select_largest</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.select_largest" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Select the largest features in a GeoDataFrame based on a column.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | gpd.GeoDataFrame</code></td>
        <td><p>The path to the vector file or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>column</code></td>
        <td><code>str</code></td>
        <td><p>The column to sort by.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>count</code></td>
        <td><code>int</code></td>
        <td><p>The number of features to select. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output vector file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path to the output vector file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">select_largest</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select the largest features in a GeoDataFrame based on a column.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | gpd.GeoDataFrame): The path to the vector file or a GeoDataFrame.</span>
<span class="sd">        column (str): The column to sort by.</span>
<span class="sd">        count (int, optional): The number of features to select. Defaults to 1.</span>
<span class="sd">        output (str, optional): The path to the output vector file. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the output vector file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">source</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;source must be a GeoDataFrame or a file path&quot;</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.set_api_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_api_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GOOGLE_MAPS_API_KEY&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.set_api_key" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Sets the Google Maps API key. You can generate one from https://bit.ly/3sw0THG.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>key</code></td>
        <td><code>str</code></td>
        <td><p>The Google Maps API key.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the environment variable. Defaults to "GOOGLE_MAPS_API_KEY".</p></td>
        <td><code>&#39;GOOGLE_MAPS_API_KEY&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_api_key</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GOOGLE_MAPS_API_KEY&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the Google Maps API key. You can generate one from https://bit.ly/3sw0THG.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The Google Maps API key.</span>
<span class="sd">        name (str, optional): The name of the environment variable. Defaults to &quot;GOOGLE_MAPS_API_KEY&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.set_proxy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_proxy</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">1080</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;http://127.0.0.1&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.set_proxy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Sets proxy if needed. This is only needed for countries where Google services are not available.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>port</code></td>
        <td><code>int</code></td>
        <td><p>The proxy port number. Defaults to 1080.</p></td>
        <td><code>1080</code></td>
      </tr>
      <tr>
        <td><code>ip</code></td>
        <td><code>str</code></td>
        <td><p>The IP address. Defaults to 'http://127.0.0.1'.</p></td>
        <td><code>&#39;http://127.0.0.1&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_proxy</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1080</span><span class="p">,</span> <span class="n">ip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;http://127.0.0.1&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets proxy if needed. This is only needed for countries where Google services are not available.</span>

<span class="sd">    Args:</span>
<span class="sd">        port (int, optional): The proxy port number. Defaults to 1080.</span>
<span class="sd">        ip (str, optional): The IP address. Defaults to &#39;http://127.0.0.1&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ip</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;http://&quot;</span> <span class="o">+</span> <span class="n">ip</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HTTP_PROXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HTTPS_PROXY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://google.com&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Failed to connect to Google services. Please double check the port number and ip address.&quot;</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.show_html" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_html</span><span class="p">(</span><span class="n">html</span><span class="p">)</span></code>


<a href="#leafmap.common.show_html" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Shows HTML within Jupyter notebook.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>html</code></td>
        <td><code>str</code></td>
        <td><p>File path or HTML string.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the file does not exist.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ipywidgets.HTML</code></td>
      <td><p>HTML widget.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">show_html</span><span class="p">(</span><span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shows HTML within Jupyter notebook.</span>

<span class="sd">    Args:</span>
<span class="sd">        html (str): File path or HTML string.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the file does not exist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ipywidgets.HTML: HTML widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">widget</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">html</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">widget</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.show_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_image</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.show_image" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Shows an image within Jupyter notebook.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>img_path</code></td>
        <td><code>str</code></td>
        <td><p>The image file path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>Width of the image in pixels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>int</code></td>
        <td><p>Height of the image in pixels. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">show_image</span><span class="p">(</span>
    <span class="n">img_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shows an image within Jupyter notebook.</span>

<span class="sd">    Args:</span>
<span class="sd">        img_path (str): The image file path.</span>
<span class="sd">        width (int, optional): Width of the image in pixels. Defaults to None.</span>
<span class="sd">        height (int, optional): Height of the image in pixels. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
        <span class="c1"># layout={&#39;border&#39;: &#39;1px solid black&#39;})</span>
        <span class="c1"># layout={&#39;border&#39;: &#39;1px solid black&#39;, &#39;width&#39;: str(width + 20) + &#39;px&#39;, &#39;height&#39;: str(height + 10) + &#39;px&#39;},)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">out</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">display</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">image</span><span class="p">))</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">display</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You need set both width and height.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.show_youtube_video" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show_youtube_video</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span> <span class="n">allow_autoplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.show_youtube_video" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Displays a Youtube video in a Jupyter notebook.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>string</code></td>
        <td><p>a link to a Youtube video.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>int</code></td>
        <td><p>the width of the video. Defaults to 800.</p></td>
        <td><code>800</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>int</code></td>
        <td><p>the height of the video. Defaults to 600.</p></td>
        <td><code>450</code></td>
      </tr>
      <tr>
        <td><code>allow_autoplay</code></td>
        <td><code>bool</code></td>
        <td><p>whether to allow autoplay. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>further arguments for IPython.display.YouTubeVideo</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>YouTubeVideo</code></td>
      <td><p>a video that is displayed in your notebook.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">show_youtube_video</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span> <span class="n">allow_autoplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays a Youtube video in a Jupyter notebook.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (string): a link to a Youtube video.</span>
<span class="sd">        width (int, optional): the width of the video. Defaults to 800.</span>
<span class="sd">        height (int, optional): the height of the video. Defaults to 600.</span>
<span class="sd">        allow_autoplay (bool, optional): whether to allow autoplay. Defaults to False.</span>
<span class="sd">        **kwargs: further arguments for IPython.display.YouTubeVideo</span>

<span class="sd">    Returns:</span>
<span class="sd">        YouTubeVideo: a video that is displayed in your notebook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">re</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;URL must be a string&quot;</span><span class="p">)</span>

    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;^https?:\/\/(?:www\.)?youtube\.com\/watch\?(?=.*v=([^\s&amp;]+)).*$|^https?:\/\/(?:www\.)?youtu\.be\/([^\s&amp;]+).*$&quot;</span><span class="p">,</span>
        <span class="n">url</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid YouTube video URL&quot;</span><span class="p">)</span>

    <span class="n">video_id</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">YouTubeVideo</span><span class="p">(</span>
        <span class="n">video_id</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">allow_autoplay</span><span class="o">=</span><span class="n">allow_autoplay</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.shp_to_gdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shp_to_gdf</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span></code>


<a href="#leafmap.common.shp_to_gdf" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a shapefile to Geopandas dataframe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_shp</code></td>
        <td><code>str</code></td>
        <td><p>File path to the input shapefile.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>The provided shp could not be found.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>gpd.GeoDataFrame</code></td>
      <td><p>geopandas.GeoDataFrame</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">shp_to_gdf</span><span class="p">(</span><span class="n">in_shp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a shapefile to Geopandas dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_shp (str): File path to the input shapefile.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: The provided shp could not be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpd.GeoDataFrame: geopandas.GeoDataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">in_shp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">in_shp</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;The provided shp could not be found.&quot;</span><span class="p">)</span>

    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_shp</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.shp_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shp_to_geojson</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.shp_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a shapefile to GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_shp</code></td>
        <td><code>str</code></td>
        <td><p>File path of the input shapefile.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>File path of the output GeoJSON. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>The json object representing the shapefile.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">shp_to_geojson</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a shapefile to GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_shp (str): File path of the input shapefile.</span>
<span class="sd">        output (str, optional): File path of the output GeoJSON. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: The json object representing the shapefile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">in_shp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.skip_mkdocs_build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">skip_mkdocs_build</span><span class="p">()</span></code>


<a href="#leafmap.common.skip_mkdocs_build" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Skips the MkDocs build if the USE_MKDOCS environment variable is set.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether to skip the MkDocs build.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">skip_mkdocs_build</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Skips the MkDocs build if the USE_MKDOCS environment variable is set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: Whether to skip the MkDocs build.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.split_raster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">split_raster</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">tile_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;tile&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.split_raster" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Split a raster into tiles.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The path or http URL to the raster file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_dir</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tile_size</code></td>
        <td><code>int | tuple</code></td>
        <td><p>The size of the tiles. Can be an integer or a tuple of (width, height). Defaults to 256.</p></td>
        <td><code>256</code></td>
      </tr>
      <tr>
        <td><code>overlap</code></td>
        <td><code>int</code></td>
        <td><p>The number of pixels to overlap between tiles. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>The prefix of the output tiles. Defaults to "tile".</p></td>
        <td><code>&#39;tile&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>Raised if GDAL is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">split_raster</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">tile_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;tile&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split a raster into tiles.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The path or http URL to the raster file.</span>
<span class="sd">        out_dir (str): The path to the output directory.</span>
<span class="sd">        tile_size (int | tuple, optional): The size of the tiles. Can be an integer or a tuple of (width, height). Defaults to 256.</span>
<span class="sd">        overlap (int, optional): The number of pixels to overlap between tiles. Defaults to 0.</span>
<span class="sd">        prefix (str, optional): The prefix of the output tiles. Defaults to &quot;tile&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: Raised if GDAL is not installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;GDAL is required to use this function. Install it with `conda install gdal -c conda-forge`&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">output</span>

    <span class="c1"># Open the input GeoTIFF file</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tile_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">tile_width</span> <span class="o">=</span> <span class="n">tile_size</span>
        <span class="n">tile_height</span> <span class="o">=</span> <span class="n">tile_size</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tile_size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">tile_width</span> <span class="o">=</span> <span class="n">tile_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tile_height</span> <span class="o">=</span> <span class="n">tile_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Get the size of the input raster</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterXSize</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterYSize</span>

    <span class="c1"># Calculate the number of tiles needed in both directions, taking into account the overlap</span>
    <span class="n">num_tiles_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">tile_width</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span>
        <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">tile_width</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">)</span>
    <span class="n">num_tiles_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">tile_height</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span>
        <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">tile_height</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">)</span>

    <span class="c1"># Get the georeferencing information of the input raster</span>
    <span class="n">geotransform</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>

    <span class="c1"># Loop over all the tiles</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tiles_x</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tiles_y</span><span class="p">):</span>
            <span class="c1"># Calculate the pixel coordinates of the tile, taking into account the overlap and clamping to the edge of the raster</span>
            <span class="n">x_min</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">tile_width</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span>
            <span class="n">y_min</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">tile_height</span> <span class="o">-</span> <span class="n">overlap</span><span class="p">)</span>
            <span class="n">x_max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_min</span> <span class="o">+</span> <span class="n">tile_width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
            <span class="n">y_max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_min</span> <span class="o">+</span> <span class="n">tile_height</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

            <span class="c1"># Adjust the size of the last tile in each row and column to include any remaining pixels</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num_tiles_x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">x_min</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">tile_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">num_tiles_y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">y_min</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">tile_height</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Calculate the size of the tile, taking into account the overlap</span>
            <span class="n">tile_width</span> <span class="o">=</span> <span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span>
            <span class="n">tile_height</span> <span class="o">=</span> <span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span>

            <span class="c1"># Set the output file name</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">out_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">.tif&quot;</span>

            <span class="c1"># Create a new dataset for the tile</span>
            <span class="n">driver</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="s2">&quot;GTiff&quot;</span><span class="p">)</span>
            <span class="n">tile_ds</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span>
                <span class="n">output_file</span><span class="p">,</span>
                <span class="n">tile_width</span><span class="p">,</span>
                <span class="n">tile_height</span><span class="p">,</span>
                <span class="n">ds</span><span class="o">.</span><span class="n">RasterCount</span><span class="p">,</span>
                <span class="n">ds</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">DataType</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Calculate the georeferencing information for the output tile</span>
            <span class="n">tile_geotransform</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">geotransform</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_min</span> <span class="o">*</span> <span class="n">geotransform</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">geotransform</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">geotransform</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_min</span> <span class="o">*</span> <span class="n">geotransform</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">geotransform</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="c1"># Set the geotransform and projection of the tile</span>
            <span class="n">tile_ds</span><span class="o">.</span><span class="n">SetGeoTransform</span><span class="p">(</span><span class="n">tile_geotransform</span><span class="p">)</span>
            <span class="n">tile_ds</span><span class="o">.</span><span class="n">SetProjection</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">GetProjection</span><span class="p">())</span>

            <span class="c1"># Read the data from the input raster band(s) and write it to the tile band(s)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">RasterCount</span><span class="p">):</span>
                <span class="n">band</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">tile_band</span> <span class="o">=</span> <span class="n">tile_ds</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">tile_data</span> <span class="o">=</span> <span class="n">band</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">tile_width</span><span class="p">,</span> <span class="n">tile_height</span><span class="p">)</span>
                <span class="n">tile_band</span><span class="o">.</span><span class="n">WriteArray</span><span class="p">(</span><span class="n">tile_data</span><span class="p">)</span>

            <span class="c1"># Close the tile dataset</span>
            <span class="n">tile_ds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Close the input dataset</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.st_download_button" class="doc doc-heading">
<code class="highlight language-python"><span class="n">st_download_button</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_click</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">csv_sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.st_download_button" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Streamlit function to create a download button.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>label</code></td>
        <td><code>str</code></td>
        <td><p>A short label explaining to the user what this button is for..</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>str | list</code></td>
        <td><p>The contents of the file to be downloaded. See example below for caching techniques to avoid recomputing this data unnecessarily.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_name</code></td>
        <td><code>str</code></td>
        <td><p>An optional string to use as the name of the file to be downloaded, such as 'my_file.csv'. If not specified, the name will be automatically generated. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mime</code></td>
        <td><code>str</code></td>
        <td><p>The MIME type of the data. If None, defaults to "text/plain" (if data is of type str or is a textual file) or "application/octet-stream" (if data is of type bytes or is a binary file). Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>key</code></td>
        <td><code>str</code></td>
        <td><p>An optional string or integer to use as the unique key for the widget. If this is omitted, a key will be generated for the widget based on its content. Multiple widgets of the same type may not share the same key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>help</code></td>
        <td><code>str</code></td>
        <td><p>An optional tooltip that gets displayed when the button is hovered over. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>on_click</code></td>
        <td><code>str</code></td>
        <td><p>An optional callback invoked when this button is clicked. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>args</code></td>
        <td><code>list</code></td>
        <td><p>An optional tuple of args to pass to the callback. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>An optional tuple of args to pass to the callback.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">st_download_button</span><span class="p">(</span>
    <span class="n">label</span><span class="p">,</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">on_click</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">csv_sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Streamlit function to create a download button.</span>

<span class="sd">    Args:</span>
<span class="sd">        label (str): A short label explaining to the user what this button is for..</span>
<span class="sd">        data (str | list): The contents of the file to be downloaded. See example below for caching techniques to avoid recomputing this data unnecessarily.</span>
<span class="sd">        file_name (str, optional): An optional string to use as the name of the file to be downloaded, such as &#39;my_file.csv&#39;. If not specified, the name will be automatically generated. Defaults to None.</span>
<span class="sd">        mime (str, optional): The MIME type of the data. If None, defaults to &quot;text/plain&quot; (if data is of type str or is a textual file) or &quot;application/octet-stream&quot; (if data is of type bytes or is a binary file). Defaults to None.</span>
<span class="sd">        key (str, optional): An optional string or integer to use as the unique key for the widget. If this is omitted, a key will be generated for the widget based on its content. Multiple widgets of the same type may not share the same key. Defaults to None.</span>
<span class="sd">        help (str, optional): An optional tooltip that gets displayed when the button is hovered over. Defaults to None.</span>
<span class="sd">        on_click (str, optional): An optional callback invoked when this button is clicked. Defaults to None.</span>
<span class="sd">        args (list, optional): An optional tuple of args to pass to the callback. Defaults to None.</span>
<span class="sd">        kwargs (dict, optional): An optional tuple of args to pass to the callback.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="n">csv_sep</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">mime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">mime</span> <span class="o">=</span> <span class="s2">&quot;text/csv&quot;</span>
                <span class="k">return</span> <span class="n">st</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                    <span class="n">label</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">on_click</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.jpg&quot;</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">mime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">mime</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;image/</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">st</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                        <span class="n">label</span><span class="p">,</span>
                        <span class="n">file</span><span class="p">,</span>
                        <span class="n">file_name</span><span class="p">,</span>
                        <span class="n">mime</span><span class="p">,</span>
                        <span class="n">key</span><span class="p">,</span>
                        <span class="n">help</span><span class="p">,</span>
                        <span class="n">on_click</span><span class="p">,</span>
                        <span class="n">args</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;data.csv&quot;</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="n">csv_sep</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mime</span> <span class="o">=</span> <span class="s2">&quot;text/csv&quot;</span>
            <span class="k">return</span> <span class="n">st</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                <span class="n">label</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">on_click</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if mime is None:</span>
            <span class="c1">#     mime = &quot;application/pdf&quot;</span>
            <span class="k">return</span> <span class="n">st</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span>
                <span class="n">label</span><span class="p">,</span>
                <span class="n">data</span><span class="p">,</span>
                <span class="n">file_name</span><span class="p">,</span>
                <span class="n">mime</span><span class="p">,</span>
                <span class="n">key</span><span class="p">,</span>
                <span class="n">help</span><span class="p">,</span>
                <span class="n">on_click</span><span class="p">,</span>
                <span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Streamlit is not installed. Please run &#39;pip install streamlit&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.start_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_server</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.start_server" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Start a simple web server to serve files from the specified directory
with directory listing and CORS support. Optionally, run the server
asynchronously in a background thread.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>directory</code></td>
        <td><code>str</code></td>
        <td><p>The directory from which files will be served.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>int</code></td>
        <td><p>The port on which the web server will run. Defaults to 8000.</p></td>
        <td><code>8000</code></td>
      </tr>
      <tr>
        <td><code>background</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to run the server in a separate background thread.
                         Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>If True, suppress the log output. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If required modules are not found.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Catches other unexpected errors during execution.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None. The function runs the server indefinitely until manually stopped.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">start_server</span><span class="p">(</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Start a simple web server to serve files from the specified directory</span>
<span class="sd">    with directory listing and CORS support. Optionally, run the server</span>
<span class="sd">    asynchronously in a background thread.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory (str): The directory from which files will be served.</span>
<span class="sd">        port (int, optional): The port on which the web server will run. Defaults to 8000.</span>
<span class="sd">        background (bool, optional): Whether to run the server in a separate background thread.</span>
<span class="sd">                                     Defaults to True.</span>
<span class="sd">        quiet (bool, optional): If True, suppress the log output. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ImportError: If required modules are not found.</span>
<span class="sd">        Exception: Catches other unexpected errors during execution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None. The function runs the server indefinitely until manually stopped.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If no directory is specified, use the current working directory</span>
    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run_flask</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">send_from_directory</span><span class="p">,</span> <span class="n">render_template_string</span>
            <span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>

            <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">static_folder</span><span class="o">=</span><span class="n">directory</span><span class="p">)</span>
            <span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>  <span class="c1"># Enable CORS for all routes</span>

            <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
                <span class="c1"># This will disable Flask&#39;s logging</span>
                <span class="kn">import</span> <span class="nn">logging</span>

                <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;werkzeug&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&lt;path:path&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
            <span class="k">def</span> <span class="nf">serve_file</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

            <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
            <span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
                <span class="c1"># List files and directories under the specified directory</span>
                <span class="n">items</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
                <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="c1"># Generate an HTML representation of the directory listing</span>
                <span class="n">listing_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                &lt;h2&gt;Directory listing for /&lt;/h2&gt;</span>
<span class="s2">                &lt;hr&gt;</span>
<span class="s2">                &lt;ul&gt;</span>
<span class="s2">                    {</span><span class="si">% f</span><span class="s2">or item in items %}</span>
<span class="s2">                        &lt;li&gt;&lt;a href=&quot;{{ item }}&quot;&gt;{{ item }}&lt;/a&gt;&lt;/li&gt;</span>
<span class="s2">                    {</span><span class="si">% e</span><span class="s2">ndfor %}</span>
<span class="s2">                &lt;/ul&gt;</span>
<span class="s2">                &quot;&quot;&quot;</span>
                <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">listing_template</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server is running at http://127.0.0.1:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>
            <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error importing module: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">background</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">threading</span>

        <span class="c1"># Start the Flask server in a new background thread</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run_flask</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Run the Flask server in the main thread</span>
        <span class="n">run_flask</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.streamlit_legend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">streamlit_legend</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#leafmap.common.streamlit_legend" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Streamlit function to display a legend.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>html</code></td>
        <td><code>str</code></td>
        <td><p>The HTML string of the legend.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>width</code></td>
        <td><code>str</code></td>
        <td><p>The width of the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>height</code></td>
        <td><code>str</code></td>
        <td><p>The height of the legend. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>scrolling</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to allow scrolling in the legend. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">streamlit_legend</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Streamlit function to display a legend.</span>

<span class="sd">    Args:</span>
<span class="sd">        html (str): The HTML string of the legend.</span>
<span class="sd">        width (str, optional): The width of the legend. Defaults to None.</span>
<span class="sd">        height (str, optional): The height of the legend. Defaults to None.</span>
<span class="sd">        scrolling (bool, optional): Whether to allow scrolling in the legend. Defaults to True.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">streamlit.components.v1</span> <span class="k">as</span> <span class="nn">components</span>

        <span class="n">components</span><span class="o">.</span><span class="n">html</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">scrolling</span><span class="o">=</span><span class="n">scrolling</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Streamlit is not installed. Please run &#39;pip install streamlit&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.system_fonts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">system_fonts</span><span class="p">(</span><span class="n">show_full_path</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#leafmap.common.system_fonts" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Gets a list of system fonts</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code># Common font locations:
# Linux: /usr/share/fonts/TTF/
# Windows: C:/Windows/Fonts
# macOS:  System &gt; Library &gt; Fonts
</code></pre></div></td></tr></table></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>show_full_path</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show the full path of each system font. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of system fonts.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">system_fonts</span><span class="p">(</span><span class="n">show_full_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets a list of system fonts</span>

<span class="sd">        # Common font locations:</span>
<span class="sd">        # Linux: /usr/share/fonts/TTF/</span>
<span class="sd">        # Windows: C:/Windows/Fonts</span>
<span class="sd">        # macOS:  System &gt; Library &gt; Fonts</span>

<span class="sd">    Args:</span>
<span class="sd">        show_full_path (bool, optional): Whether to show the full path of each system font. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of system fonts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">matplotlib.font_manager</span>

        <span class="n">font_list</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">findSystemFonts</span><span class="p">(</span>
            <span class="n">fontpaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontext</span><span class="o">=</span><span class="s2">&quot;ttf&quot;</span>
        <span class="p">)</span>
        <span class="n">font_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">font_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">font_list</span><span class="p">]</span>
        <span class="n">font_names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">show_full_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">font_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">font_names</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.temp_file_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span></code>


<a href="#leafmap.common.temp_file_path" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns a temporary file path.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>extension</code></td>
        <td><code>str</code></td>
        <td><p>The file extension.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The temporary file path.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a temporary file path.</span>

<span class="sd">    Args:</span>
<span class="sd">        extension (str): The file extension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The temporary file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">tempfile</span>
    <span class="kn">import</span> <span class="nn">uuid</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">extension</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">extension</span>
    <span class="n">file_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_id</span><span class="si">}{</span><span class="n">extension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">file_path</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.tif_to_jp2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tif_to_jp2</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">creationOptions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.tif_to_jp2" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a GeoTIFF to JPEG2000.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The path to the GeoTIFF file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output JPEG2000 file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>creationOptions</code></td>
        <td><code>list</code></td>
        <td><p>A list of creation options for the JPEG2000 file. See
https://gdal.org/drivers/raster/jp2openjpeg.html. For example, to specify the compression
ratio, use <code>["QUALITY=20"]</code>. A value of 20 means the file will be 20% of the size in comparison
to uncompressed data.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">tif_to_jp2</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">creationOptions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a GeoTIFF to JPEG2000.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The path to the GeoTIFF file.</span>
<span class="sd">        output (str): The path to the output JPEG2000 file.</span>
<span class="sd">        creationOptions (list): A list of creation options for the JPEG2000 file. See</span>
<span class="sd">            https://gdal.org/drivers/raster/jp2openjpeg.html. For example, to specify the compression</span>
<span class="sd">            ratio, use ``[&quot;QUALITY=20&quot;]``. A value of 20 means the file will be 20% of the size in comparison</span>
<span class="sd">            to uncompressed data.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.jp2&quot;</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;.jp2&quot;</span>

    <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>

    <span class="n">in_ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">gdal</span><span class="o">.</span><span class="n">Translate</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">in_ds</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;JP2OpenJPEG&quot;</span><span class="p">,</span> <span class="n">creationOptions</span><span class="o">=</span><span class="n">creationOptions</span><span class="p">)</span>
    <span class="n">in_ds</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.tms_to_geotiff" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tms_to_geotiff</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;OpenStreetMap&#39;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:3857&#39;</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.tms_to_geotiff" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Download map tiles and convert them to a GeoTIFF. The source is adapted from https://github.com/gumblex/tms2geotiff.
    Credits to the GitHub user @gumblex.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output GeoTIFF file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list</code></td>
        <td><p>The bounding box [minx, miny, maxx, maxy] coordinates in EPSG:4326, e.g., [-122.5216, 37.733, -122.3661, 37.8095]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>The map zoom level. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>resolution</code></td>
        <td><code>float</code></td>
        <td><p>The resolution in meters. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>source</code></td>
        <td><code>str</code></td>
        <td><p>The tile source. It can be one of the following: "OPENSTREETMAP", "ROADMAP",
"SATELLITE", "TERRAIN", "HYBRID", or an HTTP URL. Defaults to "OpenStreetMap".</p></td>
        <td><code>&#39;OpenStreetMap&#39;</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system. Defaults to "EPSG:3857".</p></td>
        <td><code>&#39;EPSG:3857&#39;</code></td>
      </tr>
      <tr>
        <td><code>to_cog</code></td>
        <td><code>bool</code></td>
        <td><p>Convert to Cloud Optimized GeoTIFF. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>quiet</code></td>
        <td><code>bool</code></td>
        <td><p>Suppress output. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional arguments to pass to gdal.GetDriverByName("GTiff").Create().</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">map_tiles_to_geotiff</span><span class="p">(</span>
    <span class="n">output</span><span class="p">,</span>
    <span class="n">bbox</span><span class="p">,</span>
    <span class="n">zoom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;OpenStreetMap&quot;</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">,</span>
    <span class="n">to_cog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download map tiles and convert them to a GeoTIFF. The source is adapted from https://github.com/gumblex/tms2geotiff.</span>
<span class="sd">        Credits to the GitHub user @gumblex.</span>

<span class="sd">    Args:</span>
<span class="sd">        output (str): The output GeoTIFF file.</span>
<span class="sd">        bbox (list): The bounding box [minx, miny, maxx, maxy] coordinates in EPSG:4326, e.g., [-122.5216, 37.733, -122.3661, 37.8095]</span>
<span class="sd">        zoom (int, optional): The map zoom level. Defaults to None.</span>
<span class="sd">        resolution (float, optional): The resolution in meters. Defaults to None.</span>
<span class="sd">        source (str, optional): The tile source. It can be one of the following: &quot;OPENSTREETMAP&quot;, &quot;ROADMAP&quot;,</span>
<span class="sd">            &quot;SATELLITE&quot;, &quot;TERRAIN&quot;, &quot;HYBRID&quot;, or an HTTP URL. Defaults to &quot;OpenStreetMap&quot;.</span>
<span class="sd">        crs (str, optional): The coordinate reference system. Defaults to &quot;EPSG:3857&quot;.</span>
<span class="sd">        to_cog (bool, optional): Convert to Cloud Optimized GeoTIFF. Defaults to False.</span>
<span class="sd">        quiet (bool, optional): Suppress output. Defaults to False.</span>
<span class="sd">        **kwargs: Additional arguments to pass to gdal.GetDriverByName(&quot;GTiff&quot;).Create().</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">io</span>
    <span class="kn">import</span> <span class="nn">math</span>
    <span class="kn">import</span> <span class="nn">itertools</span>
    <span class="kn">import</span> <span class="nn">concurrent.futures</span>

    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span><span class="p">,</span> <span class="n">osr</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;GDAL is not installed. Install it with pip install GDAL&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">httpx</span>

        <span class="n">SESSION</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">requests</span>

        <span class="n">SESSION</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="n">SESSION</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;*/*&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Accept-Encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;gzip, deflate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">xyz_tiles</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;OPENSTREETMAP&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://tile.openstreetmap.org/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.png&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;OpenStreetMap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;OpenStreetMap&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;ROADMAP&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=m&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Maps&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;SATELLITE&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=s&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Satellite&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;TERRAIN&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=p&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Terrain&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;HYBRID&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://mt1.google.com/vt/lyrs=y&amp;x=</span><span class="si">{x}</span><span class="s2">&amp;y=</span><span class="si">{y}</span><span class="s2">&amp;z=</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Google Satellite&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">xyz_tiles</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">xyz_tiles</span><span class="p">[</span><span class="n">source</span><span class="o">.</span><span class="n">upper</span><span class="p">()][</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">tiles</span> <span class="o">=</span> <span class="n">basemap_xyz_tiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">tiles</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">tiles</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">url</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;source must be one of &quot;OpenStreetMap&quot;, &quot;ROADMAP&quot;, &quot;SATELLITE&quot;, &quot;TERRAIN&quot;, &quot;HYBRID&quot;, or a URL&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolution_to_zoom_level</span><span class="p">(</span><span class="n">resolution</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert map resolution in meters to zoom level for Web Mercator (EPSG:3857) tiles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Web Mercator tile size in meters at zoom level 0</span>
        <span class="n">initial_resolution</span> <span class="o">=</span> <span class="mf">156543.03392804097</span>

        <span class="c1"># Calculate the zoom level</span>
        <span class="n">zoom_level</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">initial_resolution</span> <span class="o">/</span> <span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">zoom_level</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">north</span> <span class="o">=</span> <span class="n">bbox</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;bbox must be a list of 4 coordinates in the format of [xmin, ymin, xmax, ymax]&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">zoom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either zoom or resolution must be provided&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">zoom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of zoom or resolution can be provided&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zoom</span> <span class="o">=</span> <span class="n">resolution_to_zoom_level</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

    <span class="n">EARTH_EQUATORIAL_RADIUS</span> <span class="o">=</span> <span class="mf">6378137.0</span>

    <span class="n">Image</span><span class="o">.</span><span class="n">MAX_IMAGE_PIXELS</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">gdal</span><span class="o">.</span><span class="n">UseExceptions</span><span class="p">()</span>
    <span class="n">web_mercator</span> <span class="o">=</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">()</span>
    <span class="n">web_mercator</span><span class="o">.</span><span class="n">ImportFromEPSG</span><span class="p">(</span><span class="mi">3857</span><span class="p">)</span>

    <span class="n">WKT_3857</span> <span class="o">=</span> <span class="n">web_mercator</span><span class="o">.</span><span class="n">ExportToWkt</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">from4326_to3857</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">):</span>
        <span class="n">xtile</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span> <span class="o">*</span> <span class="n">EARTH_EQUATORIAL_RADIUS</span>
        <span class="n">ytile</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">45</span> <span class="o">+</span> <span class="n">lat</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)))</span> <span class="o">*</span> <span class="n">EARTH_EQUATORIAL_RADIUS</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">xtile</span><span class="p">,</span> <span class="n">ytile</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">deg2num</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">zoom</span><span class="p">):</span>
        <span class="n">lat_r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">zoom</span>
        <span class="n">xtile</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">ytile</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">lat_r</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_r</span><span class="p">))</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">xtile</span><span class="p">,</span> <span class="n">ytile</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="n">im</span><span class="p">):</span>
        <span class="n">extrema</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">getextrema</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extrema</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extrema</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">extrema</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extrema</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">extrema</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">paste_tile</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">tile</span><span class="p">,</span> <span class="n">corner_xy</span><span class="p">,</span> <span class="n">bbox</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bigim</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">tile</span><span class="p">))</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;RGB&quot;</span> <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGB&quot;</span> <span class="k">else</span> <span class="s2">&quot;RGBA&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">bigim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">base_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">newim</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                <span class="n">mode</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newim</span> <span class="o">=</span> <span class="n">bigim</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corner_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corner_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">xy0</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGB&quot;</span><span class="p">:</span>
            <span class="n">newim</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">xy0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">im</span><span class="p">):</span>
                <span class="n">newim</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">xy0</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newim</span>

    <span class="k">def</span> <span class="nf">finish_picture</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
        <span class="n">xfrac</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yfrac</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">xfrac</span><span class="p">)</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">yfrac</span><span class="p">)</span>
        <span class="n">imgw</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">))</span>
        <span class="n">imgh</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">base_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">))</span>
        <span class="n">retim</span> <span class="o">=</span> <span class="n">bigim</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">imgw</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">imgh</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">retim</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;RGBA&quot;</span> <span class="ow">and</span> <span class="n">retim</span><span class="o">.</span><span class="n">getextrema</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">):</span>
            <span class="n">retim</span> <span class="o">=</span> <span class="n">retim</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
        <span class="n">bigim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">retim</span>

    <span class="k">def</span> <span class="nf">get_tile</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
        <span class="n">retry</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">SESSION</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">retry</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>

    <span class="k">def</span> <span class="nf">draw_tile</span><span class="p">(</span>
        <span class="n">source</span><span class="p">,</span> <span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">,</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">zoom</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">deg2num</span><span class="p">(</span><span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">deg2num</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">])</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x1</span><span class="p">)),</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">y1</span><span class="p">)),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">totalnum</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">corners</span><span class="p">)</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">:</span>
                <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">get_tile</span><span class="p">,</span> <span class="n">source</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">zoom</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>
            <span class="n">bigim</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">base_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">fut</span><span class="p">,</span> <span class="n">corner_xy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">corners</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">bigim</span> <span class="o">=</span> <span class="n">paste_tile</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">fut</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">corner_xy</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded image </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">totalnum</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving GeoTIFF. Please wait...&quot;</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">finish_picture</span><span class="p">(</span><span class="n">bigim</span><span class="p">,</span> <span class="n">base_size</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">imgbands</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getbands</span><span class="p">())</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="s2">&quot;GTiff&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;options&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;COMPRESS=DEFLATE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PREDICTOR=2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ZLEVEL=9&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TILED=YES&quot;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">gtiff</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">imgbands</span><span class="p">,</span>
            <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Byte</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">xp0</span><span class="p">,</span> <span class="n">yp0</span> <span class="o">=</span> <span class="n">from4326_to3857</span><span class="p">(</span><span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">)</span>
        <span class="n">xp1</span><span class="p">,</span> <span class="n">yp1</span> <span class="o">=</span> <span class="n">from4326_to3857</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">)</span>
        <span class="n">pwidth</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xp1</span> <span class="o">-</span> <span class="n">xp0</span><span class="p">)</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pheight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yp1</span> <span class="o">-</span> <span class="n">yp0</span><span class="p">)</span> <span class="o">/</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">gtiff</span><span class="o">.</span><span class="n">SetGeoTransform</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">xp0</span><span class="p">,</span> <span class="n">xp1</span><span class="p">),</span> <span class="n">pwidth</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">yp0</span><span class="p">,</span> <span class="n">yp1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">pheight</span><span class="p">))</span>
        <span class="n">gtiff</span><span class="o">.</span><span class="n">SetProjection</span><span class="p">(</span><span class="n">WKT_3857</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imgbands</span><span class="p">):</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">band</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;u8&quot;</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">band</span> <span class="o">=</span> <span class="n">gtiff</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="n">band</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">band</span><span class="o">.</span><span class="n">WriteArray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">gtiff</span><span class="o">.</span><span class="n">FlushCache</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image saved to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">draw_tile</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">north</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">zoom</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">quiet</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">crs</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;EPSG:3857&quot;</span><span class="p">:</span>
            <span class="n">reproject</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">to_cog</span><span class="o">=</span><span class="n">to_cog</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">to_cog</span><span class="p">:</span>
            <span class="n">image_to_cog</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.to_hex_colors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_hex_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span></code>


<a href="#leafmap.common.to_hex_colors" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Adds # to a list of hex color codes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>colors</code></td>
        <td><code>list</code></td>
        <td><p>A list of hex color codes.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of hex color codes prefixed with #.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_hex_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds # to a list of hex color codes.</span>

<span class="sd">    Args:</span>
<span class="sd">        colors (list): A list of hex color codes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of hex color codes prefixed with #.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">color</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">colors</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.transform_bbox_coords" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transform_bbox_coords</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.transform_bbox_coords" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Transforms the coordinates of a bounding box [x1, y1, x2, y2] from one CRS to another.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox</code></td>
        <td><code>list | tuple</code></td>
        <td><p>The bounding box [x1, y1, x2, y2] coordinates.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>src_crs</code></td>
        <td><code>str</code></td>
        <td><p>The source CRS, e.g., "EPSG:4326".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The destination CRS, e.g., "EPSG:3857".</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The transformed bounding box [x1, y1, x2, y2] coordinates.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transform_bbox_coords</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms the coordinates of a bounding box [x1, y1, x2, y2] from one CRS to another.</span>

<span class="sd">    Args:</span>
<span class="sd">        bbox (list | tuple): The bounding box [x1, y1, x2, y2] coordinates.</span>
<span class="sd">        src_crs (str): The source CRS, e.g., &quot;EPSG:4326&quot;.</span>
<span class="sd">        dst_crs (str): The destination CRS, e.g., &quot;EPSG:3857&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The transformed bounding box [x1, y1, x2, y2] coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">bbox</span>

    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">transform_coords</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">transform_coords</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.transform_coords" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transform_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.transform_coords" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Transform coordinates from one CRS to another.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>float</code></td>
        <td><p>The x coordinate.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>float</code></td>
        <td><p>The y coordinate.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>src_crs</code></td>
        <td><code>str</code></td>
        <td><p>The source CRS, e.g., "EPSG:4326".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The destination CRS, e.g., "EPSG:3857".</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>The transformed coordinates in the format of (x, y)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transform_coords</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform coordinates from one CRS to another.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (float): The x coordinate.</span>
<span class="sd">        y (float): The y coordinate.</span>
<span class="sd">        src_crs (str): The source CRS, e.g., &quot;EPSG:4326&quot;.</span>
<span class="sd">        dst_crs (str): The destination CRS, e.g., &quot;EPSG:3857&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The transformed coordinates in the format of (x, y)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pyproj</span>

    <span class="n">transformer</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span>
        <span class="n">src_crs</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">,</span> <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.update_package" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_package</span><span class="p">()</span></code>


<a href="#leafmap.common.update_package" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Updates the leafmap package from the leafmap GitHub repository without the need to use pip or conda.
In this way, I don't have to keep updating pypi and conda-forge with every minor update of the package.</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_package</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the leafmap package from the leafmap GitHub repository without the need to use pip or conda.</span>
<span class="sd">    In this way, I don&#39;t have to keep updating pypi and conda-forge with every minor update of the package.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">download_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;Downloads&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">download_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir</span><span class="p">)</span>
        <span class="n">_clone_repo</span><span class="p">(</span><span class="n">out_dir</span><span class="o">=</span><span class="n">download_dir</span><span class="p">)</span>

        <span class="n">pkg_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="s2">&quot;leafmap-master&quot;</span><span class="p">)</span>
        <span class="n">work_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pkg_dir</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;pip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;pip3 install .&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;pip install .&quot;</span>

        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Please comment out &#39;leafmap.update_package()&#39; and restart the kernel to take effect:</span><span class="se">\n</span><span class="s2">Jupyter menu -&gt; Kernel -&gt; Restart &amp; Clear Output&quot;</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.upload_to_imgur" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_to_imgur</span><span class="p">(</span><span class="n">in_gif</span><span class="p">)</span></code>


<a href="#leafmap.common.upload_to_imgur" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Uploads an image to imgur.com</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>in_gif</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the image.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">upload_to_imgur</span><span class="p">(</span><span class="n">in_gif</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads an image to imgur.com</span>

<span class="sd">    Args:</span>
<span class="sd">        in_gif (str): The file path to the image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>

    <span class="n">pkg_name</span> <span class="o">=</span> <span class="s2">&quot;imgur-uploader&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_tool</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">):</span>
        <span class="n">_check_install</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">IMGUR_API_ID</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IMGUR_API_ID&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">IMGUR_API_SECRET</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IMGUR_API_SECRET&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">credentials_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;.config/imgur_uploader/uploader.cfg&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">IMGUR_API_ID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">IMGUR_API_SECRET</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">credentials_path</span><span class="p">):</span>
            <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;imgur-uploader&quot;</span><span class="p">,</span> <span class="n">in_gif</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
            <span class="c1"># while True:</span>
            <span class="c1">#     line = proc.stdout.readline()</span>
            <span class="c1">#     if not line:</span>
            <span class="c1">#         break</span>
            <span class="c1">#     print(line.rstrip().decode(&quot;utf-8&quot;))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Imgur API credentials could not be found. Please check https://pypi.org/project/imgur-uploader/ for instructions on how to get Imgur API credentials&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_area" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_area</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;m2&#39;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;epsg:3857&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_area" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Calculate the area of a vector.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>vector</code></td>
        <td><code>str</code></td>
        <td><p>A local path or HTTP URL to a vector.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>unit</code></td>
        <td><code>str</code></td>
        <td><p>The unit of the area, can be 'm2', 'km2', 'ha', or 'acres'. Defaults to 'm2'.</p></td>
        <td><code>&#39;m2&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>The area of the vector.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_area</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;m2&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;epsg:3857&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the area of a vector.</span>

<span class="sd">    Args:</span>
<span class="sd">        vector (str): A local path or HTTP URL to a vector.</span>
<span class="sd">        unit (str, optional): The unit of the area, can be &#39;m2&#39;, &#39;km2&#39;, &#39;ha&#39;, or &#39;acres&#39;. Defaults to &#39;m2&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The area of the vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">vector</span>

    <span class="n">area</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;m2&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">area</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;km2&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">area</span> <span class="o">/</span> <span class="mi">1000000</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;ha&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">area</span> <span class="o">/</span> <span class="mi">10000</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;acres&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">area</span> <span class="o">/</span> <span class="mf">4046.8564224</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid unit.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_col_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_col_names</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_col_names" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Retrieves the column names of a vector attribute table.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The input file path.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The list of column names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_col_names</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the column names of a vector attribute table.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The input file path.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of column names.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">fiona</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.kml&quot;</span><span class="p">:</span>
        <span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s2">&quot;KML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rw&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">col_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_geom_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_geom_type</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_geom_type" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the geometry type of a vector dataset.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gdf</code></td>
        <td><code>gpd.GeoDataFrame</code></td>
        <td><p>A GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>first_only</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the geometry type of the
first feature in the GeoDataFrame. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to pass to the geopandas.read_file function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The geometry type of the GeoDataFrame, such as Point, LineString,
    Polygon, MultiPoint, MultiLineString, MultiPolygon.
    For more info, see https://shapely.readthedocs.io/en/stable/manual.html</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_geom_type</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the geometry type of a vector dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf (gpd.GeoDataFrame): A GeoDataFrame.</span>
<span class="sd">        first_only (bool, optional): Whether to return the geometry type of the</span>
<span class="sd">            first feature in the GeoDataFrame. Defaults to True.</span>
<span class="sd">        kwargs: Additional keyword arguments to pass to the geopandas.read_file function.</span>


<span class="sd">    Returns:</span>
<span class="sd">        str: The geometry type of the GeoDataFrame, such as Point, LineString,</span>
<span class="sd">            Polygon, MultiPoint, MultiLineString, MultiPolygon.</span>
<span class="sd">            For more info, see https://shapely.readthedocs.io/en/stable/manual.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">first_only</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">type</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">type</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_set_crs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_set_crs</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_set_crs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Set CRS of a vector file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | gpd.GeoDataFrame</code></td>
        <td><p>The path to the vector file or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The path to the output vector file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The CRS to set. Defaults to "EPSG:4326".</p></td>
        <td><code>&#39;EPSG:4326&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>gpd.GeoDataFrame</code></td>
      <td><p>The GeoDataFrame with the new CRS.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_set_crs</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set CRS of a vector file.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | gpd.GeoDataFrame): The path to the vector file or a GeoDataFrame.</span>
<span class="sd">        output (str, optional): The path to the output vector file. Defaults to None.</span>
<span class="sd">        crs (str, optional): The CRS to set. Defaults to &quot;EPSG:4326&quot;.</span>


<span class="sd">    Returns:</span>
<span class="sd">        gpd.GeoDataFrame: The GeoDataFrame with the new CRS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;source must be a GeoDataFrame or a file path&quot;</span><span class="p">)</span>

    <span class="n">gdf</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_to_geojson" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_geojson</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="s1">&#39;4326&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_to_geojson" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts any geopandas-supported vector dataset to GeoJSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_geojson</code></td>
        <td><code>str</code></td>
        <td><p>The file path to the output GeoJSON. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bbox</code></td>
        <td><code>tuple | GeoDataFrame or GeoSeries | shapely Geometry</code></td>
        <td><p>Filter features by given bounding box, GeoSeries, GeoDataFrame or a shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with mask. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mask</code></td>
        <td><code>dict | GeoDataFrame or GeoSeries | shapely Geometry</code></td>
        <td><p>Filter for features that intersect with the given dict-like geojson geometry, GeoSeries, GeoDataFrame or shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with bbox. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>rows</code></td>
        <td><code>int or slice</code></td>
        <td><p>Load in specific rows by passing an integer (first n rows) or a slice() object.. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>epsg</code></td>
        <td><code>str</code></td>
        <td><p>The EPSG number to convert to. Defaults to "4326".</p></td>
        <td><code>&#39;4326&#39;</code></td>
      </tr>
      <tr>
        <td><code>encoding</code></td>
        <td><code>str</code></td>
        <td><p>The encoding of the input file. Defaults to "utf-8".</p></td>
        <td><code>&#39;utf-8&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>When the output file path is invalid.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A dictionary containing the GeoJSON.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_geojson</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">out_geojson</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">epsg</span><span class="o">=</span><span class="s2">&quot;4326&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts any geopandas-supported vector dataset to GeoJSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): Either the absolute or relative path to the file or URL to be opened, or any object with a read() method (such as an open file or StringIO).</span>
<span class="sd">        out_geojson (str, optional): The file path to the output GeoJSON. Defaults to None.</span>
<span class="sd">        bbox (tuple | GeoDataFrame or GeoSeries | shapely Geometry, optional): Filter features by given bounding box, GeoSeries, GeoDataFrame or a shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with mask. Defaults to None.</span>
<span class="sd">        mask (dict | GeoDataFrame or GeoSeries | shapely Geometry, optional): Filter for features that intersect with the given dict-like geojson geometry, GeoSeries, GeoDataFrame or shapely geometry. CRS mis-matches are resolved if given a GeoSeries or GeoDataFrame. Cannot be used with bbox. Defaults to None.</span>
<span class="sd">        rows (int or slice, optional): Load in specific rows by passing an integer (first n rows) or a slice() object.. Defaults to None.</span>
<span class="sd">        epsg (str, optional): The EPSG number to convert to. Defaults to &quot;4326&quot;.</span>
<span class="sd">        encoding (str, optional): The encoding of the input file. Defaults to &quot;utf-8&quot;.</span>


<span class="sd">    Raises:</span>
<span class="sd">        ValueError: When the output file path is invalid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the GeoJSON.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">check_package</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geopandas&quot;</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s2">&quot;https://geopandas.org&quot;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">fiona</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;zip://&quot;</span> <span class="o">+</span> <span class="n">filename</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.kml&quot;</span><span class="p">:</span>
        <span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s2">&quot;KML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rw&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
            <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>
            <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
            <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">,</span>
            <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">out_geojson</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">out_geojson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geojson&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The output file must have a geojson file extension.&quot;</span><span class="p">)</span>

        <span class="n">out_geojson</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">out_geojson</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdf</span><span class="o">.</span><span class="n">__geo_interface__</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_to_gif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_gif</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">colname</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1%&#39;</span><span class="p">,</span> <span class="s1">&#39;1%&#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress_bar_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_png</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">plot_args</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#leafmap.common.vector_to_gif" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a vector to a gif. This function was inspired by by Johannes Uhl's shapefile2gif repo at
        https://github.com/johannesuhl/shapefile2gif. Credits to Johannes Uhl.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The input vector file. Can be a directory path or http URL, e.g., "https://i.imgur.com/ZWSZC5z.gif"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>out_gif</code></td>
        <td><code>str</code></td>
        <td><p>The output gif file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>colname</code></td>
        <td><code>str</code></td>
        <td><p>The column name of the vector that contains numerical values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vmin</code></td>
        <td><code>float</code></td>
        <td><p>The minimum value to filter the data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vmax</code></td>
        <td><code>float</code></td>
        <td><p>The maximum value to filter the data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>step</code></td>
        <td><code>float</code></td>
        <td><p>The step to filter the data. Defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>facecolor</code></td>
        <td><code>str</code></td>
        <td><p>The color to visualize the data. Defaults to "black".</p></td>
        <td><code>&#39;black&#39;</code></td>
      </tr>
      <tr>
        <td><code>figsize</code></td>
        <td><code>tuple</code></td>
        <td><p>The figure size. Defaults to (10, 8).</p></td>
        <td><code>(10, 8)</code></td>
      </tr>
      <tr>
        <td><code>padding</code></td>
        <td><code>int</code></td>
        <td><p>The padding of the figure tight_layout. Defaults to 3.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>title</code></td>
        <td><code>str</code></td>
        <td><p>The title of the figure. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>add_text</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add text to the figure. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>xy</code></td>
        <td><code>tuple</code></td>
        <td><p>The position of the text from the lower-left corner. Defaults to ("1%", "1%").</p></td>
        <td><code>(&#39;1%&#39;, &#39;1%&#39;)</code></td>
      </tr>
      <tr>
        <td><code>fontsize</code></td>
        <td><code>int</code></td>
        <td><p>The font size of the text. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>add_progress_bar</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to add a progress bar to the figure. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_color</code></td>
        <td><code>str</code></td>
        <td><p>The color of the progress bar. Defaults to "blue".</p></td>
        <td><code>&#39;blue&#39;</code></td>
      </tr>
      <tr>
        <td><code>progress_bar_height</code></td>
        <td><code>int</code></td>
        <td><p>The height of the progress bar. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>dpi</code></td>
        <td><code>int</code></td>
        <td><p>The dpi of the figure. Defaults to 300.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>fps</code></td>
        <td><code>int</code></td>
        <td><p>The frames per second (fps) of the gif. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>loop</code></td>
        <td><code>int</code></td>
        <td><p>The number of loops of the gif. Defaults to 0, infinite loop.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mp4</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to convert the gif to mp4. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>keep_png</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to keep the png files. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print the progress. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>open_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the geopandas.read_file() function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>plot_args</code></td>
        <td><code>dict</code></td>
        <td><p>The arguments for the geopandas.GeoDataFrame.plot() function. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_gif</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">out_gif</span><span class="p">,</span>
    <span class="n">colname</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">add_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;1%&quot;</span><span class="p">,</span> <span class="s2">&quot;1%&quot;</span><span class="p">),</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">add_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_bar_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">progress_bar_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">mp4</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">keep_png</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">open_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">plot_args</span><span class="o">=</span><span class="p">{},</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a vector to a gif. This function was inspired by by Johannes Uhl&#39;s shapefile2gif repo at</span>
<span class="sd">            https://github.com/johannesuhl/shapefile2gif. Credits to Johannes Uhl.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The input vector file. Can be a directory path or http URL, e.g., &quot;https://i.imgur.com/ZWSZC5z.gif&quot;</span>
<span class="sd">        out_gif (str): The output gif file.</span>
<span class="sd">        colname (str): The column name of the vector that contains numerical values.</span>
<span class="sd">        vmin (float, optional): The minimum value to filter the data. Defaults to None.</span>
<span class="sd">        vmax (float, optional): The maximum value to filter the data. Defaults to None.</span>
<span class="sd">        step (float, optional): The step to filter the data. Defaults to 1.</span>
<span class="sd">        facecolor (str, optional): The color to visualize the data. Defaults to &quot;black&quot;.</span>
<span class="sd">        figsize (tuple, optional): The figure size. Defaults to (10, 8).</span>
<span class="sd">        padding (int, optional): The padding of the figure tight_layout. Defaults to 3.</span>
<span class="sd">        title (str, optional): The title of the figure. Defaults to None.</span>
<span class="sd">        add_text (bool, optional): Whether to add text to the figure. Defaults to True.</span>
<span class="sd">        xy (tuple, optional): The position of the text from the lower-left corner. Defaults to (&quot;1%&quot;, &quot;1%&quot;).</span>
<span class="sd">        fontsize (int, optional): The font size of the text. Defaults to 20.</span>
<span class="sd">        add_progress_bar (bool, optional): Whether to add a progress bar to the figure. Defaults to True.</span>
<span class="sd">        progress_bar_color (str, optional): The color of the progress bar. Defaults to &quot;blue&quot;.</span>
<span class="sd">        progress_bar_height (int, optional): The height of the progress bar. Defaults to 5.</span>
<span class="sd">        dpi (int, optional): The dpi of the figure. Defaults to 300.</span>
<span class="sd">        fps (int, optional): The frames per second (fps) of the gif. Defaults to 10.</span>
<span class="sd">        loop (int, optional): The number of loops of the gif. Defaults to 0, infinite loop.</span>
<span class="sd">        mp4 (bool, optional): Whether to convert the gif to mp4. Defaults to False.</span>
<span class="sd">        keep_png (bool, optional): Whether to keep the png files. Defaults to False.</span>
<span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to True.</span>
<span class="sd">        open_args (dict, optional): The arguments for the geopandas.read_file() function. Defaults to {}.</span>
<span class="sd">        plot_args (dict, optional): The arguments for the geopandas.GeoDataFrame.plot() function. Defaults to {}.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_gif</span><span class="p">)</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&quot;tmp_png&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">open_args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">filename</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;filename must be a string or a geopandas.GeoDataFrame object.&quot;</span>
        <span class="p">)</span>

    <span class="n">bbox</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>

    <span class="k">if</span> <span class="n">colname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">colname</span><span class="si">}</span><span class="s2"> is not in the columns of the GeoDataFrame. It must be one of </span><span class="si">{</span><span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">values</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">options</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

    <span class="n">W</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># default text location is 5% width and 5% height of the image.</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;xy must be a tuple, e.g., (10, 10), (&#39;10%&#39;, &#39;10%&#39;)&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">W</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;xy is out of bounds. x must be within [0, </span><span class="si">{</span><span class="n">W</span><span class="si">}</span><span class="s2">], and y must be within [0, </span><span class="si">{</span><span class="n">H</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xy</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">W</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">H</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The specified xy is invalid. It must be formatted like this (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;The specified xy is invalid. It must be formatted like this: (10, 10) or (&#39;10%&#39;, &#39;10%&#39;)&quot;</span>
        <span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="n">yrdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="p">]</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">yrdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_args</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">add_text</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmp_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">v</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

    <span class="n">png_to_gif</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">out_gif</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">add_progress_bar</span><span class="p">:</span>
        <span class="n">add_progress_bar_to_gif</span><span class="p">(</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">out_gif</span><span class="p">,</span>
            <span class="n">progress_bar_color</span><span class="p">,</span>
            <span class="n">progress_bar_height</span><span class="p">,</span>
            <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">fps</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">mp4</span><span class="p">:</span>
        <span class="n">gif_to_mp4</span><span class="p">(</span><span class="n">out_gif</span><span class="p">,</span> <span class="n">out_gif</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.gif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp4&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_png</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done. The GIF is saved to </span><span class="si">{</span><span class="n">out_gif</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_to_mbtiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_mbtiles</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">target_path</span><span class="p">,</span> <span class="n">max_zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_to_mbtiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a vector dataset to MBTiles format using the ogr2ogr command-line tool.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the source vector dataset (GeoPackage, Shapefile, etc.).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the target MBTiles file to be created.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_zoom</code></td>
        <td><code>int</code></td>
        <td><p>The maximum zoom level for the MBTiles dataset. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the MBTiles dataset. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional options to be passed as keyword arguments. These options will be used as -dsco options
      when calling ogr2ogr. See https://gdal.org/drivers/raster/mbtiles.html for a list of options.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>subprocess.CalledProcessError</code></td>
        <td><p>If the ogr2ogr command fails to execute.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>source_path = "countries.gpkg"
target_path = "target.mbtiles"
name = "My MBTiles"
max_zoom = 5
vector_to_mbtiles(source_path, target_path, name=name, max_zoom=max_zoom)</p>

        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_mbtiles</span><span class="p">(</span>
    <span class="n">source_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_zoom</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a vector dataset to MBTiles format using the ogr2ogr command-line tool.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_path (str): The path to the source vector dataset (GeoPackage, Shapefile, etc.).</span>
<span class="sd">        target_path (str): The path to the target MBTiles file to be created.</span>
<span class="sd">        max_zoom (int, optional): The maximum zoom level for the MBTiles dataset. Defaults to 5.</span>
<span class="sd">        name (str, optional): The name of the MBTiles dataset. Defaults to None.</span>
<span class="sd">        **kwargs: Additional options to be passed as keyword arguments. These options will be used as -dsco options</span>
<span class="sd">                  when calling ogr2ogr. See https://gdal.org/drivers/raster/mbtiles.html for a list of options.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        subprocess.CalledProcessError: If the ogr2ogr command fails to execute.</span>

<span class="sd">    Example:</span>
<span class="sd">        source_path = &quot;countries.gpkg&quot;</span>
<span class="sd">        target_path = &quot;target.mbtiles&quot;</span>
<span class="sd">        name = &quot;My MBTiles&quot;</span>
<span class="sd">        max_zoom = 5</span>
<span class="sd">        vector_to_mbtiles(source_path, target_path, name=name, max_zoom=max_zoom)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>

    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ogr2ogr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MBTILES&quot;</span><span class="p">,</span>
        <span class="n">target_path</span><span class="p">,</span>
        <span class="n">source_path</span><span class="p">,</span>
        <span class="s2">&quot;-dsco&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;MAXZOOM=</span><span class="si">{</span><span class="n">max_zoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-dsco&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;NAME=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-dsco&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_to_parquet" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_parquet</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_to_parquet" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a GeoDataFrame or a file containing vector data to Parquet format.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>Union[gpd.GeoDataFrame, str]</code></td>
        <td><p>The source data to convert. It can be either a GeoDataFrame
or a file path to the vector data file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The file path where the Parquet file will be saved.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>crs</code></td>
        <td><code>str</code></td>
        <td><p>The coordinate reference system (CRS) to use for the output file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite the existing output file. Default is False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the <code>to_parquet</code> function of GeoDataFrame.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_parquet</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a GeoDataFrame or a file containing vector data to Parquet format.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (Union[gpd.GeoDataFrame, str]): The source data to convert. It can be either a GeoDataFrame</span>
<span class="sd">            or a file path to the vector data file.</span>
<span class="sd">        output (str): The file path where the Parquet file will be saved.</span>
<span class="sd">        crs (str, optional): The coordinate reference system (CRS) to use for the output file. Defaults to None.</span>
<span class="sd">        overwrite (bool): Whether to overwrite the existing output file. Default is False.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the `to_parquet` function of GeoDataFrame.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2"> already exists. Skipping...&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">source</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>

    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>

    <span class="n">gdf</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_to_pmtiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_pmtiles</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">target_path</span><span class="p">,</span> <span class="n">max_zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_to_pmtiles" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a vector file to PMTiles format.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source_path</code></td>
        <td><code>str</code></td>
        <td><p>Path to the source vector file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>target_path</code></td>
        <td><code>str</code></td>
        <td><p>Path to the target PMTiles file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_zoom</code></td>
        <td><code>int</code></td>
        <td><p>Maximum zoom level for the PMTiles. Defaults to 5.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the PMTiles dataset. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td></td>
        <td><p>Additional keyword arguments to be passed to the underlying conversion functions.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the target file does not have a .pmtiles extension.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_pmtiles</span><span class="p">(</span>
    <span class="n">source_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_zoom</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a vector file to PMTiles format.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_path (str): Path to the source vector file.</span>
<span class="sd">        target_path (str): Path to the target PMTiles file.</span>
<span class="sd">        max_zoom (int, optional): Maximum zoom level for the PMTiles. Defaults to 5.</span>
<span class="sd">        name (str, optional): Name of the PMTiles dataset. Defaults to None.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed to the underlying conversion functions.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the target file does not have a .pmtiles extension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pmtiles&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: target file must be a .pmtiles file.&quot;</span><span class="p">)</span>
    <span class="n">mbtiles</span> <span class="o">=</span> <span class="n">target_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.pmtiles&quot;</span><span class="p">,</span> <span class="s2">&quot;.mbtiles&quot;</span><span class="p">)</span>
    <span class="n">vector_to_mbtiles</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">mbtiles</span><span class="p">,</span> <span class="n">max_zoom</span><span class="o">=</span><span class="n">max_zoom</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">mbtiles_to_pmtiles</span><span class="p">(</span><span class="n">mbtiles</span><span class="p">,</span> <span class="n">target_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mbtiles</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.vector_to_raster" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vector_to_raster</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;FID&#39;</span><span class="p">,</span> <span class="n">assign</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cell_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">to_epsg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.vector_to_raster" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Convert a vector to a raster.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>vector</code></td>
        <td><code>str | GeoPandas.GeoDataFrame</code></td>
        <td><p>The input vector data, can be a file path or a GeoDataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output</code></td>
        <td><code>str</code></td>
        <td><p>The output raster file path.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>field</code></td>
        <td><code>str</code></td>
        <td><p>Input field name in attribute table. Defaults to 'FID'.</p></td>
        <td><code>&#39;FID&#39;</code></td>
      </tr>
      <tr>
        <td><code>assign</code></td>
        <td><code>str</code></td>
        <td><p>Assignment operation, where multiple points are in the same grid cell; options
include 'first', 'last' (default), 'min', 'max', 'sum', 'number'. Defaults to 'last'.</p></td>
        <td><code>&#39;last&#39;</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>bool</code></td>
        <td><p>Background value to set to NoData. Without this flag, it will be set to 0.0.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>cell_size</code></td>
        <td><code>float</code></td>
        <td><p>Optionally specified cell size of output raster. Not used when base raster is specified</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>base</code></td>
        <td><code>str</code></td>
        <td><p>Optionally specified input base raster file. Not used when a cell size is specified. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>callback</code></td>
        <td><code>fuct</code></td>
        <td><p>A callback function to report progress. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to print progress to the console. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>to_epsg</code></td>
        <td><code>integer</code></td>
        <td><p>Optionally specified the EPSG code to reproject the raster to. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vector_to_raster</span><span class="p">(</span>
    <span class="n">vector</span><span class="p">,</span>
    <span class="n">output</span><span class="p">,</span>
    <span class="n">field</span><span class="o">=</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span>
    <span class="n">assign</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cell_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">to_epsg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a vector to a raster.</span>

<span class="sd">    Args:</span>
<span class="sd">        vector (str | GeoPandas.GeoDataFrame): The input vector data, can be a file path or a GeoDataFrame.</span>
<span class="sd">        output (str): The output raster file path.</span>
<span class="sd">        field (str, optional): Input field name in attribute table. Defaults to &#39;FID&#39;.</span>
<span class="sd">        assign (str, optional): Assignment operation, where multiple points are in the same grid cell; options</span>
<span class="sd">            include &#39;first&#39;, &#39;last&#39; (default), &#39;min&#39;, &#39;max&#39;, &#39;sum&#39;, &#39;number&#39;. Defaults to &#39;last&#39;.</span>
<span class="sd">        nodata (bool, optional): Background value to set to NoData. Without this flag, it will be set to 0.0.</span>
<span class="sd">        cell_size (float, optional): Optionally specified cell size of output raster. Not used when base raster is specified</span>
<span class="sd">        base (str, optional): Optionally specified input base raster file. Not used when a cell size is specified. Defaults to None.</span>
<span class="sd">        callback (fuct, optional): A callback function to report progress. Defaults to None.</span>
<span class="sd">        verbose (bool, optional): Whether to print progress to the console. Defaults to False.</span>
<span class="sd">        to_epsg (integer, optional): Optionally specified the EPSG code to reproject the raster to. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">whitebox</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">vector</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;vector must be a file path or a GeoDataFrame&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">to_epsg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">to_epsg</span> <span class="o">=</span> <span class="mi">3857</span>

    <span class="k">if</span> <span class="n">to_epsg</span> <span class="o">==</span> <span class="mi">4326</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;to_epsg cannot be 4326&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">is_geographic</span><span class="p">:</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">to_epsg</span><span class="p">)</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.shp&quot;</span><span class="p">)</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_epsg</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span>

    <span class="n">wbt</span> <span class="o">=</span> <span class="n">whitebox</span><span class="o">.</span><span class="n">WhiteboxTools</span><span class="p">()</span>
    <span class="n">wbt</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="n">goem_type</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geom_type</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">goem_type</span> <span class="o">==</span> <span class="s2">&quot;LineString&quot;</span><span class="p">:</span>
        <span class="n">wbt</span><span class="o">.</span><span class="n">vector_lines_to_raster</span><span class="p">(</span>
            <span class="n">vector</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">nodata</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">callback</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">goem_type</span> <span class="o">==</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">:</span>
        <span class="n">wbt</span><span class="o">.</span><span class="n">vector_polygons_to_raster</span><span class="p">(</span>
            <span class="n">vector</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">nodata</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">callback</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wbt</span><span class="o">.</span><span class="n">vector_points_to_raster</span><span class="p">(</span>
            <span class="n">vector</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">assign</span><span class="p">,</span> <span class="n">nodata</span><span class="p">,</span> <span class="n">cell_size</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">callback</span>
        <span class="p">)</span>

    <span class="n">image_set_crs</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">to_epsg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.view_lidar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">view_lidar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;pyvista&#39;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eye_dome_lighting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.view_lidar" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>View LiDAR data in 3D.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The filepath to the LiDAR data.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cmap</code></td>
        <td><code>str</code></td>
        <td><p>The colormap to use. Defaults to "terrain". cmap currently does not work for the open3d backend.</p></td>
        <td><code>&#39;terrain&#39;</code></td>
      </tr>
      <tr>
        <td><code>backend</code></td>
        <td><code>str</code></td>
        <td><p>The plotting backend to use, can be pyvista, ipygany, panel, and open3d. Defaults to "pyvista".</p></td>
        <td><code>&#39;pyvista&#39;</code></td>
      </tr>
      <tr>
        <td><code>background</code></td>
        <td><code>str</code></td>
        <td><p>The background color to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>eye_dome_lighting</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use eye dome lighting. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>FileNotFoundError</code></td>
        <td><p>If the file does not exist.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the backend is not supported.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">view_lidar</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;pyvista&quot;</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">eye_dome_lighting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;View LiDAR data in 3D.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The filepath to the LiDAR data.</span>
<span class="sd">        cmap (str, optional): The colormap to use. Defaults to &quot;terrain&quot;. cmap currently does not work for the open3d backend.</span>
<span class="sd">        backend (str, optional): The plotting backend to use, can be pyvista, ipygany, panel, and open3d. Defaults to &quot;pyvista&quot;.</span>
<span class="sd">        background (str, optional): The background color to use. Defaults to None.</span>
<span class="sd">        eye_dome_lighting (bool, optional): Whether to use eye dome lighting. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the file does not exist.</span>
<span class="sd">        ValueError: If the backend is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USE_MKDOCS&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This function is not supported in Google Colab.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="n">backend</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">backend</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pyvista&quot;</span><span class="p">,</span> <span class="s2">&quot;ipygany&quot;</span><span class="p">,</span> <span class="s2">&quot;panel&quot;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">pyntcloud</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;The pyvista and pyntcloud packages are required for this function. Use pip install leafmap[lidar] to install them.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pyvista&quot;</span><span class="p">:</span>
                <span class="n">backend</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;ipygany&quot;</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pyntcloud</span><span class="o">.</span><span class="n">PyntCloud</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_instance</span><span class="p">(</span><span class="s2">&quot;pyvista&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">elevation</span><span class="p">()</span>
            <span class="n">mesh</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">scalars</span><span class="o">=</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">jupyter_backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
                <span class="n">eye_dome_lighting</span><span class="o">=</span><span class="n">eye_dome_lighting</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something went wrong.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;open3d&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">laspy</span>
            <span class="kn">import</span> <span class="nn">open3d</span> <span class="k">as</span> <span class="nn">o3d</span>
            <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;The laspy and open3d packages are required for this function. Use pip install laspy open3d to install them.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">las</span> <span class="o">=</span> <span class="n">laspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">point_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">las</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">las</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">las</span><span class="o">.</span><span class="n">Z</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">geom</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">PointCloud</span><span class="p">()</span>
            <span class="n">geom</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">utility</span><span class="o">.</span><span class="n">Vector3dVector</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
            <span class="c1"># geom.colors =  o3d.utility.Vector3dVector(colors)  # need to add colors. A list in the form of [[r,g,b], [r,g,b]] with value range 0-1. https://github.com/isl-org/Open3D/issues/614</span>
            <span class="n">o3d</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">draw_geometries</span><span class="p">([</span><span class="n">geom</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something went wrong.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">backend</span><span class="si">}</span><span class="s2"> is not a valid backend.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.whiteboxgui" class="doc doc-heading">
<code class="highlight language-python"><span class="n">whiteboxgui</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sandbox_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.whiteboxgui" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Shows the WhiteboxTools GUI.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show progress info when the tool is running. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>tree</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use the tree mode toolbox built using ipytree rather than ipywidgets. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>reset</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to regenerate the json file with the dictionary containing the information for all tools. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>sandbox_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the sandbox folder. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object</code></td>
      <td><p>A toolbox GUI.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">whiteboxgui</span><span class="p">(</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">reset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sandbox_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shows the WhiteboxTools GUI.</span>

<span class="sd">    Args:</span>
<span class="sd">        verbose (bool, optional): Whether to show progress info when the tool is running. Defaults to True.</span>
<span class="sd">        tree (bool, optional): Whether to use the tree mode toolbox built using ipytree rather than ipywidgets. Defaults to False.</span>
<span class="sd">        reset (bool, optional): Whether to regenerate the json file with the dictionary containing the information for all tools. Defaults to False.</span>
<span class="sd">        sandbox_path (str, optional): The path to the sandbox folder. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: A toolbox GUI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">whiteboxgui</span>

    <span class="k">return</span> <span class="n">whiteboxgui</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">reset</span><span class="p">,</span> <span class="n">sandbox_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.widget_template" class="doc doc-heading">
<code class="highlight language-python"><span class="n">widget_template</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opened</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_close_button</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">widget_icon</span><span class="o">=</span><span class="s1">&#39;gear&#39;</span><span class="p">,</span> <span class="n">close_button_icon</span><span class="o">=</span><span class="s1">&#39;times&#39;</span><span class="p">,</span> <span class="n">widget_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">close_button_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">display_widget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;topright&#39;</span><span class="p">)</span></code>


<a href="#leafmap.common.widget_template" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create a widget template.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>widget</code></td>
        <td><code>ipywidgets.Widget</code></td>
        <td><p>The widget to be displayed. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>opened</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to open the toolbar. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>show_close_button</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to show the close button. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>widget_icon</code></td>
        <td><code>str</code></td>
        <td><p>The icon name for the toolbar button. Defaults to 'gear'.</p></td>
        <td><code>&#39;gear&#39;</code></td>
      </tr>
      <tr>
        <td><code>close_button_icon</code></td>
        <td><code>str</code></td>
        <td><p>The icon name for the close button. Defaults to "times".</p></td>
        <td><code>&#39;times&#39;</code></td>
      </tr>
      <tr>
        <td><code>widget_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to the toolbar button. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>close_button_args</code></td>
        <td><code>dict</code></td>
        <td><p>Additional arguments to pass to the close button. Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>display_widget</code></td>
        <td><code>ipywidgets.Widget</code></td>
        <td><p>The widget to be displayed when the toolbar is clicked.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>m</code></td>
        <td><code>geemap.Map</code></td>
        <td><p>The geemap.Map instance. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>position</code></td>
        <td><code>str</code></td>
        <td><p>The position of the toolbar. Defaults to "topright".</p></td>
        <td><code>&#39;topright&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">widget_template</span><span class="p">(</span>
    <span class="n">widget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">opened</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_close_button</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">widget_icon</span><span class="o">=</span><span class="s2">&quot;gear&quot;</span><span class="p">,</span>
    <span class="n">close_button_icon</span><span class="o">=</span><span class="s2">&quot;times&quot;</span><span class="p">,</span>
    <span class="n">widget_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">close_button_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">display_widget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;topright&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a widget template.</span>

<span class="sd">    Args:</span>
<span class="sd">        widget (ipywidgets.Widget, optional): The widget to be displayed. Defaults to None.</span>
<span class="sd">        opened (bool, optional): Whether to open the toolbar. Defaults to True.</span>
<span class="sd">        show_close_button (bool, optional): Whether to show the close button. Defaults to True.</span>
<span class="sd">        widget_icon (str, optional): The icon name for the toolbar button. Defaults to &#39;gear&#39;.</span>
<span class="sd">        close_button_icon (str, optional): The icon name for the close button. Defaults to &quot;times&quot;.</span>
<span class="sd">        widget_args (dict, optional): Additional arguments to pass to the toolbar button. Defaults to {}.</span>
<span class="sd">        close_button_args (dict, optional): Additional arguments to pass to the close button. Defaults to {}.</span>
<span class="sd">        display_widget (ipywidgets.Widget, optional): The widget to be displayed when the toolbar is clicked.</span>
<span class="sd">        m (geemap.Map, optional): The geemap.Map instance. Defaults to None.</span>
<span class="sd">        position (str, optional): The position of the toolbar. Defaults to &quot;topright&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">random_string</span><span class="p">()</span>  <span class="c1"># a random attribute name</span>

    <span class="k">if</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">widget_args</span><span class="p">:</span>
        <span class="n">widget_args</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;tooltip&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">widget_args</span><span class="p">:</span>
        <span class="n">widget_args</span><span class="p">[</span><span class="s2">&quot;tooltip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Toolbar&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;layout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">widget_args</span><span class="p">:</span>
        <span class="n">widget_args</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 0px 0px 4px&quot;</span>
        <span class="p">)</span>
    <span class="n">widget_args</span><span class="p">[</span><span class="s2">&quot;icon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widget_icon</span>

    <span class="k">if</span> <span class="s2">&quot;value&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">close_button_args</span><span class="p">:</span>
        <span class="n">close_button_args</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="s2">&quot;tooltip&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">close_button_args</span><span class="p">:</span>
        <span class="n">close_button_args</span><span class="p">[</span><span class="s2">&quot;tooltip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Close the tool&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;button_style&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">close_button_args</span><span class="p">:</span>
        <span class="n">close_button_args</span><span class="p">[</span><span class="s2">&quot;button_style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;primary&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;layout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">close_button_args</span><span class="p">:</span>
        <span class="n">close_button_args</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">height</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;28px&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;0px 0px 0px 4px&quot;</span>
        <span class="p">)</span>
    <span class="n">close_button_args</span><span class="p">[</span><span class="s2">&quot;icon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">close_button_icon</span>

    <span class="n">toolbar_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span><span class="o">**</span><span class="n">widget_args</span><span class="p">)</span>

    <span class="n">close_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span><span class="o">**</span><span class="n">close_button_args</span><span class="p">)</span>

    <span class="n">toolbar_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">()</span>
    <span class="n">toolbar_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">toolbar_button</span><span class="p">]</span>
    <span class="n">toolbar_header</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">show_close_button</span><span class="p">:</span>
        <span class="n">toolbar_header</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">close_button</span><span class="p">,</span> <span class="n">toolbar_button</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toolbar_header</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">toolbar_button</span><span class="p">]</span>
    <span class="n">toolbar_footer</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">toolbar_footer</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">widget</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toolbar_footer</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">toolbar_btn_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]:</span>
            <span class="n">close_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">toolbar_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">toolbar_header</span><span class="p">,</span> <span class="n">toolbar_footer</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">display_widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">()</span>
                <span class="k">with</span> <span class="n">widget</span><span class="p">:</span>
                    <span class="n">display</span><span class="p">(</span><span class="n">display_widget</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">toolbar_widget</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">toolbar_button</span><span class="p">]</span>

    <span class="n">toolbar_button</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">toolbar_btn_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close_btn_click</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new&quot;</span><span class="p">]:</span>
            <span class="n">toolbar_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">control</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">control</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">control</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">remove_control</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
                    <span class="nb">delattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">toolbar_widget</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">close_button</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">close_btn_click</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

    <span class="n">toolbar_button</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">opened</span>
    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">ipyleaflet</span>

        <span class="n">toolbar_control</span> <span class="o">=</span> <span class="n">ipyleaflet</span><span class="o">.</span><span class="n">WidgetControl</span><span class="p">(</span>
            <span class="n">widget</span><span class="o">=</span><span class="n">toolbar_widget</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">toolbar_control</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="n">toolbar_control</span><span class="p">)</span>

            <span class="nb">setattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">toolbar_control</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">toolbar_widget</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.write_lidar" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_lidar</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">do_compress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">laz_backend</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#leafmap.common.write_lidar" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Writes to a stream or file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>str | laspy.lasdatas.base.LasBase</code></td>
        <td><p>The source data to be written.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>destination</code></td>
        <td><code>str</code></td>
        <td><p>The destination filepath.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>do_compress</code></td>
        <td><code>bool</code></td>
        <td><p>Flags to indicate if you want to compress the data. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>laz_backend</code></td>
        <td><code>str</code></td>
        <td><p>The laz backend to use. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_lidar</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">do_compress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">laz_backend</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes to a stream or file.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str | laspy.lasdatas.base.LasBase): The source data to be written.</span>
<span class="sd">        destination (str): The destination filepath.</span>
<span class="sd">        do_compress (bool, optional): Flags to indicate if you want to compress the data. Defaults to None.</span>
<span class="sd">        laz_backend (str, optional): The laz backend to use. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">laspy</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The laspy package is required for this function. Use `pip install laspy[lazrs,laszip]` to install it.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">read_lidar</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

    <span class="n">source</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">do_compress</span><span class="o">=</span><span class="n">do_compress</span><span class="p">,</span> <span class="n">laz_backend</span><span class="o">=</span><span class="n">laz_backend</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.xy_to_window" class="doc doc-heading">
<code class="highlight language-python"><span class="n">xy_to_window</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span></code>


<a href="#leafmap.common.xy_to_window" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Converts a list of coordinates to a rasterio window.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>xy</code></td>
        <td><code>list</code></td>
        <td><p>A list of coordinates in the format of [[x1, y1], [x2, y2]]</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>The rasterio window in the format of (col_off, row_off, width, height)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">xy_to_window</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a list of coordinates to a rasterio window.</span>

<span class="sd">    Args:</span>
<span class="sd">        xy (list): A list of coordinates in the format of [[x1, y1], [x2, y2]]</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: The rasterio window in the format of (col_off, row_off, width, height)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">left</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">right</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">top</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>

    <span class="n">width</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.zonal_stats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zonal_stats</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">raster</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">band_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">all_touched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">category_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raster_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">geojson_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gdf_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_vector_args</span><span class="o">=</span><span class="p">{},</span> <span class="n">open_raster_args</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#leafmap.common.zonal_stats" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>This function wraps rasterstats.zonal_stats and performs reprojection if necessary.
    See https://pythonhosted.org/rasterstats/rasterstats.html.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>vectors</code></td>
        <td><code>str | list | GeoDataFrame</code></td>
        <td><p>path to an vector source or geo-like python objects.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>raster</code></td>
        <td><code>str | ndarray</code></td>
        <td><p>ndarray or path to a GDAL raster source.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>layer</code></td>
        <td><code>int</code></td>
        <td><p>If vectors is a path to an fiona source, specify the vector layer to
use either by name or number. Defaults to 0</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>band_num</code></td>
        <td><code>int | str</code></td>
        <td><p>If raster is a GDAL source, the band number to use (counting from 1). defaults to 1.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>nodata</code></td>
        <td><code>float</code></td>
        <td><p>If raster is a GDAL source, this value overrides any NODATA value
specified in the files metadata. If None, the files metadatas NODATA value (if any)
will be used. defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>affine</code></td>
        <td><code>Affine</code></td>
        <td><p>required only for ndarrays, otherwise it is read from src. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>stats</code></td>
        <td><code>str | list</code></td>
        <td><p>Which statistics to calculate for each zone.
It can be ['min', 'max', 'mean', 'count']. For more, see https://pythonhosted.org/rasterstats/manual.html#zonal-statistics
Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>all_touched</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to include every raster cell touched by a geometry, or only those having
a center point within the polygon. defaults to False</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>categorical</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the raster values will be treated as categorical.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>category_map</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary mapping raster values to human-readable categorical names.
Only applies when categorical is True</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>add_stats</code></td>
        <td><code>dict</code></td>
        <td><p>with names and functions of additional stats to compute. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>raster_out</code></td>
        <td><code>bool</code></td>
        <td><p>Include the masked numpy array for each feature?. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>prefix</code></td>
        <td><code>str</code></td>
        <td><p>add a prefix to the keys. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>geojson_out</code></td>
        <td><code>bool</code></td>
        <td><p>Return list of GeoJSON-like features (default: False)
Original feature geometry and properties will be retained with zonal stats
appended as additional properties. Use with prefix to ensure unique and
meaningful property names.. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>gdf_out</code></td>
        <td><code>bool</code></td>
        <td><p>Return a GeoDataFrame. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>dst_crs</code></td>
        <td><code>str</code></td>
        <td><p>The destination CRS. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>open_vector_args</code></td>
        <td><code>dict</code></td>
        <td><p>Pass additional arguments to geopandas.open_file(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>open_raster_args</code></td>
        <td><code>dict</code></td>
        <td><p>Pass additional arguments to rasterio.open(). Defaults to {}.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict | list | GeoDataFrame</code></td>
      <td><p>The zonal statistics results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">zonal_stats</span><span class="p">(</span>
    <span class="n">vectors</span><span class="p">,</span>
    <span class="n">raster</span><span class="p">,</span>
    <span class="n">layer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">band_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">affine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">all_touched</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">category_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">add_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">raster_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">geojson_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">gdf_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">open_vector_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">open_raster_args</span><span class="o">=</span><span class="p">{},</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function wraps rasterstats.zonal_stats and performs reprojection if necessary.</span>
<span class="sd">        See https://pythonhosted.org/rasterstats/rasterstats.html.</span>

<span class="sd">    Args:</span>
<span class="sd">        vectors (str | list | GeoDataFrame): path to an vector source or geo-like python objects.</span>
<span class="sd">        raster (str | ndarray): ndarray or path to a GDAL raster source.</span>
<span class="sd">        layer (int, optional): If vectors is a path to an fiona source, specify the vector layer to</span>
<span class="sd">            use either by name or number. Defaults to 0</span>
<span class="sd">        band_num (int | str, optional): If raster is a GDAL source, the band number to use (counting from 1). defaults to 1.</span>
<span class="sd">        nodata (float, optional): If raster is a GDAL source, this value overrides any NODATA value</span>
<span class="sd">            specified in the files metadata. If None, the files metadatas NODATA value (if any)</span>
<span class="sd">            will be used. defaults to None.</span>
<span class="sd">        affine (Affine, optional): required only for ndarrays, otherwise it is read from src. Defaults to None.</span>
<span class="sd">        stats (str | list, optional): Which statistics to calculate for each zone.</span>
<span class="sd">            It can be [&#39;min&#39;, &#39;max&#39;, &#39;mean&#39;, &#39;count&#39;]. For more, see https://pythonhosted.org/rasterstats/manual.html#zonal-statistics</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        all_touched (bool, optional): Whether to include every raster cell touched by a geometry, or only those having</span>
<span class="sd">            a center point within the polygon. defaults to False</span>
<span class="sd">        categorical (bool, optional): If True, the raster values will be treated as categorical.</span>
<span class="sd">        category_map (dict, optional):A dictionary mapping raster values to human-readable categorical names.</span>
<span class="sd">            Only applies when categorical is True</span>
<span class="sd">        add_stats (dict, optional): with names and functions of additional stats to compute. Defaults to None.</span>
<span class="sd">        raster_out (bool, optional): Include the masked numpy array for each feature?. Defaults to False.</span>
<span class="sd">        prefix (str, optional): add a prefix to the keys. Defaults to None.</span>
<span class="sd">        geojson_out (bool, optional): Return list of GeoJSON-like features (default: False)</span>
<span class="sd">            Original feature geometry and properties will be retained with zonal stats</span>
<span class="sd">            appended as additional properties. Use with prefix to ensure unique and</span>
<span class="sd">            meaningful property names.. Defaults to False.</span>
<span class="sd">        gdf_out (bool, optional): Return a GeoDataFrame. Defaults to False.</span>
<span class="sd">        dst_crs (str, optional): The destination CRS. Defaults to None.</span>
<span class="sd">        open_vector_args (dict, optional): Pass additional arguments to geopandas.open_file(). Defaults to {}.</span>
<span class="sd">        open_raster_args (dict, optional): Pass additional arguments to rasterio.open(). Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict | list | GeoDataFrame: The zonal statistics results</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
    <span class="kn">import</span> <span class="nn">rasterio</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">rasterstats</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
            <span class="s2">&quot;rasterstats is not installed. Install it with pip install rasterstats&quot;</span>
        <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="o">**</span><span class="n">open_raster_args</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
                <span class="n">affine</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
                <span class="n">nodata</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">nodata</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">band_num</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">raster_crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">DatasetReader</span><span class="p">):</span>
            <span class="n">affine</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">transform</span>
            <span class="n">nodata</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">nodata</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">band_num</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">raster_crs</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">crs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">raster</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="o">**</span><span class="n">open_vector_args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">vectors</span>

        <span class="n">vector_crs</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span>

        <span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">is_geographic</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">raster_crs</span><span class="o">.</span><span class="n">is_geographic</span><span class="p">:</span>
                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">raster_crs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">!=</span> <span class="n">raster_crs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">raster_crs</span><span class="o">.</span><span class="n">is_geographic</span><span class="p">:</span>
                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">raster_crs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The vector and raster CRSs are not compatible&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">gdf_out</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">geojson_out</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">rasterstats</span><span class="o">.</span><span class="n">zonal_stats</span><span class="p">(</span>
            <span class="n">gdf</span><span class="p">,</span>
            <span class="n">array</span><span class="p">,</span>
            <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span>
            <span class="n">band_num</span><span class="o">=</span><span class="n">band_num</span><span class="p">,</span>
            <span class="n">nodata</span><span class="o">=</span><span class="n">nodata</span><span class="p">,</span>
            <span class="n">affine</span><span class="o">=</span><span class="n">affine</span><span class="p">,</span>
            <span class="n">stats</span><span class="o">=</span><span class="n">stats</span><span class="p">,</span>
            <span class="n">all_touched</span><span class="o">=</span><span class="n">all_touched</span><span class="p">,</span>
            <span class="n">categorical</span><span class="o">=</span><span class="n">categorical</span><span class="p">,</span>
            <span class="n">category_map</span><span class="o">=</span><span class="n">category_map</span><span class="p">,</span>
            <span class="n">add_stats</span><span class="o">=</span><span class="n">add_stats</span><span class="p">,</span>
            <span class="n">raster_out</span><span class="o">=</span><span class="n">raster_out</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">geojson_out</span><span class="o">=</span><span class="n">geojson_out</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">gdf_out</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dst_crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dst_crs</span> <span class="o">=</span> <span class="n">vector_crs</span>

            <span class="n">out_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">out_gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">raster_crs</span>
            <span class="k">return</span> <span class="n">out_gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">dst_crs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="leafmap.common.zoom_level_resolution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zoom_level_resolution</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#leafmap.common.zoom_level_resolution" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Returns the approximate pixel scale based on zoom level and latutude.
    See https://blogs.bing.com/maps/2006/02/25/map-control-zoom-levels-gt-resolution</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>zoom</code></td>
        <td><code>int</code></td>
        <td><p>The zoom level.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>latitude</code></td>
        <td><code>float</code></td>
        <td><p>The latitude. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>Map resolution in meters.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>leafmap/common.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">zoom_level_resolution</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the approximate pixel scale based on zoom level and latutude.</span>
<span class="sd">        See https://blogs.bing.com/maps/2006/02/25/map-control-zoom-levels-gt-resolution</span>

<span class="sd">    Args:</span>
<span class="sd">        zoom (int): The zoom level.</span>
<span class="sd">        latitude (float, optional): The latitude. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Map resolution in meters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">math</span>

    <span class="n">resolution</span> <span class="o">=</span> <span class="mf">156543.04</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2021-05-23T02:19:09+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-05-23</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2021-05-23T02:19:09+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-05-23</span>
  </span>

    
    
    
  </aside>


  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2024 Qiusheng Wu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>